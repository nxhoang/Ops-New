(function(){"undefined"==typeof Math.sgn&&(Math.sgn=function(n){return 0==n?0:n>0?1:-1});var n={subtract:function(n,t){return{x:n.x-t.x,y:n.y-t.y}},dotProduct:function(n,t){return n.x*t.x+n.y*t.y},square:function(n){return Math.sqrt(n.x*n.x+n.y*n.y)},scale:function(n,t){return{x:n.x*t,y:n.y*t}}},e=64,l=Math.pow(2,-e-1),o=function(t,i){for(var f,h=[],a=v(t,i),c=i.length-1,y=2*c-1,p=r(a,y,h,0),e=n.subtract(t,i[0]),o=n.square(e),l=0,s=0;s<p;s++)e=n.subtract(t,u(i,c,h[s],null,null)),f=n.square(e),f<o&&(o=f,l=h[s]);return e=n.subtract(t,i[c]),f=n.square(e),f<o&&(o=f,l=1),{location:l,distance:o}},a=function(n,t){var i=o(n,t);return{point:u(t,t.length-1,i.location,null,null),location:i.location}},v=function(t,i){for(var f,o,p,w,u=i.length-1,l=2*u-1,a=[],h=[],c=[],e=[],b=[[1,.6,.3,.1],[.4,.6,.6,.4],[.1,.3,.6,1]],r=0;r<=u;r++)a[r]=n.subtract(i[r],t);for(r=0;r<=u-1;r++)h[r]=n.subtract(i[r+1],i[r]),h[r]=n.scale(h[r],3);for(f=0;f<=u-1;f++)for(o=0;o<=u;o++)c[f]||(c[f]=[]),c[f][o]=n.dotProduct(h[f],a[o]);for(r=0;r<=l;r++)e[r]||(e[r]=[]),e[r].y=0,e[r].x=parseFloat(r)/l;for(var v=u,y=u-1,s=0;s<=v+y;s++)for(p=Math.max(0,s-y),w=Math.min(s,v),r=p;r<=w;r++)j=s-r,e[r+j].y+=c[j][r]*b[j][r];return e},r=function(n,t,i,f){var s,h,c=[],l=[],a=[],v=[],o;switch(y(n,t)){case 0:return 0;case 1:if(f>=e)return i[0]=(n[0].x+n[t].x)/2,1;if(p(n,t))return i[0]=w(n,t),1}for(u(n,t,.5,c,l),s=r(c,t,a,f+1),h=r(l,t,v,f+1),o=0;o<s;o++)i[o]=a[o];for(o=0;o<h;o++)i[o+s]=v[o];return s+h},y=function(n,t){for(var u,f=0,i=u=Math.sgn(n[0].y),r=1;r<=t;r++)i=Math.sgn(n[r].y),i!=u&&f++,u=i;return f},p=function(n,t){var d,p,w,g,nt,e,o,s,h,c,b,r,k,a,i,v,y,u,f;for(e=n[0].y-n[t].y,o=n[t].x-n[0].x,s=n[0].x*n[t].y-n[t].x*n[0].y,y=max_distance_below=0,u=1;u<t;u++)f=e*n[u].x+o*n[u].y+s,f>y?y=f:f<max_distance_below&&(max_distance_below=f);return b=0,r=1,k=0,a=e,i=o,v=s-y,h=b*i-a*r,c=1/h,p=(r*v-i*k)*c,a=e,i=o,v=s-max_distance_below,h=b*i-a*r,c=1/h,w=(r*v-i*k)*c,g=Math.min(p,w),nt=Math.max(p,w),d=nt-g,d<l?1:0},w=function(n,t){var i=1,r=n[t].x-n[0].x,u=n[t].y-n[0].y,f=n[0].x-0,e=n[0].y-0,o=r*0-u*i,s=1/o,h=(r*e-u*f)*s;return 0+i*h},u=function(n,t,i,r,u){for(var o,e=[[]],f=0;f<=t;f++)e[0][f]=n[f];for(o=1;o<=t;o++)for(f=0;f<=t-o;f++)e[o]||(e[o]=[]),e[o][f]||(e[o][f]={}),e[o][f].x=(1-i)*e[o-1][f].x+i*e[o-1][f+1].x,e[o][f].y=(1-i)*e[o-1][f].y+i*e[o-1][f+1].y;if(null!=r)for(f=0;f<=t;f++)r[f]=e[f][0];if(null!=u)for(f=0;f<=t;f++)u[f]=e[t-f][f];return e[t][0]},s={},b=function(n){var t=s[n],r,u,i;if(!t){t=[];var f=function(){return function(t){return Math.pow(t,n)}},e=function(){return function(t){return Math.pow(1-t,n)}},o=function(n){return function(){return n}},h=function(){return function(n){return n}},c=function(){return function(n){return 1-n}},l=function(n){return function(t){for(var r=1,i=0;i<n.length;i++)r*=n[i](t);return r}};for(t.push(new f),r=1;r<n;r++){for(u=[new o(n)],i=0;i<n-r;i++)u.push(new h);for(i=0;i<r;i++)u.push(new c);t.push(new l(u))}t.push(new e);s[n]=t}return t},t=function(n,t){for(var r=b(n.length-1),u=0,f=0,i=0;i<n.length;i++)u+=n[i].x*r[i](t),f+=n[i].y*r[i](t);return{x:u,y:f}},h=function(n,t){return Math.sqrt(Math.pow(n.x-t.x,2)+Math.pow(n.y-t.y,2))},c=function(n){return n[0].x==n[1].x&&n[0].y==n[1].y},i=function(n,i,r){if(c(n))return{point:n[0],location:i};for(var e=t(n,i),o=0,f=i,s=r>0?1:-1,u=null;o<Math.abs(r);)f+=.005*s,u=t(n,f),o+=h(u,e),e=u;return{point:u,location:f}},k=function(n){if(c(n))return 0;for(var u=t(n,0),f=0,i=0,r=null;i<1;)i+=.005*1,r=t(n,i),f+=h(r,u),u=r;return f},d=function(n,t,r){return i(n,t,r).point},g=function(n,t,r){return i(n,t,r).location},f=function(n,i){var r=t(n,i),u=t(n.slice(0,n.length-1),i),f=u.y-r.y,e=u.x-r.x;return 0==f?1/0:Math.atan(f/e)},nt=function(n,t,r){var u=i(n,t,r);return u.location>1&&(u.location=1),u.location<0&&(u.location=0),f(n,u.location)},tt=function(n,t,r,u){u=null==u?0:u;var e=i(n,t,u),c=f(n,e.location),o=Math.atan(-1/c),s=r/2*Math.sin(o),h=r/2*Math.cos(o);return[{x:e.point.x+h,y:e.point.y+s},{x:e.point.x-h,y:e.point.y-s}]},it=this.jsBezier={distanceFromCurve:o,gradientAtPoint:f,gradientAtPointAlongCurveFrom:nt,nearestPointOnCurve:a,pointOnCurve:t,pointAlongCurveFrom:d,perpendicularToCurveAt:tt,locationAlongCurveFrom:g,getLength:k,version:"0.9.0"};"undefined"!=typeof exports&&(exports.jsBezier=it)}).call("undefined"!=typeof window?window:this),function(){"use strict";var f=this,n=f.Biltong={version:"0.4.0"};"undefined"!=typeof exports&&(exports.Biltong=n);var r=function(n){return"[object Array]"===Object.prototype.toString.call(n)},t=function(n,t,i){return n=r(n)?n:[n.x,n.y],t=r(t)?t:[t.x,t.y],i(n,t)},i=n.gradient=function(n,i){return t(n,i,function(n,t){return t[0]==n[0]?t[1]>n[1]?1/0:-(1/0):t[1]==n[1]?t[0]>n[0]?0:-0:(t[1]-n[1])/(t[0]-n[0])})},u=(n.normal=function(n,t){return-1/i(n,t)},n.lineLength=function(n,i){return t(n,i,function(n,t){return Math.sqrt(Math.pow(t[1]-n[1],2)+Math.pow(t[0]-n[0],2))})},n.quadrant=function(n,i){return t(n,i,function(n,t){return t[0]>n[0]?t[1]>n[1]?2:1:t[0]==n[0]?t[1]>n[1]?2:1:t[1]>n[1]?3:4})}),e=(n.theta=function(n,r){return t(n,r,function(n,t){var e=i(n,t),r=Math.atan(e),f=u(n,t);return 4!=f&&3!=f||(r+=Math.PI),r<0&&(r+=2*Math.PI),r})},n.intersects=function(n,t){var i=n.x,s=n.x+n.w,u=n.y,f=n.y+n.h,r=t.x,h=t.x+t.w,e=t.y,o=t.y+t.h;return i<=r&&r<=s&&u<=e&&e<=f||i<=h&&h<=s&&u<=e&&e<=f||i<=r&&r<=s&&u<=o&&o<=f||i<=h&&r<=s&&u<=o&&o<=f||r<=i&&i<=h&&e<=u&&u<=o||r<=s&&s<=h&&e<=u&&u<=o||r<=i&&i<=h&&e<=f&&f<=o||r<=s&&i<=h&&e<=f&&f<=o},n.encloses=function(n,t,i){var u=n.x,f=n.x+n.w,e=n.y,o=n.y+n.h,s=t.x,h=t.x+t.w,c=t.y,l=t.y+t.h,r=function(n,t,r,u){return i?n<=t&&r>=u:n<t&&r>u};return r(u,s,f,h)&&r(e,c,o,l)},[null,[1,-1],[1,1],[-1,1],[-1,-1]]),o=[null,[-1,-1],[-1,1],[1,1],[1,-1]];n.pointOnLine=function(n,t,r){var c=i(n,t),f=u(n,t),s=r>0?e[f]:o[f],h=Math.atan(c),l=Math.abs(r*Math.sin(h))*s[1],a=Math.abs(r*Math.cos(h))*s[0];return{x:n.x+a,y:n.y+l}};n.perpendicularLineTo=function(n,t,r){var o=i(n,t),u=Math.atan(-1/o),f=r/2*Math.sin(u),e=r/2*Math.cos(u);return[{x:t.x+e,y:t.y+f},{x:t.x-e,y:t.y-f}]}}.call("undefined"!=typeof window?window:this),function(){"use strict";var t=this,w={android:navigator.userAgent.toLowerCase().indexOf("android")>-1},f=function(n,t,i){i=i||n.parentNode;for(var u=i.querySelectorAll(t),r=0;r<u.length;r++)if(u[r]===n)return!0;return!1},o=function(n){return"string"==typeof n||n.constructor===String?document.getElementById(n):n},r=function(n){return n.srcElement||n.target},v=function(n,t,i,r){if(r){if("undefined"!=typeof n.path&&n.path.indexOf)return{path:n.path,end:n.path.indexOf(i)};var u={path:[],end:-1},f=function(n){u.path.push(n);n===i?u.end=u.path.length-1:null!=n.parentNode&&f(n.parentNode)};return f(t),u}return{path:[t],end:1}},b=function(n,t){for(var i=0,r=n.length;i<r&&n[i]!=t;i++);i<n.length&&n.splice(i,1)},tt=1,k=function(n,t,i){var r=tt++;return n.__ta=n.__ta||{},n.__ta[t]=n.__ta[t]||{},n.__ta[t][r]=i,i.__tauid=r,r},it=function(n,t,i){if(n.__ta&&n.__ta[t]&&delete n.__ta[t][i.__tauid],i.__taExtra){for(var r=0;r<i.__taExtra.length;r++)l(n,i.__taExtra[r][0],i.__taExtra[r][1]);i.__taExtra.length=0}i.__taUnstore&&i.__taUnstore()},s=function(n,t,i,u){if(null==n)return i;var o=n.split(","),e=function(u){var s,h;e.__tauid=i.__tauid;var a=r(u),c=a,l=v(u,a,t,null!=n);if(l.end!=-1)for(s=0;s<l.end;s++)for(c=l.path[s],h=0;h<o.length;h++)f(c,o[h],t)&&i.apply(c,arguments)};return rt(i,u,e),e},rt=function(n,t,i){n.__taExtra=n.__taExtra||[];n.__taExtra.push([t,i])},i=function(t,i,r,f){if(u&&n[i]){var e=s(f,t,r,n[i]);c(t,n[i],e,r)}"focus"===i&&null==t.getAttribute("tabindex")&&t.setAttribute("tabindex","1");c(t,i,s(f,t,r,i),r)},ut=function(n,t,u,f){if(null==n.__taSmartClicks){var e=function(t){n.__tad=h(t)},o=function(t){n.__tau=h(t)},s=function(t){if(n.__tad&&n.__tau&&n.__tad[0]===n.__tau[0]&&n.__tad[1]===n.__tau[1])for(var i=0;i<n.__taSmartClicks.length;i++)n.__taSmartClicks[i].apply(r(t),[t])};i(n,"mousedown",e,f);i(n,"mouseup",o,f);i(n,"click",s,f);n.__taSmartClicks=[]}n.__taSmartClicks.push(u);u.__taUnstore=function(){b(n.__taSmartClicks,u)}},y={tap:{touches:1,taps:1},dbltap:{touches:1,taps:2},contextmenu:{touches:2,taps:1}},ft=function(n,t){return function(u,o,s,h){if("contextmenu"==o&&e)i(u,o,s,h);else{if(null==u.__taTapHandler){var c=u.__taTapHandler={tap:[],dbltap:[],contextmenu:[],down:!1,taps:0,downSelectors:[]},l=function(i){for(var e,o=r(i),l=v(i,o,u,null!=h),a=!1,s=0;s<l.end;s++){if(a)return;for(o=l.path[s],e=0;e<c.downSelectors.length;e++)if(null==c.downSelectors[e]||f(o,c.downSelectors[e],u)){c.down=!0;setTimeout(p,n);setTimeout(w,t);a=!0;break}}},a=function(n){var s,h,l,a,t,e,i,o;if(c.down){l=r(n);c.taps++;a=lt(n);for(t in y)if(y.hasOwnProperty(t)&&(e=y[t],e.touches===a&&(1===e.taps||e.taps===c.taps)))for(i=0;i<c[t].length;i++)for(h=v(n,l,u,null!=c[t][i][1]),o=0;o<h.end;o++)if(s=h.path[o],null==c[t][i][1]||f(s,c[t][i][1],u)){c[t][i][0].apply(s,[n]);break}}},p=function(){c.down=!1},w=function(){c.taps=0};i(u,"mousedown",l);i(u,"mouseup",a)}u.__taTapHandler.downSelectors.push(h);u.__taTapHandler[o].push([s,h]);s.__taUnstore=function(){b(u.__taTapHandler[o],s)}}}},d=function(n,t,i,r){for(var u in i.__tamee[n])i.__tamee[n].hasOwnProperty(u)&&i.__tamee[n][u].apply(r,[t])},et=function(){var n=[];return function(t,i,u,e){if(!t.__tamee){t.__tamee={over:!1,mouseenter:[],mouseexit:[]};var o=function(i){var u=r(i);(null!=e||u!=t||t.__tamee.over)&&(!f(u,e,t)||null!=u.__tamee&&u.__tamee.over)||(d("mouseenter",i,t,u),u.__tamee=u.__tamee||{},u.__tamee.over=!0,n.push(u))},h=function(i){for(var u=r(i),e=0;e<n.length;e++)u!=n[e]||f(i.relatedTarget||i.toElement,"*",u)||(u.__tamee.over=!1,n.splice(e,1),d("mouseexit",i,t,u))};c(t,"mouseover",s(e,t,o,"mouseover"),o);c(t,"mouseout",s(e,t,h,"mouseout"),h)}u.__taUnstore=function(){delete t.__tamee[i][u.__tauid]};k(t,i,u);t.__tamee[i][u.__tauid]=u}},u="ontouchstart"in document.documentElement,e="onmousedown"in document.documentElement,n={mousedown:"touchstart",mouseup:"touchend",mousemove:"touchmove"},g=function(){var n=-1,t,i;return"Microsoft Internet Explorer"==navigator.appName&&(t=navigator.userAgent,i=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})"),null!=i.exec(t)&&(n=parseFloat(RegExp.$1))),n}(),ot=g>-1&&g<9,p=function(n,t){if(null==n)return[0,0];var r=nt(n),i=ct(r,0);return[i[t+"X"],i[t+"Y"]]},h=function(n){return null==n?[0,0]:ot?[n.clientX+document.documentElement.scrollLeft,n.clientY+document.documentElement.scrollTop]:p(n,"page")},st=function(n){return p(n,"screen")},ht=function(n){return p(n,"client")},ct=function(n,t){return n.item?n.item(t):n[t]},nt=function(n){return n.touches&&n.touches.length>0?n.touches:n.changedTouches&&n.changedTouches.length>0?n.changedTouches:n.targetTouches&&n.targetTouches.length>0?n.targetTouches:[n]},lt=function(n){return nt(n).length},c=function(n,t,i,r){if(k(n,t,i),r.__tauid=i.__tauid,n.addEventListener)n.addEventListener(t,i,!1);else if(n.attachEvent){var u=t+i.__tauid;n["e"+u]=i;n[u]=function(){n["e"+u]&&n["e"+u](window.event)};n.attachEvent("on"+t,n[u])}},l=function(t,i,r){null!=r&&a(t,function(){var f=o(this),e;(it(f,i,r),null!=r.__tauid)&&(f.removeEventListener?(f.removeEventListener(i,r,!1),u&&n[i]&&f.removeEventListener(n[i],r,!1)):this.detachEvent&&(e=i+r.__tauid,f[e]&&f.detachEvent("on"+i,f[e]),f[e]=null,f["e"+e]=null));r.__taTouchProxy&&l(t,r.__taTouchProxy[1],r.__taTouchProxy[0])})},a=function(n,t){if(null!=n){n="undefined"!=typeof Window&&"unknown"!=typeof n.top&&n==n.top?[n]:"string"!=typeof n&&null==n.tagName&&null!=n.length?n:"string"==typeof n?document.querySelectorAll(n):[n];for(var i=0;i<n.length;i++)t.apply(n[i])}};t.Mottle=function(t){t=t||{};var r=t.clickThreshold||250,f=t.dblClickThreshold||450,s=new et,c=new ft(r,f),v=t.smartClicks,y=function(n,t,r,u){null!=r&&a(n,function(){var n=o(this);v&&"click"===t?ut(n,t,r,u):"tap"===t||"dbltap"===t||"contextmenu"===t?c(n,t,r,u):"mouseenter"===t||"mouseexit"==t?s(n,t,r,u):i(n,t,r,u)})};this.remove=function(n){return a(n,function(){var n=o(this),t,i;if(n.__ta)for(t in n.__ta)if(n.__ta.hasOwnProperty(t))for(i in n.__ta[t])n.__ta[t].hasOwnProperty(i)&&l(n,t,n.__ta[t][i]);n.parentNode&&n.parentNode.removeChild(n)}),this};this.on=function(){var n=arguments[0],t=4==arguments.length?arguments[2]:null,i=arguments[1],r=arguments[arguments.length-1];return y(n,i,r,t),this};this.off=function(n,t,i){return l(n,t,i),this};this.trigger=function(t,i,r,f){var y=e&&("undefined"==typeof MouseEvent||null==r||r.constructor===MouseEvent),l=u&&!e&&n[i]?n[i]:i,p=!(u&&!e&&n[i]),v=h(r),s=st(r),c=ht(r);return a(t,function(){var t,e=o(this),h,b,k,a;r=r||{screenX:s[0],screenY:s[1],clientX:c[0],clientY:c[1]};h=function(n){f&&(n.payload=f)};b={TouchEvent:function(n){var t=document.createTouch(window,e,0,v[0],v[1],s[0],s[1],c[0],c[1],0,0,0,0),i=document.createTouchList(t),r=document.createTouchList(t),u=document.createTouchList(t);n.initTouchEvent(l,!0,!0,window,null,s[0],s[1],c[0],c[1],!1,!1,!1,!1,i,r,u,1,0)},MouseEvents:function(n){if(n.initMouseEvent(l,!0,!0,window,0,s[0],s[1],c[0],c[1],!1,!1,!1,!1,1,e),w.android){var t=document.createTouch(window,e,0,v[0],v[1],s[0],s[1],c[0],c[1],0,0,0,0);n.touches=n.targetTouches=n.changedTouches=document.createTouchList(t)}}};document.createEvent?(k=!p&&!y&&u&&n[i]&&!w.android,a=k?"TouchEvent":"MouseEvents",t=document.createEvent(a),b[a](t),h(t),e.dispatchEvent(t)):document.createEventObject&&(t=document.createEventObject(),t.eventType=t.eventName=l,t.screenX=s[0],t.screenY=s[1],t.clientX=c[0],t.clientY=c[1],h(t),e.fireEvent("on"+l,t))}),this}};t.Mottle.consume=function(n,t){n.stopPropagation?n.stopPropagation():n.returnValue=!1;!t&&n.preventDefault&&n.preventDefault()};t.Mottle.pageLocation=h;t.Mottle.setForceTouchEvents=function(n){u=n};t.Mottle.setForceMouseEvents=function(n){e=n};t.Mottle.version="0.8.0";"undefined"!=typeof exports&&(exports.Mottle=t.Mottle)}.call("undefined"==typeof window?this:window),function(){"use strict";var f=this,c=function(n,t,i){return n.indexOf(t)===-1&&(i?n.unshift(t):n.push(t),!0)},e=function(n,t){var i=n.indexOf(t);i!=-1&&n.splice(i,1)},nt=function(n,t){for(var r=[],i=0;i<n.length;i++)t.indexOf(n[i])==-1&&r.push(n[i]);return r},u=function(n){return null!=n&&("string"==typeof n||n.constructor==String)},tt=function(n){var r=n.getBoundingClientRect(),t=document.body,i=document.documentElement,u=window.pageYOffset||i.scrollTop||t.scrollTop,f=window.pageXOffset||i.scrollLeft||t.scrollLeft,e=i.clientTop||t.clientTop||0,o=i.clientLeft||t.clientLeft||0,s=r.top+u-e,h=r.left+f-o;return{top:Math.round(s),left:Math.round(h)}},l=function(n,t,i){i=i||n.parentNode;for(var u=i.querySelectorAll(t),r=0;r<u.length;r++)if(u[r]===n)return!0;return!1},o=function(){var n=-1,t,i;return"Microsoft Internet Explorer"==navigator.appName&&(t=navigator.userAgent,i=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})"),null!=i.exec(t)&&(n=parseFloat(RegExp.$1))),n}(),it=50,rt=50,ut=o>-1&&o<9,ft=9==o,a=function(n){if(ut)return[n.clientX+document.documentElement.scrollLeft,n.clientY+document.documentElement.scrollTop];var i=ot(n),t=et(i,0);return ft?[t.pageX||t.clientX,t.pageY||t.clientY]:[t.pageX,t.pageY]},et=function(n,t){return n.item?n.item(t):n[t]},ot=function(n){return n.touches&&n.touches.length>0?n.touches:n.changedTouches&&n.changedTouches.length>0?n.changedTouches:n.targetTouches&&n.targetTouches.length>0?n.targetTouches:[n]},s={draggable:"katavorio-draggable",droppable:"katavorio-droppable",drag:"katavorio-drag",selected:"katavorio-drag-selected",active:"katavorio-drag-active",hover:"katavorio-drag-hover",noSelect:"katavorio-drag-no-select",ghostProxy:"katavorio-ghost-proxy"},st="katavorio-drag-scope",i=["stop","start","drag","drop","over","out","beforeStart"],ht=function(){},ct=function(){return!0},t=function(n,t,i){for(var r=0;r<n.length;r++)n[r]!=i&&t(n[r])},v=function(n,i,r,u){t(n,function(n){n.setActive(i);i&&n.updatePosition();r&&n.setHover(u,i)})},n=function(n,t){if(null!=n){n=u(n)||null!=n.tagName||null==n.length?[n]:n;for(var i=0;i<n.length;i++)t.apply(n[i],[n[i]])}},y=function(n){n.stopPropagation?(n.stopPropagation(),n.preventDefault()):n.returnValue=!1},lt="input,textarea,select,button,option",at=function(n,t,i){var r=n.srcElement||n.target;return!l(r,i.getInputFilterSelector(),t)},p=function(t,i,r,u){this.params=i||{};this.el=t;this.params.addClass(this.el,this._class);this.uuid=h();var f=!0;return this.setEnabled=function(n){f=n},this.isEnabled=function(){return f},this.toggleEnabled=function(){f=!f},this.setScope=function(n){this.scopes=n?n.split(/\s+/):[u]},this.addScope=function(t){var i={},r;n(this.scopes,function(n){i[n]=!0});n(t?t.split(/\s+/):[],function(n){i[n]=!0});this.scopes=[];for(r in i)this.scopes.push(r)},this.removeScope=function(t){var i={},r;n(this.scopes,function(n){i[n]=!0});n(t?t.split(/\s+/):[],function(n){delete i[n]});this.scopes=[];for(r in i)this.scopes.push(r)},this.toggleScope=function(t){var i={},r;n(this.scopes,function(n){i[n]=!0});n(t?t.split(/\s+/):[],function(n){i[n]?delete i[n]:i[n]=!0});this.scopes=[];for(r in i)this.scopes.push(r)},this.setScope(i.scope),this.k=i.katavorio,i.katavorio},w=function(){return!0},b=function(){return!1},k=function(n,t,i){var o,ni,vt,yt,pt,bt,f,k,e,nt,et;this._class=i.draggable;o=p.apply(this,arguments);this.rightButtonCanDrag=this.params.rightButtonCanDrag;var c=[0,0],d=null,st=null,ht=[0,0],ot=!1,ti=this.params.consumeStartEvent!==!1,r=this.el,kt=this.params.clone,ii=(this.params.scroll,t.multipleDrop!==!1),ut=!1,lt=t.ghostProxy===!0?w:t.ghostProxy&&"function"==typeof t.ghostProxy?t.ghostProxy:b,ri=function(n){return n.cloneNode(!0)},dt=t.snapThreshold||5,gt=function(n,t,i,r,u){r=r||dt;u=u||dt;var h=Math.floor(n[0]/t),f=t*h,o=f+t,c=Math.abs(n[0]-f)<=r?f:Math.abs(o-n[0])<=r?o:n[0],l=Math.floor(n[1]/i),e=i*l,s=e+i,a=Math.abs(n[1]-e)<=u?e:Math.abs(s-n[1])<=u?s:n[1];return[c,a]};this.posses=[];this.posseRoles={};this.toGrid=function(n){return null==this.params.grid?n:gt(n,this.params.grid[0],this.params.grid[1])};this.snap=function(n,t){if(null!=r){n=n||(this.params.grid?this.params.grid[0]:it);t=t||(this.params.grid?this.params.grid[1]:rt);var i=this.params.getPosition(r);this.params.setPosition(r,gt(i,n,t,n,t))}};this.setUseGhostProxy=function(n){lt=n?w:b};vt=function(n){return t.allowNegative===!1?[Math.max(0,n[0]),Math.max(0,n[1])]:n};yt=function(n){ni="function"==typeof n?n:n?function(n){return vt([Math.max(0,Math.min(bt.w-this.size[0],n[0])),Math.max(0,Math.min(bt.h-this.size[1],n[1]))])}.bind(this):function(n){return vt(n)}}.bind(this);yt("function"==typeof this.params.constrain?this.params.constrain:this.params.constrain||this.params.containment);this.setConstrain=function(n){yt(n)};this.setRevert=function(n){pt=n};var ui=function(n){return"function"==typeof n?(n._katavorioId=h(),n._katavorioId):n},ft={},fi=function(n){var r,i,t;for(r in ft)if(i=ft[r],t=i[0](n),i[1]&&(t=!t),!t)return!1;return!0},wt=this.setFilter=function(t,i){if(t){var r=ui(t);ft[r]=[function(i){var r,f=i.srcElement||i.target;return u(t)?r=l(f,t,n):"function"==typeof t&&(r=t(i,n)),r},i!==!1]}};this.addFilter=wt;this.removeFilter=function(n){var t="function"==typeof n?n._katavorioId:n;delete ft[t]};this.clearAllFilters=function(){ft={}};this.canDrag=this.params.canDrag||ct;f=[];k=[];this.downListener=function(n){var f=this.rightButtonCanDrag||3!==n.which&&2!==n.button,u,t;f&&this.isEnabled()&&this.canDrag()&&(u=fi(n)&&at(n,this.el,this.k),u?(kt?(r=this.el.cloneNode(!0),r.setAttribute("id",null),r.style.position="absolute",t=tt(this.el),r.style.left=t.left+"px",r.style.top=t.top+"px",document.body.appendChild(r)):r=this.el,ti&&y(n),c=a(n),this.params.bind(document,"mousemove",this.moveListener),this.params.bind(document,"mouseup",this.upListener),o.markSelection(this),o.markPosses(this),this.params.addClass(document.body,i.noSelect),nt("beforeStart",{el:this.el,pos:d,e:n,drag:this})):this.params.consumeFilteredEvents&&y(n))}.bind(this);this.moveListener=function(n){var r;if(c){if(!ot&&(r=nt("start",{el:this.el,pos:d,e:n,drag:this}),r!==!1)){if(!c)return;this.mark(!0);ot=!0}if(c){k.length=0;var u=a(n),t=u[0]-c[0],i=u[1]-c[1],f=this.params.ignoreZoom?1:o.getZoom();t/=f;i/=f;this.moveBy(t,i,n);o.updateSelection(t,i,this);o.updatePosses(t,i,this)}}}.bind(this);this.upListener=function(n){c&&(c=null,this.params.unbind(document,"mousemove",this.moveListener),this.params.unbind(document,"mouseup",this.upListener),this.params.removeClass(document.body,i.noSelect),this.unmark(n),o.unmarkSelection(this,n),o.unmarkPosses(this,n),this.stop(n),o.notifySelectionDragStop(this,n),o.notifyPosseDragStop(this,n),ot=!1,kt&&(r&&r.parentNode&&r.parentNode.removeChild(r),r=null),k.length=0,pt&&pt(this.el,this.params.getPosition(this.el))===!0&&(this.params.setPosition(this.el,d),nt("revert",this.el)))}.bind(this);this.getFilters=function(){return ft};this.abort=function(){null!=c&&this.upListener()};this.getDragElement=function(){return r||this.el};e={start:[],drag:[],stop:[],over:[],out:[],beforeStart:[],revert:[]};t.events.start&&e.start.push(t.events.start);t.events.beforeStart&&e.beforeStart.push(t.events.beforeStart);t.events.stop&&e.stop.push(t.events.stop);t.events.drag&&e.drag.push(t.events.drag);t.events.revert&&e.revert.push(t.events.revert);this.on=function(n,t){e[n]&&e[n].push(t)};this.off=function(n,t){if(e[n]){for(var r=[],i=0;i<e[n].length;i++)e[n][i]!==t&&r.push(e[n][i]);e[n]=r}};nt=function(n,t){if(e[n])for(var i=0;i<e[n].length;i++)try{e[n][i](t)}catch(n){}};this.notifyStart=function(n){nt("start",{el:this.el,pos:this.params.getPosition(r),e:n,drag:this})};this.stop=function(n,t){var i,s;if(t||ot){var e=[],u=o.getSelection(),f=this.params.getPosition(r);if(u.length>1)for(i=0;i<u.length;i++)s=this.params.getPosition(u[i].el),e.push([u[i].el,{left:s[0],top:s[1]},u[i]]);else e.push([r,{left:f[0],top:f[1]},this]);nt("stop",{el:r,pos:et||f,finalPos:f,e:n,drag:this,selection:e})}};this.mark=function(n){d=this.params.getPosition(r);st=this.params.getPosition(r,!0);ht=[st[0]-d[0],st[1]-d[1]];this.size=this.params.getSize(r);f=o.getMatchingDroppables(this);v(f,!0,!1,this);this.params.addClass(r,this.params.dragClass||i.drag);var t=this.params.getSize(r.parentNode);bt={w:t[0],h:t[1]};n&&o.notifySelectionDragStart(this)};this.unmark=function(n,u){var e,o;if(v(f,!1,!0,this),ut&&lt(this.el)?(et=[r.offsetLeft,r.offsetTop],this.el.parentNode.removeChild(r),r=this.el):et=null,this.params.removeClass(r,this.params.dragClass||i.drag),f.length=0,ut=!1,!u)for(k.length>0&&et&&t.setPosition(this.el,et),k.sort(g),e=0;e<k.length;e++)if(o=k[e].drop(this,n),o===!0)break};this.moveBy=function(n,i,u){var h,o,c,e,v;k.length=0;h=this.toGrid([d[0]+n,d[1]+i]);o=ni(h,r);lt(this.el)&&(h[0]!=o[0]||h[1]!=o[1]?(ut||(c=ri(this.el),t.addClass(c,s.ghostProxy),this.el.parentNode.appendChild(c),r=c,ut=!0),o=h):ut&&(this.el.parentNode.removeChild(r),r=this.el,ut=!1));var l={x:o[0],y:o[1],w:this.size[0],h:this.size[1]},y={x:l.x+ht[0],y:l.y+ht[1],w:l.w,h:l.h},a=null;for(this.params.setPosition(r,o),e=0;e<f.length;e++)v={x:f[e].pagePosition[0],y:f[e].pagePosition[1],w:f[e].size[0],h:f[e].size[1]},this.params.intersects(y,v)&&(ii||null==a||a==f[e].el)&&f[e].canDrop(this)?(a||(a=f[e].el),k.push(f[e]),f[e].setHover(this,!0,u)):f[e].isHover()&&f[e].setHover(this,!1,u);nt("drag",{el:this.el,pos:o,e:u,drag:this})};this.destroy=function(){this.params.unbind(this.el,"mousedown",this.downListener);this.params.unbind(document,"mousemove",this.moveListener);this.params.unbind(document,"mouseup",this.upListener);this.downListener=null;this.upListener=null;this.moveListener=null};this.params.bind(this.el,"mousedown",this.downListener);this.params.handle?wt(this.params.handle,!1):wt(this.params.filter,this.params.filterExclude)},d=function(n,t,i){this._class=i.droppable;this.params=t||{};this.rank=t.rank||0;this._activeClass=this.params.activeClass||i.active;this._hoverClass=this.params.hoverClass||i.hover;p.apply(this,arguments);var r=!1;this.allowLoopback=this.params.allowLoopback!==!1;this.setActive=function(n){this.params[n?"addClass":"removeClass"](this.el,this._activeClass)};this.updatePosition=function(){this.position=this.params.getPosition(this.el);this.pagePosition=this.params.getPosition(this.el,!0);this.size=this.params.getSize(this.el)};this.canDrop=this.params.canDrop||function(){return!0};this.isHover=function(){return r};this.setHover=function(n,t,i){(t||null==this.el._katavorioDragHover||this.el._katavorioDragHover==n.el._katavorio)&&(this.params[t?"addClass":"removeClass"](this.el,this._hoverClass),this.el._katavorioDragHover=t?n.el._katavorio:null,r!==t&&this.params.events[t?"over":"out"]({el:this.el,e:i,drag:n,drop:this}),r=t)};this.drop=function(n,t){return this.params.events.drop({drag:n,e:t,drop:this})};this.destroy=function(){this._class=null;this._activeClass=null;this._hoverClass=null;r=null}},h=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=16*Math.random()|0,i="x"==n?t:3&t|8;return i.toString(16)})},g=function(n,t){return n.rank<t.rank?1:n.rank>t.rank?-1:0},r=function(n){return null==n?null:(n="string"==typeof n||n.constructor==String?document.getElementById(n):n,null==n?null:(n._katavorio=n._katavorio||h(),n))};f.Katavorio=function(f){var o=[],a={},v,w,b,y,tt,h,it;this._dragsByScope={};this._dropsByScope={};var rt=1,p=function(t,i){n(t,function(n){for(var t=0;t<n.scopes.length;t++)i[n.scopes[t]]=i[n.scopes[t]]||[],i[n.scopes[t]].push(n)})},ut=function(t,i){var r=0;return n(t,function(n){for(var u,t=0;t<n.scopes.length;t++)i[n.scopes[t]]&&(u=f.indexOf(i[n.scopes[t]],n),u!=-1&&(i[n.scopes[t]].splice(u,1),r++))}),r>0},ft=(this.getMatchingDroppables=function(n){for(var t,i,r=[],f={},u=0;u<n.scopes.length;u++)if(t=this._dropsByScope[n.scopes[u]],t)for(i=0;i<t.length;i++)t[i].canDrop(n)&&!f[t[i].uuid]&&(t[i].allowLoopback||t[i].el!==n.el)&&(f[t[i].uuid]=!0,r.push(t[i]));return r.sort(g),r},function(n){n=n||{};var t,r={events:{}};for(t in f)r[t]=f[t];for(t in n)r[t]=n[t];for(t=0;t<i.length;t++)r.events[i[t]]=n[i[t]]||ht;return r.katavorio=this,r}.bind(this)),ct=function(n,t){for(var r=0;r<i.length;r++)t[i[r]]&&n.on(i[r],t[i[r]])}.bind(this),l={},et=f.css||{},ot=f.scope||st;for(v in s)l[v]=s[v];for(v in et)l[v]=et[v];w=f.inputFilterSelector||lt;this.getInputFilterSelector=function(){return w};this.setInputFilterSelector=function(n){return w=n,this};this.draggable=function(t,i){var u=[];return n(t,function(n){if(n=r(n),null!=n)if(null==n._katavorioDrag){var t=ft(i);n._katavorioDrag=new k(n,t,l,ot);p(n._katavorioDrag,this._dragsByScope);u.push(n._katavorioDrag);f.addClass(n,l.draggable)}else ct(n._katavorioDrag,i)}.bind(this)),u};this.droppable=function(t,i){var u=[];return n(t,function(n){if(n=r(n),null!=n){var t=new d(n,ft(i),l,ot);n._katavorioDrop=n._katavorioDrop||[];n._katavorioDrop.push(t);p(t,this._dropsByScope);u.push(t);f.addClass(n,l.droppable)}}.bind(this)),u};this.select=function(t){return n(t,function(){var n=r(this);n&&n._katavorioDrag&&(a[n._katavorio]||(o.push(n._katavorioDrag),a[n._katavorio]=[n,o.length-1],f.addClass(n,l.selected)))}),this};this.deselect=function(t){return n(t,function(){var n=r(this),u,i,t;if(n&&n._katavorio&&(u=a[n._katavorio],u)){for(i=[],t=0;t<o.length;t++)o[t].el!==n&&i.push(o[t]);o=i;delete a[n._katavorio];f.removeClass(n,l.selected)}}),this};this.deselectAll=function(){var n,t;for(n in a)t=a[n],f.removeClass(t[0],l.selected);o.length=0;a={}};this.markSelection=function(n){t(o,function(n){n.mark()},n)};this.markPosses=function(i){i.posses&&n(i.posses,function(n){i.posseRoles[n]&&h[n]&&t(h[n].members,function(n){n.mark()},i)})};this.unmarkSelection=function(n,i){t(o,function(n){n.unmark(i)},n)};this.unmarkPosses=function(i,r){i.posses&&n(i.posses,function(n){i.posseRoles[n]&&h[n]&&t(h[n].members,function(n){n.unmark(r,!0)},i)})};this.getSelection=function(){return o.slice(0)};this.updateSelection=function(n,i,r){t(o,function(t){t.moveBy(n,i)},r)};b=function(i,r){r.posses&&n(r.posses,function(n){r.posseRoles[n]&&h[n]&&t(h[n].members,function(n){i(n)},r)})};this.updatePosses=function(n,t,i){b(function(i){i.moveBy(n,t)},i)};this.notifyPosseDragStop=function(n,t){b(function(n){n.stop(t,!0)},n)};this.notifySelectionDragStop=function(n,i){t(o,function(n){n.stop(i,!0)},n)};this.notifySelectionDragStart=function(n,i){t(o,function(n){n.notifyStart(i)},n)};this.setZoom=function(n){rt=n};this.getZoom=function(){return rt};y=function(t,i,r,u){n(t,function(n){ut(n,r);n[u](i);p(n,r)})};n(["set","add","remove","toggle"],function(n){this[n+"Scope"]=function(t,i){y(t._katavorioDrag,i,this._dragsByScope,n+"Scope");y(t._katavorioDrop,i,this._dropsByScope,n+"Scope")}.bind(this);this[n+"DragScope"]=function(t,i){y(t.constructor===k?t:t._katavorioDrag,i,this._dragsByScope,n+"Scope")}.bind(this);this[n+"DropScope"]=function(t,i){y(t.constructor===d?t:t._katavorioDrop,i,this._dropsByScope,n+"Scope")}.bind(this)}.bind(this));this.snapToGrid=function(n,i){for(var r in this._dragsByScope)t(this._dragsByScope[r],function(t){t.snap(n,i)})};this.getDragsForScope=function(n){return this._dragsByScope[n]};this.getDropsForScope=function(n){return this._dropsByScope[n]};tt=function(t,i,u){if(t=r(t),t[i]){var f=o.indexOf(t[i]);f>=0&&o.splice(f,1);ut(t[i],u)&&n(t[i],function(n){n.destroy()});delete t[i]}};this.elementRemoved=function(n){this.destroyDraggable(n);this.destroyDroppable(n)};this.destroyDraggable=function(n){tt(n,"_katavorioDrag",this._dragsByScope)};this.destroyDroppable=function(n){tt(n,"_katavorioDrop",this._dropsByScope)};this.reset=function(){this._dragsByScope={};this._dropsByScope={};o=[];a={};h={}};h={};it=function(t,i,r){var e=u(i)?i:i.id,o=!!u(i)||i.active!==!1,f=h[e]||function(){var n={name:e,members:[]};return h[e]=n,n}();return n(t,function(n){if(n._katavorioDrag){if(r&&null!=n._katavorioDrag.posseRoles[f.name])return;c(f.members,n._katavorioDrag);c(n._katavorioDrag.posses,f.name);n._katavorioDrag.posseRoles[f.name]=o}}),f};this.addToPosse=function(n){for(var t=[],i=1;i<arguments.length;i++)t.push(it(n,arguments[i]));return 1==t.length?t[0]:t};this.setPosse=function(t){for(var i=[],r=1;r<arguments.length;r++)i.push(it(t,arguments[r],!0).name);return n(t,function(n){var r,u,t;if(n._katavorioDrag)for(r=nt(n._katavorioDrag.posses,i),u=[],Array.prototype.push.apply(u,n._katavorioDrag.posses),t=0;t<r.length;t++)this.removeFromPosse(n,r[t])}.bind(this)),1==i.length?i[0]:i};this.removeFromPosse=function(t,i){if(arguments.length<2)throw new TypeError("No posse id provided for remove operation");for(var r=1;r<arguments.length;r++)i=arguments[r],n(t,function(t){if(t._katavorioDrag&&t._katavorioDrag.posses){var r=t._katavorioDrag;n(i,function(n){e(h[n].members,r);e(r.posses,n);delete r.posseRoles[n]})}})};this.removeFromAllPosses=function(t){n(t,function(t){if(t._katavorioDrag&&t._katavorioDrag.posses){var i=t._katavorioDrag;n(i.posses,function(n){e(h[n].members,i)});i.posses.length=0;i.posseRoles={}}})};this.setPosseState=function(t,i,r){var u=h[i];u&&n(t,function(n){n._katavorioDrag&&n._katavorioDrag.posses&&(n._katavorioDrag.posseRoles[u.name]=r)})}};f.Katavorio.version="0.19.2";"undefined"!=typeof exports&&(exports.Katavorio=f.Katavorio)}.call("undefined"!=typeof window?window:this),function(){var t=function(n){return"[object Array]"===Object.prototype.toString.call(n)},o=function(n){return"[object Number]"===Object.prototype.toString.call(n)},r=function(n){return"string"==typeof n},u=function(n){return"boolean"==typeof n},s=function(n){return null==n},i=function(n){return null!=n&&"[object Object]"===Object.prototype.toString.call(n)},e=function(n){return"[object Date]"===Object.prototype.toString.call(n)},f=function(n){return"[object Function]"===Object.prototype.toString.call(n)},h=function(n){for(var t in n)if(n.hasOwnProperty(t))return!1;return!0},n=this;n.jsPlumbUtil={isArray:t,isString:r,isBoolean:u,isNull:s,isObject:i,isDate:e,isFunction:f,isEmpty:h,isNumber:o,clone:function(n){var s,o,h,c;if(r(n))return""+n;if(u(n))return!!n;if(e(n))return new Date(n.getTime());if(f(n))return n;if(t(n)){for(s=[],o=0;o<n.length;o++)s.push(this.clone(n[o]));return s}if(i(n)){h={};for(c in n)h[c]=this.clone(n[c]);return h}return n},merge:function(n,f,e){var h,o,l={},s,c;for(e=e||[],o=0;o<e.length;o++)l[e[o]]=!0;s=this.clone(n);for(o in f)if(null==s[o])s[o]=f[o];else if(r(f[o])||u(f[o]))l[o]?(h=[],h.push.apply(h,t(s[o])?s[o]:[s[o]]),h.push.apply(h,t(f[o])?f[o]:[f[o]]),s[o]=h):s[o]=f[o];else if(t(f[o]))h=[],t(s[o])&&h.push.apply(h,s[o]),h.push.apply(h,f[o]),s[o]=h;else if(i(f[o])){i(s[o])||(s[o]={});for(c in f[o])s[o][c]=f[o][c]}return s},replace:function(n,t,i){if(null!=n){var u=n,r=u;return t.replace(/([^\.])+/g,function(n,t,u,f){var e=n.match(/([^\[0-9]+){1}(\[)([0-9+])/),h=u+n.length>=f.length,s=function(){return r[e[1]]||function(){return r[e[1]]=[],r[e[1]]}()},o;h?e?s()[e[3]]=i:r[n]=i:e?(o=s(),r=o[e[3]]||function(){return o[e[3]]={},o[e[3]]}()):r=r[n]||function(){return r[n]={},r[n]}()}),n}},functionChain:function(n,t,i){for(var u,r=0;r<i.length;r++)if(u=i[r][0][i[r][1]].apply(i[r][0],i[r][2]),u===t)return u;return n},populate:function(n,u,e){var s=function(n){var i=n.match(/(\${.*?})/g),t,r;if(null!=i)for(t=0;t<i.length;t++)r=u[i[t].substring(2,i[t].length-1)]||"",null!=r&&(n=n.replace(i[t],r));return n},o=function(n){var c,h,l,a;if(null!=n){if(r(n))return s(n);if(!f(n)||null!=e&&0!==(n.name||"").indexOf(e)){if(t(n)){for(c=[],h=0;h<n.length;h++)c.push(o(n[h]));return c}if(i(n)){l={};for(a in n)l[a]=o(n[a]);return l}return n}return n(u)}};return o(n)},findWithFunction:function(n,t){if(n)for(var i=0;i<n.length;i++)if(t(n[i]))return i;return-1},removeWithFunction:function(t,i){var r=n.jsPlumbUtil.findWithFunction(t,i);return r>-1&&t.splice(r,1),r!==-1},remove:function(n,t){var i=n.indexOf(t);return i>-1&&n.splice(i,1),i!==-1},addWithFunction:function(t,i,r){n.jsPlumbUtil.findWithFunction(t,r)===-1&&t.push(i)},addToList:function(n,t,i,r){var u=n[t];return null==u&&(u=[],n[t]=u),u[r?"unshift":"push"](i),u},suggest:function(n,t,i){return n.indexOf(t)===-1&&(i?n.unshift(t):n.push(t),!0)},extend:function(n,i){var r,u,f,e;for(i=t(i)?i:[i],r=0;r<i.length;r++)for(u in i[r].prototype)i[r].prototype.hasOwnProperty(u)&&(n.prototype[u]=i[r].prototype[u]);if(f=function(n,t){return function(){for(r=0;r<i.length;r++)i[r].prototype[n]&&i[r].prototype[n].apply(this,arguments);return t.apply(this,arguments)}},e=function(t){for(var i in t)n.prototype[i]=f(i,t[i])},arguments.length>2)for(r=2;r<arguments.length;r++)e(arguments[r]);return n},uuid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=16*Math.random()|0,i="x"===n?t:3&t|8;return i.toString(16)})},logEnabled:!0,log:function(){if(n.jsPlumbUtil.logEnabled&&"undefined"!=typeof console)try{var t=arguments[arguments.length-1]}catch(t){}},wrap:function(t,i,r){return t=t||function(){},i=i||function(){},function(){var u=null;try{u=i.apply(this,arguments)}catch(t){n.jsPlumbUtil.log("jsPlumb function failed : "+t)}if(null==r||u!==r)try{u=t.apply(this,arguments)}catch(t){n.jsPlumbUtil.log("wrapped function failed : "+t)}return u}}};n.jsPlumbUtil.EventGenerator=function(){var t={},i=!1,r=!1,e={ready:!0},u=[],f;this.bind=function(i,r,u){var e=function(i){n.jsPlumbUtil.addToList(t,i,r,u);r.__jsPlumb=r.__jsPlumb||{};r.__jsPlumb[n.jsPlumbUtil.uuid()]=i},f;if("string"==typeof i)e(i);else if(null!=i.length)for(f=0;f<i.length;f++)e(i[f]);return this};this.fire=function(o,s,h){if(r)u.unshift(arguments);else{if(r=!0,!i&&t[o]){var v=t[o].length,c=0,l=!1,a=null;if(!this.shouldFireEvent||this.shouldFireEvent(o,s,h))for(;!l&&c<v&&a!==!1;){if(e[o])t[o][c].apply(this,[s,h]);else try{a=t[o][c].apply(this,[s,h])}catch(t){n.jsPlumbUtil.log("jsPlumb: fire failed for event "+o+" : "+t)}c++;null!=t&&null!=t[o]||(l=!0)}}r=!1;f()}return this};f=function(){var n=u.pop();n&&this.fire.apply(this,n)}.bind(this);this.unbind=function(i,r){var u,f;if(0===arguments.length)t={};else if(1===arguments.length){if("string"==typeof i)delete t[i];else if(i.__jsPlumb)for(f in i.__jsPlumb)u=i.__jsPlumb[f],n.jsPlumbUtil.remove(t[u]||[],i)}else 2===arguments.length&&n.jsPlumbUtil.remove(t[i]||[],r);return this};this.getListener=function(n){return t[n]};this.setSuspendEvents=function(n){i=n};this.isSuspendEvents=function(){return i};this.silently=function(t){this.setSuspendEvents(!0);try{t()}catch(t){n.jsPlumbUtil.log("Cannot execute silent function "+t)}this.setSuspendEvents(!1)};this.cleanupListeners=function(){for(var n in t)t[n]=null}};n.jsPlumbUtil.EventGenerator.prototype={cleanup:function(){this.cleanupListeners()}};"undefined"!=typeof exports&&(exports.jsPlumbUtil=n.jsPlumbUtil)}.call("undefined"!=typeof window?window:this),function(){"use strict";var n=this;n.jsPlumbUtil.matchesSelector=function(n,t,i){i=i||n.parentNode;for(var u=i.querySelectorAll(t),r=0;r<u.length;r++)if(u[r]===n)return!0;return!1};n.jsPlumbUtil.consume=function(n,t){n.stopPropagation?n.stopPropagation():n.returnValue=!1;!t&&n.preventDefault&&n.preventDefault()};n.jsPlumbUtil.sizeElement=function(n,t,i,r,u){n&&(n.style.height=u+"px",n.height=u,n.style.width=r+"px",n.width=r,n.style.left=t+"px",n.style.top=i+"px")}}.call("undefined"!=typeof window?window:this),function(){"use strict";var o,t=this,f=[],n=t.jsPlumbUtil,u=function(){return""+(new Date).getTime()},c=function(n){if(n._jsPlumb.paintStyle&&n._jsPlumb.hoverPaintStyle){var t={};i.extend(t,n._jsPlumb.paintStyle);i.extend(t,n._jsPlumb.hoverPaintStyle);delete n._jsPlumb.hoverPaintStyle;t.gradient&&n._jsPlumb.paintStyle.fill&&delete t.gradient;n._jsPlumb.hoverPaintStyle=t}},l=["tap","dbltap","click","dblclick","mouseover","mouseout","mousemove","mousedown","mouseup","contextmenu"],w=function(n,t,i,r){var f=n.getAttachedElements(),u,e;if(f)for(u=0,e=f.length;u<e;u++)r&&r===f[u]||f[u].setHover(t,!0,i)},e=function(n){return null==n?null:n.split(" ")},a=function(n,t,i){for(var r in t)n[r]=i},v=function(t,i){i=n.isArray(i)||null!=i.length&&!n.isString(i)?i:[i];for(var r=0;r<i.length;r++)try{t.apply(i[r],[i[r]])}catch(t){n.log(".each iteration failed : "+t)}},r=function(t,i,r){var f,c,e,o;if(t.getDefaultType){var l=t.getTypeDescriptor(),s={},h=t.getDefaultType(),u=n.merge({},h);for(a(s,h,"__default"),f=0,c=t._jsPlumb.types.length;f<c;f++)e=t._jsPlumb.types[f],"__default"!==e&&(o=t._jsPlumb.instance.getType(e,l),null!=o&&(u=n.merge(u,o,["cssClass"]),a(s,o,e)));i&&(u=n.populate(u,i,"_"));t.applyType(u,r,s);r||t.repaint()}},y=t.jsPlumbUIComponent=function(t){var u,f,r,e,o,s,h;n.EventGenerator.apply(this,arguments);var c=this,l=arguments,a=c.idPrefix,v=a+(new Date).getTime();if(this._jsPlumb={instance:t._jsPlumb,parameters:t.parameters||{},paintStyle:null,hoverPaintStyle:null,paintStyleInUse:null,hover:!1,beforeDetach:t.beforeDetach,beforeDrop:t.beforeDrop,overlayPlacements:[],hoverClass:t.hoverClass||t._jsPlumb.Defaults.HoverClass,types:[],typeCache:{}},this.cacheTypeItem=function(n,t,i){this._jsPlumb.typeCache[i]=this._jsPlumb.typeCache[i]||{};this._jsPlumb.typeCache[i][n]=t},this.getCachedTypeItem=function(n,t){return this._jsPlumb.typeCache[t]?this._jsPlumb.typeCache[t][n]:null},this.getId=function(){return v},u=t.overlays||[],f={},this.defaultOverlayKeys){for(r=0;r<this.defaultOverlayKeys.length;r++)Array.prototype.push.apply(u,this._jsPlumb.instance.Defaults[this.defaultOverlayKeys[r]]||[]);for(r=0;r<u.length;r++)e=i.convertToFullOverlaySpec(u[r]),f[e[1].id]=e}if(o={overlays:f,parameters:t.parameters||{},scope:t.scope||this._jsPlumb.instance.getDefaultScope()},this.getDefaultType=function(){return o},this.appendToDefaultType=function(n){for(var t in n)o[t]=n[t]},t.events)for(s in t.events)c.bind(s,t.events[s]);this.clone=function(){var n=Object.create(this.constructor.prototype);return this.constructor.apply(n,l),n}.bind(this);this.isDetachAllowed=function(t){var i=!0;if(this._jsPlumb.beforeDetach)try{i=this._jsPlumb.beforeDetach(t)}catch(t){n.log("jsPlumb: beforeDetach callback failed",t)}return i};this.isDropAllowed=function(t,i,r,u,f,e,o){var s=this._jsPlumb.instance.checkCondition("beforeDrop",{sourceId:t,targetId:i,scope:r,connection:u,dropEndpoint:f,source:e,target:o});if(this._jsPlumb.beforeDrop)try{s=this._jsPlumb.beforeDrop({sourceId:t,targetId:i,scope:r,connection:u,dropEndpoint:f,source:e,target:o})}catch(t){n.log("jsPlumb: beforeDrop callback failed",t)}return s};h=[];this.setListenerComponent=function(n){for(var t=0;t<h.length;t++)h[t][3]=n}},s=function(n,t){var r=n._jsPlumb.types[t],i=n._jsPlumb.instance.getType(r,n.getTypeDescriptor());null!=i&&i.cssClass&&n.canvas&&n._jsPlumb.instance.removeClass(n.canvas,i.cssClass)},i;n.extend(t.jsPlumbUIComponent,n.EventGenerator,{getParameter:function(n){return this._jsPlumb.parameters[n]},setParameter:function(n,t){this._jsPlumb.parameters[n]=t},getParameters:function(){return this._jsPlumb.parameters},setParameters:function(n){this._jsPlumb.parameters=n},getClass:function(){return i.getClass(this.canvas)},hasClass:function(n){return i.hasClass(this.canvas,n)},addClass:function(n){i.addClass(this.canvas,n)},removeClass:function(n){i.removeClass(this.canvas,n)},updateClasses:function(n,t){i.updateClasses(this.canvas,n,t)},setType:function(n,t,i){this.clearTypes();this._jsPlumb.types=e(n)||[];r(this,t,i)},getType:function(){return this._jsPlumb.types},reapplyTypes:function(n,t){r(this,n,t)},hasType:function(n){return this._jsPlumb.types.indexOf(n)!==-1},addType:function(n,t,i){var f=e(n),o=!1,u,s;if(null!=f){for(u=0,s=f.length;u<s;u++)this.hasType(f[u])||(this._jsPlumb.types.push(f[u]),o=!0);o&&r(this,t,i)}},removeType:function(n,t,i){var f=e(n),o=!1,c=function(n){var t=this._jsPlumb.types.indexOf(n);return t!==-1&&(s(this,t),this._jsPlumb.types.splice(t,1),!0)}.bind(this),u,h;if(null!=f){for(u=0,h=f.length;u<h;u++)o=c(f[u])||o;o&&r(this,t,i)}},clearTypes:function(n,t){for(var u=this._jsPlumb.types.length,i=0;i<u;i++)s(this,0),this._jsPlumb.types.splice(0,1);r(this,n,t)},toggleType:function(n,t,i){var f=e(n),u,h,o;if(null!=f){for(u=0,h=f.length;u<h;u++)o=this._jsPlumb.types.indexOf(f[u]),o!==-1?(s(this,o),this._jsPlumb.types.splice(o,1)):this._jsPlumb.types.push(f[u]);r(this,t,i)}},applyType:function(n,t){if(this.setPaintStyle(n.paintStyle,t),this.setHoverPaintStyle(n.hoverPaintStyle,t),n.parameters)for(var i in n.parameters)this.setParameter(i,n.parameters[i]);this._jsPlumb.paintStyleInUse=this.getPaintStyle()},setPaintStyle:function(n,t){this._jsPlumb.paintStyle=n;this._jsPlumb.paintStyleInUse=this._jsPlumb.paintStyle;c(this);t||this.repaint()},getPaintStyle:function(){return this._jsPlumb.paintStyle},setHoverPaintStyle:function(n,t){this._jsPlumb.hoverPaintStyle=n;c(this);t||this.repaint()},getHoverPaintStyle:function(){return this._jsPlumb.hoverPaintStyle},destroy:function(n){(n||null==this.typeId)&&(this.cleanupListeners(),this.clone=null,this._jsPlumb=null)},isHover:function(){return this._jsPlumb.hover},setHover:function(n,t,i){if(this._jsPlumb&&!this._jsPlumb.instance.currentlyDragging&&!this._jsPlumb.instance.isHoverSuspended()){this._jsPlumb.hover=n;var r=n?"addClass":"removeClass";null!=this.canvas&&(null!=this._jsPlumb.instance.hoverClass&&this._jsPlumb.instance[r](this.canvas,this._jsPlumb.instance.hoverClass),null!=this._jsPlumb.hoverClass&&this._jsPlumb.instance[r](this.canvas,this._jsPlumb.hoverClass));null!=this._jsPlumb.hoverPaintStyle&&(this._jsPlumb.paintStyleInUse=n?this._jsPlumb.hoverPaintStyle:this._jsPlumb.paintStyle,this._jsPlumb.instance.isSuspendDrawing()||(i=i||u(),this.repaint({timestamp:i,recalc:!1})));this.getAttachedElements&&!t&&w(this,n,u(),this)}}});var p=0,b=function(){var n=p+1;return p++,n},h=t.jsPlumbInstance=function(r){var ni,k,g,nr,fi,yt,tr,bt,rr,si,gt,hi,ct,lt,ci,li,ai;this.version="2.5.0";r&&i.extend(this.Defaults,r);this.logEnabled=this.Defaults.LogEnabled;this._connectionTypes={};this._endpointTypes={};n.EventGenerator.apply(this);var e=this,vi=b(),ur=e.bind,yi={},at=1,c=function(t){if(null==t)return null;if(3===t.nodeType||8===t.nodeType)return{el:t,text:!0};var i=e.getElement(t);return{el:i,id:n.isString(t)&&null==i?t:p(i)}};this.getInstanceIndex=function(){return vi};this.setZoom=function(n,t){return at=n,e.fire("zoom",at),t&&e.repaintEverything(),!0};this.getZoom=function(){return at};for(ni in this.Defaults)yi[ni]=this.Defaults[ni];g=[];this.unbindContainer=function(){if(null!=k&&g.length>0)for(var n=0;n<g.length;n++)e.off(k,g[n][0],g[n][1])};this.setContainer=function(n){var i,o,t;this.unbindContainer();n=this.getElement(n);this.select().each(function(t){t.moveParent(n)});this.selectEndpoints().each(function(t){t.moveParent(n)});i=k;k=n;g.length=0;for(var s={endpointclick:"endpointClick",endpointdblclick:"endpointDblClick"},r=function(n,t,i){var r=t.srcElement||t.target,u=(r&&r.parentNode?r.parentNode._jsPlumb:null)||(r?r._jsPlumb:null)||(r&&r.parentNode&&r.parentNode.parentNode?r.parentNode.parentNode._jsPlumb:null),f;u&&(u.fire(n,u,t),f=i?s[i+n]||n:n,e.fire(f,u.component||u,t))},u=function(n,t,i){g.push([n,i]);e.on(k,n,t,i)},h=function(n){u(n,".jtk-connector",function(t){r(n,t)});u(n,".jtk-endpoint",function(t){r(n,t,"endpoint")});u(n,".jtk-overlay",function(t){r(n,t)})},f=0;f<l.length;f++)h(l[f]);for(o in a)t=a[o].el,t.parentNode===i&&(i.removeChild(t),k.appendChild(t))};this.getContainer=function(){return k};this.bind=function(n,t){"ready"===n&&ti?t():ur.apply(e,[n,t])};e.importDefaults=function(n){for(var t in n)e.Defaults[t]=n[t];return n.Container&&e.setContainer(n.Container),e};e.restoreDefaults=function(){return e.Defaults=i.extend({},yi),e};var pi=null,ti=!1,d=[],s={},nt={},a={},h={},vt={},rt={},wi=!1,w=[],ut=!1,ft=null,bi=this.Defaults.Scope,fr=1,ot=function(){return""+fr++},er=function(n,t){k?k.appendChild(n):t?this.getElement(t).appendChild(n):this.appendToRoot(n)}.bind(this),st=function(n,t,i,r){var f,s,c,o,h,l;if(!ut){if(s=p(n),c=e.getDragManager(),c&&(f=c.getElementsForDraggable(s)),null==i&&(i=u()),o=dt({elId:s,offset:t,recalc:!1,timestamp:i}),f&&o&&o.o)for(h in f)dt({elId:f[h].id,offset:{left:o.o.left+f[h].offset.left,top:o.o.top+f[h].offset.top},recalc:!1,timestamp:i});if(e.anchorManager.redraw(s,t,i,null,r),f)for(l in f)e.anchorManager.redraw(f[l].id,t,i,f[l].offset,r,!0)}},ii=function(n){return nt[n]},or=function(t,r,u,f,o){var a,s,c,l;if(!i.headless&&(a=null!=r&&r,a&&i.isDragSupported(t,e)))if(s=u||e.Defaults.DragOptions,s=i.extend({},s),i.isAlreadyDraggable(t,e))u.force&&e.initDraggable(t,s);else{var v=i.dragEvents.drag,y=i.dragEvents.stop,w=i.dragEvents.start,h=!1;oi(f,t);s[w]=n.wrap(s[w],function(){if(e.setHoverSuspended(!0),e.select({source:t}).addClass(e.elementDraggingClass+" "+e.sourceElementDraggingClass,!0),e.select({target:t}).addClass(e.elementDraggingClass+" "+e.targetElementDraggingClass,!0),e.setConnectionBeingDragged(!0),s.canDrag)return u.canDrag()},!1);s[v]=n.wrap(s[v],function(){var n=e.getUIPosition(arguments,e.getZoom());null!=n&&(st(t,n,null,!0),h&&e.addClass(t,"jtk-dragged"),h=!0)});s[y]=n.wrap(s[y],function(){for(var t,i=arguments[0].selection,r=function(n){null!=n[1]&&(t=e.getUIPosition([{el:n[2].el,pos:[n[1].left,n[1].top]}]),st(n[2].el,t));e.removeClass(n[0],"jtk-dragged");e.select({source:n[2].el}).removeClass(e.elementDraggingClass+" "+e.sourceElementDraggingClass,!0);e.select({target:n[2].el}).removeClass(e.elementDraggingClass+" "+e.targetElementDraggingClass,!0);e.getDragManager().dragEnded(n[2].el)},n=0;n<i.length;n++)r(i[n]);h=!1;e.setHoverSuspended(!1);e.setConnectionBeingDragged(!1)});c=p(t);rt[c]=!0;l=rt[c];s.disabled=null!=l&&!l;e.initDraggable(t,s);e.getDragManager().register(t);o&&e.fire("elementDraggable",{el:t,options:s})}},sr=function(n,t){for(var i,u=n.scope.split(/\s/),f=t.scope.split(/\s/),r=0;r<u.length;r++)for(i=0;i<f.length;i++)if(f[i]===u[r])return!0;return!1},hr=function(t,r){var u=i.extend({},t),f,o;if(r&&i.extend(u,r),u.source&&(u.source.endpoint?u.sourceEndpoint=u.source:u.source=e.getElement(u.source)),u.target&&(u.target.endpoint?u.targetEndpoint=u.target:u.target=e.getElement(u.target)),t.uuids&&(u.sourceEndpoint=ii(t.uuids[0]),u.targetEndpoint=ii(t.uuids[1])),u.sourceEndpoint&&u.sourceEndpoint.isFull())return void n.log(e,"could not add connection; source endpoint is full");if(u.targetEndpoint&&u.targetEndpoint.isFull())return void n.log(e,"could not add connection; target endpoint is full");if(!u.type&&u.sourceEndpoint&&(u.type=u.sourceEndpoint.connectionType),u.sourceEndpoint&&u.sourceEndpoint.connectorOverlays)for(u.overlays=u.overlays||[],f=0,o=u.sourceEndpoint.connectorOverlays.length;f<o;f++)u.overlays.push(u.sourceEndpoint.connectorOverlays[f]);u.sourceEndpoint&&u.sourceEndpoint.scope&&(u.scope=u.sourceEndpoint.scope);!u["pointer-events"]&&u.sourceEndpoint&&u.sourceEndpoint.connectorPointerEvents&&(u["pointer-events"]=u.sourceEndpoint.connectorPointerEvents);var h=function(n,t){var u=i.extend({},n);for(var r in t)t[r]&&(u[r]=t[r]);return u},c=function(n,t,i){return e.addEndpoint(n,h(t,{anchor:u.anchors?u.anchors[i]:u.anchor,endpoint:u.endpoints?u.endpoints[i]:u.endpoint,paintStyle:u.endpointStyles?u.endpointStyles[i]:u.endpointStyle,hoverPaintStyle:u.endpointHoverStyles?u.endpointHoverStyles[i]:u.endpointHoverStyle}))},s=function(n,t,i,r){var o,f,e;if(u[n]&&!u[n].endpoint&&!u[n+"Endpoint"]&&!u.newConnection&&(o=p(u[n]),f=i[o],f=f?f[r]:null)){if(!f.enabled||(e=null!=f.endpoint&&f.endpoint._jsPlumb?f.endpoint:c(u[n],f.def,t),e.isFull()))return!1;u[n+"Endpoint"]=e;!u.scope&&f.def.scope&&(u.scope=f.def.scope);e.setDeleteOnEmpty(!0);f.uniqueEndpoint&&(f.endpoint?e.finalEndpoint=f.endpoint:(f.endpoint=e,e.setDeleteOnEmpty(!1)))}};if(s("source",0,this.sourceEndpointDefinitions,u.type||"default")!==!1&&s("target",1,this.targetEndpointDefinitions,u.type||"default")!==!1)return(u.sourceEndpoint&&u.targetEndpoint&&(sr(u.sourceEndpoint,u.targetEndpoint)||(u=null)),u)}.bind(e),ri=function(n){var i=e.Defaults.ConnectionType||e.getDefaultConnectionType(),t;return n._jsPlumb=e,n.newConnection=ri,n.newEndpoint=ui,n.endpointsByUUID=nt,n.endpointsByElement=s,n.finaliseConnection=ki,n.id="con_"+ot(),t=new i(n),t.isDetachable()&&(t.endpoints[0].initDraggable("_jsPlumbSource"),t.endpoints[1].initDraggable("_jsPlumbTarget")),t},ki=e.finaliseConnection=function(n,t,i,r){if(t=t||{},n.suspendedEndpoint||d.push(n),n.pending=null,n.endpoints[0].isTemporarySource=!1,r!==!1&&e.anchorManager.newConnection(n),st(n.source),!t.doNotFireConnectionEvent&&t.fireEvent!==!1){var u={connection:n,source:n.source,target:n.target,sourceId:n.sourceId,targetId:n.targetId,sourceEndpoint:n.endpoints[0],targetEndpoint:n.endpoints[1]};e.fire("connection",u,i)}},ui=function(n,t){var f=e.Defaults.EndpointType||i.Endpoint,r=i.extend({},n),u;return r._jsPlumb=e,r.newConnection=ri,r.newEndpoint=ui,r.endpointsByUUID=nt,r.endpointsByElement=s,r.fireDetachEvent=yt,r.elementId=t||p(r.source),u=new f(r),u.id="ep_"+ot(),oi(r.elementId,r.source),i.headless||e.getDragManager().endpointAdded(r.source,t),u},di=function(n,t,i){var r=s[n],u,e,f,o,h;if(r&&r.length)for(u=0,e=r.length;u<e;u++){for(f=0,o=r[u].connections.length;f<o;f++)if(h=t(r[u].connections[f]),h)return;i&&i(r[u])}},cr=function(n,t){return i.each(n,function(n){e.isDragSupported(n)&&(rt[e.getAttribute(n,"id")]=t,e.setElementDraggable(n,t))})},gi=function(n,t,i){var r,u;t="block"===t;r=null;i&&(r=function(n){n.setVisible(t,!0,!0)});u=c(n);di(u.id,function(n){if(t&&i){var r=n.sourceId===u.id?1:0;n.endpoints[r].isVisible()&&n.setVisible(!0)}else n.setVisible(t)},r)},lr=function(n){var t;return i.each(n,function(n){var i=e.getAttribute(n,"id");return t=null!=rt[i]&&rt[i],t=!t,rt[i]=t,e.setDraggable(n,t),t}.bind(this)),t},ar=function(n,t){var i=null;t&&(i=function(n){var t=n.isVisible();n.setVisible(!t)});di(n,function(n){var t=n.isVisible();n.setVisible(!t)},i)},vr=function(n){var t=h[n];return t?{o:t,s:w[n]}:dt({elId:n})},p=function(t,i,r){if(n.isString(t))return t;if(null==t)return null;var u=e.getAttribute(t,"id");return u&&"undefined"!==u||(2===arguments.length&&void 0!==arguments[1]?u=i:(1===arguments.length||3===arguments.length&&!arguments[2])&&(u="jsPlumb_"+vi+"_"+ot()),r||e.setAttribute(t,"id",u)),u};this.setConnectionBeingDragged=function(n){wi=n};this.isConnectionBeingDragged=function(){return wi};this.getManagedElements=function(){return a};this.connectorClass="jtk-connector";this.connectorOutlineClass="jtk-connector-outline";this.editableConnectorClass="jtk-connector-editable";this.connectedClass="jtk-connected";this.hoverClass="jtk-hover";this.endpointClass="jtk-endpoint";this.endpointConnectedClass="jtk-endpoint-connected";this.endpointFullClass="jtk-endpoint-full";this.endpointDropAllowedClass="jtk-endpoint-drop-allowed";this.endpointDropForbiddenClass="jtk-endpoint-drop-forbidden";this.overlayClass="jtk-overlay";this.draggingClass="jtk-dragging";this.elementDraggingClass="jtk-element-dragging";this.sourceElementDraggingClass="jtk-source-element-dragging";this.targetElementDraggingClass="jtk-target-element-dragging";this.endpointAnchorClassPrefix="jtk-endpoint-anchor";this.hoverSourceClass="jtk-source-hover";this.hoverTargetClass="jtk-target-hover";this.dragSelectClass="jtk-drag-select";this.Anchors={};this.Connectors={svg:{}};this.Endpoints={svg:{}};this.Overlays={svg:{}};this.ConnectorRenderers={};this.SVG="svg";this.addEndpoint=function(t,r,u){var f;u=u||{};f=i.extend({},u);i.extend(f,r);f.endpoint=f.endpoint||e.Defaults.Endpoint;f.paintStyle=f.paintStyle||e.Defaults.EndpointStyle;for(var h=[],a=n.isArray(t)||null!=t.length&&!n.isString(t)?t:[t],l=0,y=a.length;l<y;l++){f.source=e.getElement(a[l]);kt(f.source);var c=p(f.source),o=ui(f,c),v=oi(c,f.source).info.o;n.addToList(s,c,o);ut||o.paint({anchorLoc:o.anchor.compute({xy:[v.left,v.top],wh:w[c],element:o,timestamp:ft}),timestamp:ft});h.push(o)}return 1===h.length?h[0]:h};this.addEndpoints=function(t,i,r){for(var u,f=[],o=0,s=i.length;o<s;o++)u=e.addEndpoint(t,i[o],r),n.isArray(u)?Array.prototype.push.apply(f,u):f.push(u);return f};this.animate=function(t,r,u){if(!this.animationSupported)return!1;u=u||{};var f=e.getElement(t),o=p(f),s=i.animEvents.step,h=i.animEvents.complete;u[s]=n.wrap(u[s],function(){e.revalidate(o)});u[h]=n.wrap(u[h],function(){e.revalidate(o)});e.doAnimate(f,r,u)};this.checkCondition=function(t,i){var r=e.getListener(t),f=!0,o,u,s;if(r&&r.length>0){o=Array.prototype.slice.call(arguments,1);try{for(u=0,s=r.length;u<s;u++)f=f&&r[u].apply(r[u],o)}catch(i){n.log(e,"cannot check condition ["+t+"]"+i)}}return f};this.connect=function(t,i){var u,r=hr(t,i);if(r){if(null==r.source&&null==r.sourceEndpoint)return void n.log("Cannot establish connection - source does not exist");if(null==r.target&&null==r.targetEndpoint)return void n.log("Cannot establish connection - target does not exist");kt(r.source);u=ri(r);ki(u,r)}return u};nr=[{el:"source",elId:"sourceId",epDefs:"sourceEndpointDefinitions"},{el:"target",elId:"targetId",epDefs:"targetEndpointDefinitions"}];fi=function(n,t,r,u){var f,h,e,s=nr[r],l=n[s.elId],a=(n[s.el],n.endpoints[r]),c={index:r,originalSourceId:0===r?l:n.sourceId,newSourceId:n.sourceId,originalTargetId:1===r?l:n.targetId,newTargetId:n.targetId,connection:n},o;if(t.constructor===i.Endpoint)f=t,f.addConnection(n),t=f.element;else if(h=p(t),e=this[s.epDefs][h],h===n[s.elId])f=null;else if(e)for(o in e){if(!e[o].enabled)return;f=null!=e[o].endpoint&&e[o].endpoint._jsPlumb?e[o].endpoint:this.addEndpoint(t,e[o].def);e[o].uniqueEndpoint&&(e[o].endpoint=f);f.addConnection(n)}else f=n.makeEndpoint(0===r,t,h);return null!=f&&(a.detachFromConnection(n),n.endpoints[r]=f,n[s.el]=f.element,n[s.elId]=f.elementId,c[0===r?"newSourceId":"newTargetId"]=f.elementId,tr(c),u||n.repaint()),c.element=t,c}.bind(this);this.setSource=function(n,t,i){var r=fi(n,t,0,i);this.anchorManager.sourceChanged(r.originalSourceId,r.newSourceId,n,r.el)};this.setTarget=function(n,t,i){var r=fi(n,t,1,i);this.anchorManager.updateOtherEndpoint(r.originalSourceId,r.originalTargetId,r.newTargetId,n)};this.deleteEndpoint=function(n,t,i){var r="string"==typeof n?nt[n]:n;return r&&e.deleteObject({endpoint:r,dontUpdateHover:t,deleteAttachedObjects:i}),e};this.deleteEveryEndpoint=function(){var f=e.setSuspendDrawing(!0),r,n,t,u,i;for(r in s)if(n=s[r],n&&n.length)for(t=0,u=n.length;t<u;t++)e.deleteEndpoint(n[t],!0);return s={},a={},nt={},h={},vt={},e.anchorManager.reset(),i=e.getDragManager(),i&&i.reset(),f||e.setSuspendDrawing(!1),e};yt=function(n,t,i){var u=e.Defaults.ConnectionType||e.getDefaultConnectionType(),f=n.constructor===u,r=f?{connection:n,source:n.source,target:n.target,sourceId:n.sourceId,targetId:n.targetId,sourceEndpoint:n.endpoints[0],targetEndpoint:n.endpoints[1]}:n;t&&e.fire("connectionDetached",r,i);e.fire("internal.connectionDetached",r,i);e.anchorManager.connectionDetached(r)};tr=e.fireMoveEvent=function(n,t){e.fire("connectionMoved",n,t)};this.unregisterEndpoint=function(n){var t,i;n._jsPlumb.uuid&&(nt[n._jsPlumb.uuid]=null);e.anchorManager.deleteEndpoint(n);for(t in s){if(i=s[t],i){for(var u=[],r=0,f=i.length;r<f;r++)i[r]!==n&&u.push(i[r]);s[t]=u}s[t].length<1&&delete s[t]}};var ei="isDetachAllowed",yr="beforeDetach",pr="checkCondition";this.deleteConnection=function(t,i){return!(null==t||(i=i||{},!i.force&&!n.functionChain(!0,!1,[[t.endpoints[0],ei,[t]],[t.endpoints[1],ei,[t]],[t,ei,[t]],[e,pr,[yr,t]]])))&&(t.setHover(!1),yt(t,!t.pending&&i.fireEvent!==!1,i.originalEvent),t.endpoints[0].detachFromConnection(t),t.endpoints[1].detachFromConnection(t),n.removeWithFunction(d,function(n){return t.id===n.id}),t.cleanup(),t.destroy(),!0)};this.deleteEveryConnection=function(n){n=n||{};var i=d.length,t=0;return e.batch(function(){for(var r=0;r<i;r++)t+=e.deleteConnection(d[0],n)?1:0}),t};this.deleteConnectionsForElement=function(n,t){var u,i,r,f;if(t=t||{},n=e.getElement(n),u=p(n),i=s[u],i&&i.length)for(r=0,f=i.length;r<f;r++)i[r].deleteEveryConnection(t);return e};this.deleteObject=function(t){var i={endpoints:{},connections:{},endpointCount:0,connectionCount:0},c=t.deleteAttachedObjects!==!1,o=function(n){null!=n&&null==i.connections[n.id]&&(t.dontUpdateHover||null==n._jsPlumb||n.setHover(!1),i.connections[n.id]=n,i.connectionCount++)},l=function(n){var r,u;if(null!=n&&null==i.endpoints[n.id]&&(t.dontUpdateHover||null==n._jsPlumb||n.setHover(!1),i.endpoints[n.id]=n,i.endpointCount++,c))for(r=0;r<n.connections.length;r++)u=n.connections[r],o(u)},s,r,f,h,u;t.connection?o(t.connection):l(t.endpoint);for(s in i.connections)r=i.connections[s],r._jsPlumb&&(n.removeWithFunction(d,function(n){return r.id===n.id}),yt(r,t.fireEvent!==!1&&!r.pending,t.originalEvent),f=null==t.deleteAttachedObjects?null:!t.deleteAttachedObjects,r.endpoints[0].detachFromConnection(r,null,f),r.endpoints[1].detachFromConnection(r,null,f),r.cleanup(!0),r.destroy(!0));for(h in i.endpoints)u=i.endpoints[h],u._jsPlumb&&(e.unregisterEndpoint(u),u.cleanup(!0),u.destroy(!0));return i};this.draggable=function(n,t){var i;return v(function(n){i=c(n);i.el&&or(i.el,!0,t,i.id,!0)},n),e};this.droppable=function(n,t){var i;return t=t||{},t.allowLoopback=!1,v(function(n){i=c(n);i.el&&e.initDroppable(i.el,t)},n),e};var wr=function(n,t,i,r){for(var u=0,f=n.length;u<f;u++)n[u][t].apply(n[u],i);return r(n)},br=function(n,t,i){for(var u=[],r=0,f=n.length;r<f;r++)u.push([n[r][t].apply(n[r],i),n[r]]);return u},et=function(n,t,i){return function(){return wr(n,t,arguments,i)}},pt=function(n,t){return function(){return br(n,t,arguments)}},tt=function(n,t){var i=[],r,u;if(n)if("string"==typeof n){if("*"===n)return n;i.push(n)}else if(t)i=n;else if(n.length)for(r=0,u=n.length;r<u;r++)i.push(c(n[r]).id);else i.push(c(n).id);return i},it=function(n,t,i){return"*"===n||(n.length>0?n.indexOf(t)!==-1:!i)};this.getConnections=function(n,t){n?n.constructor===String&&(n={scope:n}):n={};for(var o=n.scope||e.getDefaultScope(),u=tt(o,!0),s=tt(n.source),h=tt(n.target),r=!t&&u.length>1?{}:[],c=function(n,i){if(!t&&u.length>1){var f=r[n];null==f&&(f=r[n]=[]);f.push(i)}else r.push(i)},f=0,l=d.length;f<l;f++){var i=d[f],a=i.proxies&&i.proxies[0]?i.proxies[0].originalEp.elementId:i.sourceId,v=i.proxies&&i.proxies[1]?i.proxies[1].originalEp.elementId:i.targetId;it(u,i.scope)&&it(s,a)&&it(h,v)&&c(i.scope,i)}return r};var kr=function(n,t){return function(i){for(var r=0,u=n.length;r<u;r++)i(n[r]);return t(n)}},dr=function(n){return function(t){return n[t]}},ir=function(n,t){for(var u={length:n.length,each:kr(n,t),get:dr(n)},f=["setHover","removeAllOverlays","setLabel","addClass","addOverlay","removeOverlay","removeOverlays","showOverlay","hideOverlay","showOverlays","hideOverlays","setPaintStyle","setHoverPaintStyle","setSuspendEvents","setParameter","setParameters","setVisible","repaint","addType","toggleType","removeType","removeClass","setType","bind","unbind"],e=["getLabel","getOverlay","isHover","getParameter","getParameters","getPaintStyle","getHoverPaintStyle","isVisible","hasType","getType","isSuspendEvents"],i=0,r=f.length;i<r;i++)u[f[i]]=et(n,f[i],t);for(i=0,r=e.length;i<r;i++)u[e[i]]=pt(n,e[i]);return u},ht=function(n){var t=ir(n,ht);return i.extend(t,{setDetachable:et(n,"setDetachable",ht),setReattach:et(n,"setReattach",ht),setConnector:et(n,"setConnector",ht),"delete":function(){for(var t=0,i=n.length;t<i;t++)e.deleteConnection(n[t])},isDetachable:pt(n,"isDetachable"),isReattach:pt(n,"isReattach")})},wt=function(n){var t=ir(n,wt);return i.extend(t,{setEnabled:et(n,"setEnabled",wt),setAnchor:et(n,"setAnchor",wt),isEnabled:pt(n,"isEnabled"),deleteEveryConnection:function(){for(var t=0,i=n.length;t<i;t++)n[t].deleteEveryConnection()},"delete":function(){for(var t=0,i=n.length;t<i;t++)e.deleteEndpoint(n[t])}})};this.select=function(n){return n=n||{},n.scope=n.scope||"*",ht(n.connections||e.getConnections(n,!0))};this.selectEndpoints=function(n){var t,r,h,i,c,l;n=n||{};n.scope=n.scope||"*";var u=!n.element&&!n.source&&!n.target,a=u?"*":tt(n.element),f=u?"*":tt(n.source),e=u?"*":tt(n.target),v=tt(n.scope,!0),o=[];for(t in s){var y=it(a,t,!0),p=it(f,t,!0),w="*"!==f,b=it(e,t,!0),k="*"!==e;if(y||p||b)n:for(r=0,h=s[t].length;r<h;r++)if(i=s[t][r],it(v,i.scope,!0)){if(c=w&&f.length>0&&!i.isSource,l=k&&e.length>0&&!i.isTarget,c||l)continue n;o.push(i)}}return wt(o)};this.getAllConnections=function(){return d};this.getDefaultScope=function(){return bi};this.getEndpoint=ii;this.getEndpoints=function(n){return s[c(n).id]||[]};this.getDefaultEndpointType=function(){return i.Endpoint};this.getDefaultConnectionType=function(){return i.Connection};this.getId=p;this.appendElement=er;bt=!1;this.isHoverSuspended=function(){return bt};this.setHoverSuspended=function(n){bt=n};this.hide=function(n,t){return gi(n,"none",t),e};this.idstamp=ot;this.connectorsInitialized=!1;this.registerConnectorType=function(n,t){f.push([n,t])};var kt=function(n){if(!k&&n){var t=e.getElement(n);t.offsetParent&&e.setContainer(t.offsetParent)}},gr=function(){e.Defaults.Container&&e.setContainer(e.Defaults.Container)},oi=e.manage=function(n,t,i){return a[n]||(a[n]={el:t,endpoints:[],connections:[]},a[n].info=dt({elId:n,timestamp:ft}),i||e.fire("manageElement",{id:n,info:a[n].info,el:t})),a[n]},dt=this.updateOffset=function(n){var i,r=n.timestamp,u=n.recalc,f=n.offset,t=n.elId;return ut&&!r&&(r=ft),!u&&r&&r===vt[t]?{o:n.offset||h[t],s:w[t]}:(u||!f&&null==h[t]?(i=a[t]?a[t].el:null,null!=i&&(w[t]=e.getSize(i),h[t]=e.getOffset(i),vt[t]=r)):(h[t]=f||h[t],null==w[t]&&(i=a[t].el,null!=i&&(w[t]=e.getSize(i))),vt[t]=r),h[t]&&!h[t].right&&(h[t].right=h[t].left+w[t][0],h[t].bottom=h[t].top+w[t][1],h[t].width=w[t][0],h[t].height=w[t][1],h[t].centerx=h[t].left+h[t].width/2,h[t].centery=h[t].top+h[t].height/2),{o:h[t],s:w[t]})};this.init=function(){var u,i,r;if(o=t.jsPlumb.getRenderModes(),u=function(i,r,u){t.jsPlumb.Connectors[i][r]=function(){u.apply(this,arguments);t.jsPlumb.ConnectorRenderers[i].apply(this,arguments)};n.extend(t.jsPlumb.Connectors[i][r],[u,t.jsPlumb.ConnectorRenderers[i]])},!t.jsPlumb.connectorsInitialized){for(i=0;i<f.length;i++)for(r=0;r<o.length;r++)u(o[r],f[i][1],f[i][0]);t.jsPlumb.connectorsInitialized=!0}ti||(gr(),e.anchorManager=new t.jsPlumb.AnchorManager({jsPlumbInstance:e}),ti=!0,e.fire("ready",e))}.bind(this);this.log=pi;this.jsPlumbUIComponent=y;this.makeAnchor=function(){var o,h=function(n,i){if(t.jsPlumb.Anchors[n])return new t.jsPlumb.Anchors[n](i);if(!e.Defaults.DoNotThrowErrors)throw{msg:"jsPlumb: unknown anchor type '"+n+"'"};},s;if(0===arguments.length)return null;var r=arguments[0],f=arguments[1],u=(arguments[2],null);return r.compute&&r.getOrientation?r:("string"==typeof r?u=h(arguments[0],{elementId:f,jsPlumbInstance:e}):n.isArray(r)&&(n.isArray(r[0])||n.isString(r[0])?2===r.length&&n.isObject(r[1])?n.isString(r[0])?(o=t.jsPlumb.extend({elementId:f,jsPlumbInstance:e},r[1]),u=h(r[0],o)):(o=t.jsPlumb.extend({elementId:f,jsPlumbInstance:e,anchors:r[0]},r[1]),u=new t.jsPlumb.DynamicAnchor(o)):u=new i.DynamicAnchor({anchors:r,selector:null,elementId:f,jsPlumbInstance:e}):(s={x:r[0],y:r[1],orientation:r.length>=4?[r[2],r[3]]:[0,0],offsets:r.length>=6?[r[4],r[5]]:[0,0],elementId:f,jsPlumbInstance:e,cssClass:7===r.length?r[6]:null},u=new t.jsPlumb.Anchor(s),u.clone=function(){return new t.jsPlumb.Anchor(s)})),u.id||(u.id="anchor_"+ot()),u)};this.makeAnchors=function(i,r,u){for(var o=[],f=0,s=i.length;f<s;f++)"string"==typeof i[f]?o.push(t.jsPlumb.Anchors[i[f]]({elementId:r,jsPlumbInstance:u})):n.isArray(i[f])&&o.push(e.makeAnchor(i[f],r,u));return o};this.makeDynamicAnchor=function(n,i){return new t.jsPlumb.DynamicAnchor({anchors:n,selector:i,elementId:null,jsPlumbInstance:e})};this.targetEndpointDefinitions={};this.sourceEndpointDefinitions={};rr=function(n,t,i,r,u){for(var s=n.target||n.srcElement,f=!1,o=r.getSelector(t,i),e=0;e<o.length;e++)if(o[e]===s){f=!0;break}return u?!f:f};si=function(i,r,u,f,o){var s=new y(r),h=r._jsPlumb.EndpointDropHandler({jsPlumb:e,enabled:function(){return i.def.enabled},isFull:function(){var n=e.select({target:i.id}).length;return i.def.maxConnections>0&&n>=i.def.maxConnections},element:i.el,elementId:i.id,isSource:f,isTarget:o,addClass:function(n){e.addClass(i.el,n)},removeClass:function(n){e.removeClass(i.el,n)},onDrop:function(n){var t=n.endpoints[0];t.anchor.locked=!1},isDropAllowed:function(){return s.isDropAllowed.apply(s,arguments)},isRedrop:function(n){return null!=n.suspendedElement&&null!=n.suspendedEndpoint&&n.suspendedEndpoint.element===i.el},getEndpoint:function(n){var u=i.def.endpoint,f,o;if((null==u||null==u._jsPlumb)&&(f=e.deriveEndpointAndAnchorSpec(n.getType().join(" "),!0),o=f.endpoints?t.jsPlumb.extend(r,{endpoint:i.def.def.endpoint||f.endpoints[1]}):r,f.anchors&&(o=t.jsPlumb.extend(o,{anchor:i.def.def.anchor||f.anchors[1]})),u=e.addEndpoint(i.el,o),u._mtNew=!0),r.uniqueEndpoint&&(i.def.endpoint=u),u.setDeleteOnEmpty(!0),n.isDetachable()&&u.initDraggable(),null!=u.anchor.positionFinder){var s=e.getUIPosition(arguments,e.getZoom()),c=e.getOffset(i.el),l=e.getSize(i.el),h=null==s?[0,0]:u.anchor.positionFinder(s,c,l,u.anchor.constructorParams);u.anchor.x=h[0];u.anchor.y=h[1]}return u},maybeCleanup:function(n){n._mtNew&&0===n.connections.length?e.deleteObject({endpoint:n}):delete n._mtNew}}),c=t.jsPlumb.dragEvents.drop;return u.scope=u.scope||r.scope||e.Defaults.Scope,u[c]=n.wrap(u[c],h,!0),o&&(u[t.jsPlumb.dragEvents.over]=function(){return!0}),r.allowLoopback===!1&&(u.canDrop=function(n){var t=n.getDragElement()._jsPlumbRelatedElement;return t!==i.el}),e.initDroppable(i.el,u,"internal"),h};this.makeTarget=function(n,i,r){var u=t.jsPlumb.extend({_jsPlumb:this},r);t.jsPlumb.extend(u,i);for(var o=u.maxConnections||-1,s=function(n){var i=c(n),r=i.id,e=t.jsPlumb.extend({},u.dropOptions||{}),s=u.connectionType||"default",f;this.targetEndpointDefinitions[r]=this.targetEndpointDefinitions[r]||{};kt(r);i.el._isJsPlumbGroup&&null==e.rank&&(e.rank=-1);f={def:t.jsPlumb.extend({},u),uniqueEndpoint:u.uniqueEndpoint,maxConnections:o,enabled:!0};i.def=f;this.targetEndpointDefinitions[r][s]=f;si(i,u,e,u.isSource===!0,!0);i.el._katavorioDrop[i.el._katavorioDrop.length-1].targetDef=f}.bind(this),e=n.length&&n.constructor!==String?n:[n],f=0,h=e.length;f<h;f++)s(e[f]);return this};this.unmakeTarget=function(n,t){var i=c(n);return e.destroyDroppable(i.el,"internal"),t||delete this.targetEndpointDefinitions[i.id],this};this.makeSource=function(i,r,u){var f=t.jsPlumb.extend({_jsPlumb:this},u),o,s;t.jsPlumb.extend(f,r);o=f.connectionType||"default";s=e.deriveEndpointAndAnchorSpec(o);f.endpoint=f.endpoint||s.endpoints[0];f.anchor=f.anchor||s.anchors[0];for(var l=f.maxConnections||-1,a=f.onMaxConnections,y=function(i){var u=i.id,d=this.getElement(i.el),h,v,k;this.sourceEndpointDefinitions[u]=this.sourceEndpointDefinitions[u]||{};kt(u);h={def:t.jsPlumb.extend({},f),uniqueEndpoint:f.uniqueEndpoint,maxConnections:l,enabled:!0};this.sourceEndpointDefinitions[u][o]=h;i.def=h;var y=t.jsPlumb.dragEvents.stop,p=t.jsPlumb.dragEvents.drag,s=t.jsPlumb.extend({},f.dragOptions||{}),w=s.drag,b=s.stop,r=null,c=!1;s.scope=s.scope||f.scope;s[p]=n.wrap(s[p],function(){w&&w.apply(this,arguments);c=!1});s[y]=n.wrap(s[y],function(){if(b&&b.apply(this,arguments),this.currentlyDragging=!1,null!=r._jsPlumb){var l=f.anchor||this.Defaults.Anchor,o=r.anchor,s=r.connections[0],n=this.makeAnchor(l,u,this),h=r.element;if(null!=n.positionFinder){var t=e.getOffset(h),i=this.getSize(h),a={left:t.left+o.x*i[0],top:t.top+o.y*i[1]},c=n.positionFinder(a,t,i,n.constructorParams);n.x=c[0];n.y=c[1]}r.setAnchor(n,!0);r.repaint();this.repaint(r.elementId);null!=s&&this.repaint(s.targetId)}}.bind(this));v=function(h){var v,nt,tt,w,y,p,b,k,g;if(3!==h.which&&2!==h.button&&(v=this.sourceEndpointDefinitions[u][o],v.enabled)){if((u=this.getId(this.getElement(i.el)),f.filter)&&(nt=n.isString(f.filter)?rr(h,i.el,f.filter,this,f.filterExclude):f.filter(h,i.el),nt===!1))return;if(tt=this.select({source:u}).length,v.maxConnections>=0&&tt>=v.maxConnections)return a&&a({element:i.el,maxConnections:l},h),!1;if(w=t.jsPlumb.getPositionOnElement(h,d,at),y={},t.jsPlumb.extend(y,f),y.isTemporarySource=!0,y.anchor=[w[0],w[1],0,0],y.dragOptions=s,v.def.scope&&(y.scope=v.def.scope),r=this.addEndpoint(u,y),c=!0,r.setDeleteOnEmpty(!0),v.uniqueEndpoint&&(v.endpoint?r.finalEndpoint=v.endpoint:(v.endpoint=r,r.setDeleteOnEmpty(!1))),p=function(){e.off(r.canvas,"mouseup",p);e.off(i.el,"mouseup",p);c&&(c=!1,e.deleteEndpoint(r))},e.on(r.canvas,"mouseup",p),e.on(i.el,"mouseup",p),b={},v.def.extract)for(k in v.def.extract)g=(h.srcElement||h.target).getAttribute(k),g&&(b[v.def.extract[k]]=g);e.trigger(r.canvas,"mousedown",h,b);n.consume(h)}}.bind(this);this.on(i.el,"mousedown",v);h.trigger=v;f.filter&&(n.isString(f.filter)||n.isFunction(f.filter))&&e.setDragFilter(i.el,f.filter);k=t.jsPlumb.extend({},f.dropOptions||{});si(i,f,k,!0,f.isTarget===!0)}.bind(this),v=i.length&&i.constructor!==String?i:[i],h=0,p=v.length;h<p;h++)y(c(v[h]));return this};this.unmakeSource=function(n,t,i){var r=c(n),u,f,o;if(e.destroyDroppable(r.el,"internal"),u=this.sourceEndpointDefinitions[r.id],u)for(f in u)(null==t||t===f)&&(o=u[f].trigger,o&&e.off(r.el,"mousedown",o),i||delete this.sourceEndpointDefinitions[r.id][f]);return this};this.unmakeEverySource=function(){for(var n in this.sourceEndpointDefinitions)e.unmakeSource(n,null,!0);return this.sourceEndpointDefinitions={},this};gt=function(t,i,r){var e,u,f;for(i=n.isArray(i)?i:[i],e=p(t),r=r||"default",u=0;u<i.length;u++)if(f=this[i[u]][e],f&&f[r])return f[r].def.scope||this.Defaults.Scope}.bind(this);hi=function(t,i,r,u){var o,f,e;for(r=n.isArray(r)?r:[r],o=p(t),u=u||"default",f=0;f<r.length;f++)e=this[r[f]][o],e&&e[u]&&(e[u].def.scope=i)}.bind(this);this.getScope=function(n){return gt(n,["sourceEndpointDefinitions","targetEndpointDefinitions"])};this.getSourceScope=function(n){return gt(n,"sourceEndpointDefinitions")};this.getTargetScope=function(n){return gt(n,"targetEndpointDefinitions")};this.setScope=function(n,t,i){this.setSourceScope(n,t,i);this.setTargetScope(n,t,i)};this.setSourceScope=function(n,t,i){hi(n,t,"sourceEndpointDefinitions",i);this.setDragScope(n,t)};this.setTargetScope=function(n,t,i){hi(n,t,"targetEndpointDefinitions",i);this.setDropScope(n,t)};this.unmakeEveryTarget=function(){for(var n in this.targetEndpointDefinitions)e.unmakeTarget(n,!0);return this.targetEndpointDefinitions={},this};ct=function(t,i,r,u,f){var h,o,l,s="source"===t?this.sourceEndpointDefinitions:this.targetEndpointDefinitions,a,y,v;if(f=f||"default",i.length&&!n.isString(i))for(h=[],a=0,y=i.length;a<y;a++)o=c(i[a]),s[o.id]&&s[o.id][f]&&(h[a]=s[o.id][f].enabled,l=u?!h[a]:r,s[o.id][f].enabled=l,e[l?"removeClass":"addClass"](o.el,"jtk-"+t+"-disabled"));else o=c(i),v=o.id,s[v]&&s[v][f]&&(h=s[v][f].enabled,l=u?!h:r,s[v][f].enabled=l,e[l?"removeClass":"addClass"](o.el,"jtk-"+t+"-disabled"));return h}.bind(this);lt=function(t,i){return n.isString(t)||!t.length?i.apply(this,[t]):t.length?i.apply(this,[t[0]]):void 0}.bind(this);this.toggleSourceEnabled=function(n,t){return ct("source",n,null,!0,t),this.isSourceEnabled(n,t)};this.setSourceEnabled=function(n,t,i){return ct("source",n,t,null,i)};this.isSource=function(n,t){return t=t||"default",lt(n,function(n){var i=this.sourceEndpointDefinitions[c(n).id];return null!=i&&null!=i[t]}.bind(this))};this.isSourceEnabled=function(n,t){return t=t||"default",lt(n,function(n){var i=this.sourceEndpointDefinitions[c(n).id];return i&&i[t]&&i[t].enabled===!0}.bind(this))};this.toggleTargetEnabled=function(n,t){return ct("target",n,null,!0,t),this.isTargetEnabled(n,t)};this.isTarget=function(n,t){return t=t||"default",lt(n,function(n){var i=this.targetEndpointDefinitions[c(n).id];return null!=i&&null!=i[t]}.bind(this))};this.isTargetEnabled=function(n,t){return t=t||"default",lt(n,function(n){var i=this.targetEndpointDefinitions[c(n).id];return i&&i[t]&&i[t].enabled===!0}.bind(this))};this.setTargetEnabled=function(n,t,i){return ct("target",n,t,null,i)};this.ready=function(n){e.bind("ready",n)};ci=function(n,t){if("object"==typeof n&&n.length)for(var i=0,r=n.length;i<r;i++)t(n[i]);else t(n);return e};this.repaint=function(n,t,i){return ci(n,function(n){st(n,t,i)})};this.revalidate=function(n,t,i){return ci(n,function(n){var u=i?n:e.getId(n),r;e.updateOffset({elId:u,recalc:!0,timestamp:t});r=e.getDragManager();r&&r.updateOffsets(u);e.repaint(n)})};this.repaintEverything=function(){var n,t=u();for(n in s)e.updateOffset({elId:n,recalc:!0,timestamp:t});for(n in s)st(n,null,t);return this};this.removeAllEndpoints=function(n,t,i){i=i||[];var r=function(n){var u,o,f=c(n),h=s[f.id];if(h)for(i.push(f),u=0,o=h.length;u<o;u++)e.deleteEndpoint(h[u],!1);if(delete s[f.id],t&&f.el&&3!==f.el.nodeType&&8!==f.el.nodeType)for(u=0,o=f.el.childNodes.length;u<o;u++)r(f.el.childNodes[u])};return r(n),this};li=function(n,t){e.removeAllEndpoints(n.id,!0,t);for(var r=e.getDragManager(),u=function(n){r&&r.elementRemoved(n.id);e.anchorManager.clearFor(n.id);e.anchorManager.removeFloatingConnection(n.id);e.isSource(n.el)&&e.unmakeSource(n.el);e.isTarget(n.el)&&e.unmakeTarget(n.el);e.destroyDraggable(n.el);e.destroyDroppable(n.el);delete e.floatingConnections[n.id];delete a[n.id];delete h[n.id];n.el&&(e.removeElement(n.el),n.el._jsPlumb=null)},i=1;i<t.length;i++)u(t[i]);u(n)};this.remove=function(n,t){var i=c(n),r=[];return i.text?i.el.parentNode.removeChild(i.el):i.id&&e.batch(function(){li(i,r)},t===!1),e};this.empty=function(n,t){var r=[],i=function(n,t){var u=c(n);if(u.text)u.el.parentNode.removeChild(u.el);else if(u.el){for(;u.el.childNodes.length>0;)i(u.el.childNodes[0]);t||li(u,r)}};return e.batch(function(){i(n,!0)},t===!1),e};this.reset=function(){e.silently(function(){bt=!1;e.removeAllGroups();e.removeGroupManager();e.deleteEveryEndpoint();e.unbind();this.targetEndpointDefinitions={};this.sourceEndpointDefinitions={};d.length=0;this.doReset&&this.doReset()}.bind(this))};ai=function(n){n.canvas&&n.canvas.parentNode&&n.canvas.parentNode.removeChild(n.canvas);n.cleanup();n.destroy()};this.clear=function(){e.select().each(ai);e.selectEndpoints().each(ai);s={};nt={}};this.setDefaultScope=function(n){return bi=n,e};this.setDraggable=cr;this.deriveEndpointAndAnchorSpec=function(n,t){for(var i,h=((t?"":"default ")+n).split(/[\s]/),r=null,u=null,f=null,o=null,s=0;s<h.length;s++)i=e.getType(h[s],"connection"),i&&(i.endpoints&&(r=i.endpoints),i.endpoint&&(u=i.endpoint),i.anchors&&(o=i.anchors),i.anchor&&(f=i.anchor));return{endpoints:r?r:[u,u],anchors:o?o:[f,f]}};this.setId=function(t,i,r){var u,h,c,f,l,e,o;for(n.isString(t)?u=t:(t=this.getElement(t),u=this.getId(t)),h=this.getConnections({source:u,scope:"*"},!0),c=this.getConnections({target:u,scope:"*"},!0),i=""+i,r?t=this.getElement(i):(t=this.getElement(u),this.setAttribute(t,"id",i)),s[i]=s[u]||[],f=0,l=s[i].length;f<l;f++)s[i][f].setElementId(i),s[i][f].setReferenceElement(t);delete s[u];this.sourceEndpointDefinitions[i]=this.sourceEndpointDefinitions[u];delete this.sourceEndpointDefinitions[u];this.targetEndpointDefinitions[i]=this.targetEndpointDefinitions[u];delete this.targetEndpointDefinitions[u];this.anchorManager.changeId(u,i);e=this.getDragManager();e&&e.changeId(u,i);a[i]=a[u];delete a[u];o=function(n,r,u){for(var f=0,e=n.length;f<e;f++)n[f].endpoints[r].setElementId(i),n[f].endpoints[r].setReferenceElement(t),n[f][u+"Id"]=i,n[f][u]=t};o(h,0,"source");o(c,1,"target");this.repaint(i)};this.setDebugLog=function(n){pi=n};this.setSuspendDrawing=function(n,t){var i=ut;return ut=n,ft=n?(new Date).getTime():null,t&&this.repaintEverything(),i};this.isSuspendDrawing=function(){return ut};this.getSuspendedAt=function(){return ft};this.batch=function(t,i){var r=this.isSuspendDrawing();r||this.setSuspendDrawing(!0);try{t()}catch(t){n.log("Function run while suspended failed",t)}r||this.setSuspendDrawing(!1,!i)};this.doWhileSuspended=this.batch;this.getCachedData=vr;this.timestamp=u;this.show=function(n,t){return gi(n,"block",t),e};this.toggleVisible=ar;this.toggleDraggable=lr;this.addListener=this.bind};n.extend(t.jsPlumbInstance,n.EventGenerator,{setAttribute:function(n,t,i){this.setAttribute(n,t,i)},getAttribute:function(n,i){return this.getAttribute(t.jsPlumb.getElement(n),i)},convertToFullOverlaySpec:function(t){return n.isString(t)&&(t=[t,{}]),t[1].id=t[1].id||n.uuid(),t},registerConnectionType:function(n,i){var u,r,f;if(this._connectionTypes[n]=t.jsPlumb.extend({},i),i.overlays){for(u={},r=0;r<i.overlays.length;r++)f=this.convertToFullOverlaySpec(i.overlays[r]),u[f[1].id]=f;this._connectionTypes[n].overlays=u}},registerConnectionTypes:function(n){for(var t in n)this.registerConnectionType(t,n[t])},registerEndpointType:function(n,i){var u,r,f;if(this._endpointTypes[n]=t.jsPlumb.extend({},i),i.overlays){for(u={},r=0;r<i.overlays.length;r++)f=this.convertToFullOverlaySpec(i.overlays[r]),u[f[1].id]=f;this._endpointTypes[n].overlays=u}},registerEndpointTypes:function(n){for(var t in n)this.registerEndpointType(t,n[t])},getType:function(n,t){return"connection"===t?this._connectionTypes[n]:this._endpointTypes[n]},setIdChanged:function(n,t){this.setId(n,t,!0)},setParent:function(n,t){var i=this.getElement(n),f=this.getId(i),r=this.getElement(t),e=this.getId(r),u=this.getDragManager();i.parentNode.removeChild(i);r.appendChild(i);u&&u.setParent(i,f,r,e)},extend:function(n,t,i){var r;if(i)for(r=0;r<i.length;r++)n[i[r]]=t[i[r]];else for(r in t)n[r]=t[r];return n},floatingConnections:{},getFloatingAnchorIndex:function(n){return n.endpoints[0].isFloating()?0:n.endpoints[1].isFloating()?1:-1}});h.prototype.Defaults={Anchor:"Bottom",Anchors:[null,null],ConnectionsDetachable:!0,ConnectionOverlays:[],Connector:"Bezier",Container:null,DoNotThrowErrors:!1,DragOptions:{},DropOptions:{},Endpoint:"Dot",EndpointOverlays:[],Endpoints:[null,null],EndpointStyle:{fill:"#456"},EndpointStyles:[null,null],EndpointHoverStyle:null,EndpointHoverStyles:[null,null],HoverPaintStyle:null,LabelStyle:{color:"black"},LogEnabled:!1,Overlays:[],MaxConnections:1,PaintStyle:{"stroke-width":4,stroke:"#456"},ReattachConnections:!1,RenderMode:"svg",Scope:"jsPlumb_DefaultScope"};i=new h;t.jsPlumb=i;i.getInstance=function(n,t){var i=new h(n),r;if(t)for(r in t)i[r]=t[r];return i.init(),i};i.each=function(n,t){if(null!=n)if("string"==typeof n)t(i.getElement(n));else if(null!=n.length)for(var r=0;r<n.length;r++)t(i.getElement(n[r]));else t(n)};"undefined"!=typeof exports&&(exports.jsPlumb=i)}.call("undefined"!=typeof window?window:this),function(){var n=this,u=n.jsPlumbUtil,t=function(n,t){if(null==t)return[0,0];var r=c(t),i=h(r,0);return[i[n+"X"],i[n+"Y"]]},e=t.bind(this,"page"),o=t.bind(this,"screen"),s=t.bind(this,"client"),h=function(n,t){return n.item?n.item(t):n[t]},c=function(n){return n.touches&&n.touches.length>0?n.touches:n.changedTouches&&n.changedTouches.length>0?n.changedTouches:n.targetTouches&&n.targetTouches.length>0?n.targetTouches:[n]},l=function(n){var u={},f=[],t={},r={},i={};this.register=function(e){var o=n.getId(e),h=n.getOffset(e),s;u[o]||(u[o]=e,f.push(e),t[o]={});s=function(u){var f,l,e,c;if(u)for(f=0;f<u.childNodes.length;f++)3!==u.childNodes[f].nodeType&&8!==u.childNodes[f].nodeType&&(l=jsPlumb.getElement(u.childNodes[f]),e=n.getId(u.childNodes[f],null,!0),e&&r[e]&&r[e]>0&&(c=n.getOffset(l),t[o][e]={id:e,offset:{left:c.left-h.left,top:c.top-h.top}},i[e]=o),s(u.childNodes[f]))};s(e)};this.updateOffsets=function(r,u){var f,s,h;if(null!=r){u=u||{};var c=jsPlumb.getElement(r),e=n.getId(c),o=t[e],l=n.getOffset(c);if(o)for(f in o)if(o.hasOwnProperty(f)){if(s=jsPlumb.getElement(f),h=u[f]||n.getOffset(s),null==s.offsetParent&&null!=t[e][f])continue;t[e][f]={id:f,offset:{left:h.left-l.left,top:h.top-l.top}};i[f]=e}}};this.endpointAdded=function(f,e){var l,o,s,h,c;for(e=e||n.getId(f),l=document.body,o=f.parentNode,r[e]=r[e]?r[e]+1:1;null!=o&&o!==l;){if(s=n.getId(o,null,!0),s&&u[s]){h=n.getOffset(o);null==t[s][e]&&(c=n.getOffset(f),t[s][e]={id:e,offset:{left:c.left-h.left,top:c.top-h.top}},i[e]=s);break}o=o.parentNode}};this.endpointDeleted=function(n){if(r[n.elementId]&&(r[n.elementId]--,r[n.elementId]<=0))for(var u in t)t.hasOwnProperty(u)&&t[u]&&(delete t[u][n.elementId],delete i[n.elementId])};this.changeId=function(n,r){t[r]=t[n];t[n]={};i[r]=i[n];i[n]=null};this.getElementsForDraggable=function(n){return t[n]};this.elementRemoved=function(n){var r=i[n];r&&(delete t[r][n],delete i[n])};this.reset=function(){u={};f=[];t={};r={}};this.dragEnded=function(t){if(null!=t.offsetParent){var u=n.getId(t),r=i[u];r&&this.updateOffsets(r)}};this.setParent=function(r,u,f,e,o){var s=i[u],h,c;t[e]||(t[e]={});h=n.getOffset(f);c=o||n.getOffset(r);s&&t[s]&&delete t[s][u];t[e][u]={id:u,offset:{left:c.left-h.left,top:c.top-h.top}};i[u]=e};this.clearParent=function(n,r){var u=i[r];u&&(delete t[u][r],delete i[r])};this.revalidateParent=function(t,r,u){var f=i[r],e;f&&(e={},e[r]=u,this.updateOffsets(f,e),n.revalidate(f))};this.getDragAncestor=function(t){var u=jsPlumb.getElement(t),f=n.getId(u),r=i[f];return r?jsPlumb.getElement(r):null}},a=function(n){return null==n?null:n.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},f=function(n,t){t=a(t);"undefined"!=typeof n.className.baseVal?n.className.baseVal=t:n.className=t},i=function(n){return"undefined"==typeof n.className.baseVal?n.className:n.className.baseVal},r=function(n,t,r){t=null==t?[]:u.isArray(t)?t:t.split(/\s+/);r=null==r?[]:u.isArray(r)?r:r.split(/\s+/);var s=i(n),e=s.split(/\s+/),o=function(n,t){for(var r,i=0;i<t.length;i++)n?e.indexOf(t[i])===-1&&e.push(t[i]):(r=e.indexOf(t[i]),r!==-1&&e.splice(r,1))};o(!0,t);o(!1,r);f(n,e.join(" "))};n.jsPlumb.extend(n.jsPlumbInstance.prototype,{headless:!1,pageLocation:e,screenLocation:o,clientLocation:s,getDragManager:function(){return null==this.dragManager&&(this.dragManager=new l(this)),this.dragManager},recalculateOffsets:function(n){this.getDragManager().updateOffsets(n)},createElement:function(n,t,i,r){return this.createElementNS(null,n,t,i,r)},createElementNS:function(n,t,i,r,u){var f,e=null==n?document.createElement(t):document.createElementNS(n,t);i=i||{};for(f in i)e.style[f]=i[f];r&&(e.className=r);u=u||{};for(f in u)e.setAttribute(f,""+u[f]);return e},getAttribute:function(n,t){return null!=n.getAttribute?n.getAttribute(t):null},setAttribute:function(n,t,i){null!=n.setAttribute&&n.setAttribute(t,i)},setAttributes:function(n,t){for(var i in t)t.hasOwnProperty(i)&&n.setAttribute(i,t[i])},appendToRoot:function(n){document.body.appendChild(n)},getRenderModes:function(){return["svg"]},getClass:i,addClass:function(n,t){jsPlumb.each(n,function(n){r(n,t)})},hasClass:function(n,t){return n=jsPlumb.getElement(n),n.classList?n.classList.contains(t):i(n).indexOf(t)!==-1},removeClass:function(n,t){jsPlumb.each(n,function(n){r(n,null,t)})},updateClasses:function(n,t,i){jsPlumb.each(n,function(n){r(n,t,i)})},setClass:function(n,t){jsPlumb.each(n,function(n){f(n,t)})},setPosition:function(n,t){n.style.left=t.left+"px";n.style.top=t.top+"px"},getPosition:function(n){var t=function(t){var i=n.style[t];return i?i.substring(0,i.length-2):0};return{left:t("left"),top:t("top")}},getStyle:function(n,t){return"undefined"!=typeof getComputedStyle?getComputedStyle(n,null).getPropertyValue(t):n.currentStyle[t]},getSelector:function(n,t){return 1===arguments.length?null!=n.nodeType?n:document.querySelectorAll(n):n.querySelectorAll(t)},getOffset:function(n,t,i){var f,e;n=jsPlumb.getElement(n);i=i||this.getContainer();for(var u={left:n.offsetLeft,top:n.offsetTop},r=t||null!=i&&n!==i&&n.offsetParent!==i?n.offsetParent:null,o=function(n){null!=n&&n!==document.body&&(n.scrollTop>0||n.scrollLeft>0)&&(u.left-=n.scrollLeft,u.top-=n.scrollTop)}.bind(this);null!=r;)u.left+=r.offsetLeft,u.top+=r.offsetTop,o(r),r=t?r.offsetParent:r.offsetParent===i?null:r.offsetParent;return null!=i&&!t&&(i.scrollTop>0||i.scrollLeft>0)&&(f=null!=n.offsetParent?this.getStyle(n.offsetParent,"position"):"static",e=this.getStyle(n,"position"),"absolute"!==e&&"fixed"!==e&&"absolute"!==f&&"fixed"!==f&&(u.left-=i.scrollLeft,u.top-=i.scrollTop)),u},getPositionOnElement:function(n,t,i){var r="undefined"!=typeof t.getBoundingClientRect?t.getBoundingClientRect():{left:0,top:0,width:0,height:0},u=document.body,f=document.documentElement,o=window.pageYOffset||f.scrollTop||u.scrollTop,s=window.pageXOffset||f.scrollLeft||u.scrollLeft,h=f.clientTop||u.clientTop||0,c=f.clientLeft||u.clientLeft||0,l=r.top+o-h+0*i,a=r.left+s-c+0*i,e=jsPlumb.pageLocation(n),v=r.width||t.offsetWidth*i,y=r.height||t.offsetHeight*i,p=(e[0]-a)/v,w=(e[1]-l)/y;return[p,w]},getAbsolutePosition:function(n){var t=function(t){var i=n.style[t];if(i)return parseFloat(i.substring(0,i.length-2))};return[t("left"),t("top")]},setAbsolutePosition:function(n,t,i,r){i?this.animate(n,{left:"+="+(t[0]-i[0]),top:"+="+(t[1]-i[1])},r):(n.style.left=t[0]+"px",n.style.top=t[1]+"px")},getSize:function(n){return[n.offsetWidth,n.offsetHeight]},getWidth:function(n){return n.offsetWidth},getHeight:function(n){return n.offsetHeight},getRenderMode:function(){return"svg"}})}.call("undefined"!=typeof window?window:this),function(){"use strict";var i=this,n=i.jsPlumb,r=i.jsPlumbUtil,t="__label",u=function(i,r){var u={cssClass:r.cssClass,labelStyle:i.labelStyle,id:t,component:i,_jsPlumb:i._jsPlumb.instance},f=n.extend(u,r);return new n.Overlays[i._jsPlumb.instance.getRenderMode()].Label(f)},f=function(t,i){var u=null,e,f;return r.isArray(i)?(e=i[0],f=n.extend({component:t,_jsPlumb:t._jsPlumb.instance},i[1]),3===i.length&&n.extend(f,i[2]),u=new n.Overlays[t._jsPlumb.instance.getRenderMode()][e](f)):u=i.constructor===String?new n.Overlays[t._jsPlumb.instance.getRenderMode()][i]({component:t,_jsPlumb:t._jsPlumb.instance}):i,u.id=u.id||r.uuid(),t.cacheTypeItem("overlay",u,u.id),t._jsPlumb.overlays[u.id]=u,u};n.OverlayCapableJsPlumbUIComponent=function(n){i.jsPlumbUIComponent.apply(this,arguments);this._jsPlumb.overlays={};this._jsPlumb.overlayPositions={};n.label&&(this.getDefaultType().overlays[t]=["Label",{label:n.label,location:n.labelLocation||this.defaultLabelLocation||.5,labelStyle:n.labelStyle||this._jsPlumb.instance.Defaults.LabelStyle,id:t}]);this.setListenerComponent=function(n){if(this._jsPlumb)for(var t in this._jsPlumb.overlays)this._jsPlumb.overlays[t].setListenerComponent(n)}};n.OverlayCapableJsPlumbUIComponent.applyType=function(n,t){var i,u,f,r;if(t.overlays){u={};for(i in t.overlays)f=n._jsPlumb.overlays[t.overlays[i][1].id],f?(f.updateFrom(t.overlays[i][1]),u[t.overlays[i][1].id]=!0):(r=n.getCachedTypeItem("overlay",t.overlays[i][1].id),null!=r?(r.reattach(n._jsPlumb.instance),r.setVisible(!0),r.updateFrom(t.overlays[i][1]),n._jsPlumb.overlays[r.id]=r):r=n.addOverlay(t.overlays[i],!0),u[r.id]=!0);for(i in n._jsPlumb.overlays)null==u[n._jsPlumb.overlays[i].id]&&n.removeOverlay(n._jsPlumb.overlays[i].id,!0)}};r.extend(n.OverlayCapableJsPlumbUIComponent,i.jsPlumbUIComponent,{setHover:function(n){if(this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged())for(var t in this._jsPlumb.overlays)this._jsPlumb.overlays[t][n?"addClass":"removeClass"](this._jsPlumb.instance.hoverClass)},addOverlay:function(n,t){var i=f(this,n);return t||this.repaint(),i},getOverlay:function(n){return this._jsPlumb.overlays[n]},getOverlays:function(){return this._jsPlumb.overlays},hideOverlay:function(n){var t=this.getOverlay(n);t&&t.hide()},hideOverlays:function(){for(var n in this._jsPlumb.overlays)this._jsPlumb.overlays[n].hide()},showOverlay:function(n){var t=this.getOverlay(n);t&&t.show()},showOverlays:function(){for(var n in this._jsPlumb.overlays)this._jsPlumb.overlays[n].show()},removeAllOverlays:function(n){for(var t in this._jsPlumb.overlays)this._jsPlumb.overlays[t].cleanup&&this._jsPlumb.overlays[t].cleanup();this._jsPlumb.overlays={};this._jsPlumb.overlayPositions=null;n||this.repaint()},removeOverlay:function(n,t){var i=this._jsPlumb.overlays[n];i&&(i.setVisible(!1),!t&&i.cleanup&&i.cleanup(),delete this._jsPlumb.overlays[n],this._jsPlumb.overlayPositions&&delete this._jsPlumb.overlayPositions[n])},removeOverlays:function(){for(var n=0,t=arguments.length;n<t;n++)this.removeOverlay(arguments[n])},moveParent:function(n){var i,t;if(this.bgCanvas&&(this.bgCanvas.parentNode.removeChild(this.bgCanvas),n.appendChild(this.bgCanvas)),this.canvas&&this.canvas.parentNode){this.canvas.parentNode.removeChild(this.canvas);n.appendChild(this.canvas);for(i in this._jsPlumb.overlays)this._jsPlumb.overlays[i].isAppendedAtTopLevel&&(t=this._jsPlumb.overlays[i].getElement(),t.parentNode.removeChild(t),n.appendChild(t))}},getLabel:function(){var n=this.getOverlay(t);return null!=n?n.getLabel():null},getLabelOverlay:function(){return this.getOverlay(t)},setLabel:function(n){var i=this.getOverlay(t),r;i?n.constructor===String||n.constructor===Function?i.setLabel(n):(n.label&&i.setLabel(n.label),n.location&&i.setLocation(n.location)):(r=n.constructor===String||n.constructor===Function?{label:n}:n,i=u(this,r),this._jsPlumb.overlays[t]=i);this._jsPlumb.instance.isSuspendDrawing()||this.repaint()},cleanup:function(n){for(var t in this._jsPlumb.overlays)this._jsPlumb.overlays[t].cleanup(n),this._jsPlumb.overlays[t].destroy(n);n&&(this._jsPlumb.overlays={},this._jsPlumb.overlayPositions=null)},setVisible:function(n){this[n?"showOverlays":"hideOverlays"]()},setAbsoluteOverlayPosition:function(n,t){this._jsPlumb.overlayPositions[n.id]=t},getAbsoluteOverlayPosition:function(n){return this._jsPlumb.overlayPositions?this._jsPlumb.overlayPositions[n.id]:null},_clazzManip:function(n,t,i){if(!i)for(var r in this._jsPlumb.overlays)this._jsPlumb.overlays[r][n+"Class"](t)},addClass:function(n,t){this._clazzManip("add",n,t)},removeClass:function(n,t){this._clazzManip("remove",n,t)}})}.call("undefined"!=typeof window?window:this),function(){"use strict";var i=this,n=i.jsPlumb,t=i.jsPlumbUtil,u=function(n,t,i){var r=!1;return{drag:function(){if(r)return r=!1,!0;if(t.element){var u=i.getUIPosition(arguments,i.getZoom());null!=u&&i.setPosition(t.element,u);i.repaint(t.element,u);n.paint({anchorPoint:n.anchor.getCurrentLocation({element:n})})}},stopDrag:function(){r=!0}}},f=function(n,t,i,r){var u=t.createElement("div",{position:"absolute"}),f;t.appendElement(u);f=t.getId(u);t.setPosition(u,i);u.style.width=r[0]+"px";u.style.height=r[1]+"px";t.manage(f,u,!0);n.id=f;n.element=u},e=function(t,i,r,u,f,e,o,s){var h=new n.FloatingAnchor({reference:i,referenceCanvas:u,jsPlumbInstance:e});return o({paintStyle:t,endpoint:r,anchor:h,source:f,scope:s})},r=["connectorStyle","connectorHoverStyle","connectorOverlays","connector","connectionType","connectorClass","connectorHoverClass"],o=function(n,t){var r=0,i;if(null!=t)for(i=0;i<n.connections.length;i++)if(n.connections[i].sourceId===t||n.connections[i].targetId===t){r=i;break}return n.connections[r]};n.Endpoint=function(i){var s=i._jsPlumb,d=i.newConnection,y=i.newEndpoint,h,c,l,a,v,p,w,b,k;return this.idPrefix="_jsplumb_e_",this.defaultLabelLocation=[.5,.5],this.defaultOverlayKeys=["Overlays","EndpointOverlays"],n.OverlayCapableJsPlumbUIComponent.apply(this,arguments),this.appendToDefaultType({connectionType:i.connectionType,maxConnections:null==i.maxConnections?this._jsPlumb.instance.Defaults.MaxConnections:i.maxConnections,paintStyle:i.endpointStyle||i.paintStyle||i.style||this._jsPlumb.instance.Defaults.EndpointStyle||n.Defaults.EndpointStyle,hoverPaintStyle:i.endpointHoverStyle||i.hoverPaintStyle||this._jsPlumb.instance.Defaults.EndpointHoverStyle||n.Defaults.EndpointHoverStyle,connectorStyle:i.connectorStyle,connectorHoverStyle:i.connectorHoverStyle,connectorClass:i.connectorClass,connectorHoverClass:i.connectorHoverClass,connectorOverlays:i.connectorOverlays,connector:i.connector,connectorTooltip:i.connectorTooltip}),this._jsPlumb.enabled=!(i.enabled===!1),this._jsPlumb.visible=!0,this.element=n.getElement(i.source),this._jsPlumb.uuid=i.uuid,this._jsPlumb.floatingEndpoint=null,h=null,this._jsPlumb.uuid&&(i.endpointsByUUID[this._jsPlumb.uuid]=this),this.elementId=i.elementId,this.dragProxy=i.dragProxy,this._jsPlumb.connectionCost=i.connectionCost,this._jsPlumb.connectionsDirected=i.connectionsDirected,this._jsPlumb.currentAnchorClass="",this._jsPlumb.events={},c=i.deleteOnEmpty===!0,this.setDeleteOnEmpty=function(n){c=n},l=function(){var i=s.endpointAnchorClassPrefix+"-"+this._jsPlumb.currentAnchorClass,t;this._jsPlumb.currentAnchorClass=this.anchor.getCssClass();t=s.endpointAnchorClassPrefix+(this._jsPlumb.currentAnchorClass?"-"+this._jsPlumb.currentAnchorClass:"");this.removeClass(i);this.addClass(t);n.updateClasses(this.element,t,i)}.bind(this),this.prepareAnchor=function(n){var t=this._jsPlumb.instance.makeAnchor(n,this.elementId,s);return t.bind("anchorChanged",function(n){this.fire("anchorChanged",{endpoint:this,anchor:n});l()}.bind(this)),t},this.setPreparedAnchor=function(n,t){return this._jsPlumb.instance.continuousAnchorFactory.clear(this.elementId),this.anchor=n,l(),t||this._jsPlumb.instance.repaint(this.elementId),this},this.setAnchor=function(n,t){var i=this.prepareAnchor(n);return this.setPreparedAnchor(i,t),this},a=function(n){if(this.connections.length>0)for(var t=0;t<this.connections.length;t++)this.connections[t].setHover(n,!1);else this.setHover(n)}.bind(this),this.bind("mouseover",function(){a(!0)}),this.bind("mouseout",function(){a(!1)}),i._transient||this._jsPlumb.instance.anchorManager.add(this,this.elementId),this.prepareEndpoint=function(r,u){var e,o=function(t,i){var r=s.getRenderMode();if(n.Endpoints[r][t])return new n.Endpoints[r][t](i);if(!s.Defaults.DoNotThrowErrors)throw{msg:"jsPlumb: unknown endpoint type '"+t+"'"};},f={_jsPlumb:this._jsPlumb.instance,cssClass:i.cssClass,container:i.container,tooltip:i.tooltip,connectorTooltip:i.connectorTooltip,endpoint:this};return t.isString(r)?e=o(r,f):t.isArray(r)?(f=t.merge(r[1],f),e=o(r[0],f)):e=r.clone(),e.clone=function(){return t.isString(r)?o(r,f):t.isArray(r)?(f=t.merge(r[1],f),o(r[0],f)):void 0}.bind(this),e.typeId=u,e},this.setEndpoint=function(n){var t=this.prepareEndpoint(n);this.setPreparedEndpoint(t,!0)},this.setPreparedEndpoint=function(n){null!=this.endpoint&&(this.endpoint.cleanup(),this.endpoint.destroy());this.endpoint=n;this.type=this.endpoint.type;this.canvas=this.endpoint.canvas},n.extend(this,i,r),this.isSource=i.isSource||!1,this.isTemporarySource=i.isTemporarySource||!1,this.isTarget=i.isTarget||!1,this.connections=i.connections||[],this.connectorPointerEvents=i["connector-pointer-events"],this.scope=i.scope||s.getDefaultScope(),this.timestamp=null,this.reattachConnections=i.reattach||s.Defaults.ReattachConnections,this.connectionsDetachable=s.Defaults.ConnectionsDetachable,i.connectionsDetachable!==!1&&i.detachable!==!1||(this.connectionsDetachable=!1),this.dragAllowedWhenFull=i.dragAllowedWhenFull!==!1,i.onMaxConnections&&this.bind("maxConnections",i.onMaxConnections),this.addConnection=function(n){this.connections.push(n);this[(this.connections.length>0?"add":"remove")+"Class"](s.endpointConnectedClass);this[(this.isFull()?"add":"remove")+"Class"](s.endpointFullClass)},this.detachFromConnection=function(n,t,i){t=null==t?this.connections.indexOf(n):t;t>=0&&(this.connections.splice(t,1),this[(this.connections.length>0?"add":"remove")+"Class"](s.endpointConnectedClass),this[(this.isFull()?"add":"remove")+"Class"](s.endpointFullClass));!i&&c&&0===this.connections.length&&s.deleteObject({endpoint:this,fireEvent:!1,deleteAttachedObjects:i!==!0})},this.deleteEveryConnection=function(n){for(var i=this.connections.length,t=0;t<i;t++)s.deleteConnection(this.connections[0],n)},this.detachFrom=function(n){for(var r,u,i=[],t=0;t<this.connections.length;t++)this.connections[t].endpoints[1]!==n&&this.connections[t].endpoints[0]!==n||i.push(this.connections[t]);for(r=0,u=i.length;r<u;r++)s.deleteConnection(i[0]);return this},this.getElement=function(){return this.element},this.setElement=function(r){var u=this._jsPlumb.instance.getId(r),f=this.elementId;return t.removeWithFunction(i.endpointsByElement[this.elementId],function(n){return n.id===this.id}.bind(this)),this.element=n.getElement(r),this.elementId=s.getId(this.element),s.anchorManager.rehomeEndpoint(this,f,this.element),s.dragManager.endpointAdded(this.element),t.addToList(i.endpointsByElement,u,this),this},this.makeInPlaceCopy=function(){var n=this.anchor.getCurrentLocation({element:this}),t=this.anchor.getOrientation(this),r=this.anchor.getCssClass(),u={bind:function(){},compute:function(){return[n[0],n[1]]},getCurrentLocation:function(){return[n[0],n[1]]},getOrientation:function(){return t},getCssClass:function(){return r}};return y({dropOptions:i.dropOptions,anchor:u,source:this.element,paintStyle:this.getPaintStyle(),endpoint:i.hideOnDrag?"Blank":this.endpoint,_transient:!0,scope:this.scope,reference:this})},this.connectorSelector=function(){var n=this.connections[0];return n?n:this.connections.length<this._jsPlumb.maxConnections||this._jsPlumb.maxConnections===-1?null:n},this.setStyle=this.setPaintStyle,this.paint=function(n){var t,l,c,u,f,a,v,i,r,h;if(n=n||{},t=n.timestamp,l=!(n.recalc===!1),(!t||this.timestamp!==t)&&(c=s.updateOffset({elId:this.elementId,timestamp:t}),u=n.offset?n.offset.o:c.o,null!=u)){if(f=n.anchorPoint,a=n.connectorPaintStyle,null==f){if(v=n.dimensions||c.s,i={xy:[u.left,u.top],wh:v,element:this,timestamp:t},l&&this.anchor.isDynamic&&this.connections.length>0){var e=o(this,n.elementWithPrecedence),y=e.endpoints[0]===this?1:0,b=0===y?e.sourceId:e.targetId,p=s.getCachedData(b),w=p.o,k=p.s;i.txy=[w.left,w.top];i.twh=k;i.tElement=e.endpoints[y]}f=this.anchor.compute(i)}this.endpoint.compute(f,this.anchor.getOrientation(this),this._jsPlumb.paintStyleInUse,a||this.paintStyleInUse);this.endpoint.paint(this._jsPlumb.paintStyleInUse,this.anchor);this.timestamp=t;for(r in this._jsPlumb.overlays)this._jsPlumb.overlays.hasOwnProperty(r)&&(h=this._jsPlumb.overlays[r],h.isVisible()&&(this._jsPlumb.overlayPlacements[r]=h.draw(this.endpoint,this._jsPlumb.paintStyleInUse),h.paint(this._jsPlumb.overlayPlacements[r])))}},this.getTypeDescriptor=function(){return"endpoint"},this.isVisible=function(){return this._jsPlumb.visible},this.repaint=this.paint,v=!1,this.initDraggable=function(){if(!v&&n.isDragSupported(this.element)){var a,c={id:null,element:null},r=null,p=!1,l=null,w=u(this,c,s),o=i.dragOptions||{},b=n.dragEvents.start,k=n.dragEvents.stop,g=n.dragEvents.drag,nt=n.dragEvents.beforeStart,tt=function(n){a=n.e.payload||{}},it=function(){var o,h,v,g,nt,tt,it,u,b;if(r=this.connectorSelector(),o=!0,this.isEnabled()||(o=!1),null!=r||this.isSource||this.isTemporarySource||(o=!1),!this.isSource||!this.isFull()||null!=r&&this.dragAllowedWhenFull||(o=!1),null==r||r.isDetachable(this)||(o=!1),h=s.checkCondition(null==r?"beforeDrag":"beforeStartDetach",{endpoint:this,source:this.element,sourceId:this.elementId,connection:r}),h===!1?o=!1:"object"==typeof h?n.extend(h,a||{}):h=a||{},o===!1)return s.stopDrag&&s.stopDrag(this.canvas),w.stopDrag(),!1;for(v=0;v<this.connections.length;v++)this.connections[v].setHover(!1);this.addClass("endpointDrag");s.setConnectionBeingDragged(!0);r&&!this.isFull()&&this.isSource&&(r=null);s.updateOffset({elId:this.elementId});var rt=this._jsPlumb.instance.getOffset(this.canvas),k=this.canvas,ut=this._jsPlumb.instance.getSize(this.canvas);f(c,s,rt,ut);s.setAttributes(this.canvas,{dragId:c.id,elId:this.elementId});g=this.dragProxy||this.endpoint;null==this.dragProxy&&null!=this.connectionType&&(nt=this._jsPlumb.instance.deriveEndpointAndAnchorSpec(this.connectionType),nt.endpoints[1]&&(g=nt.endpoints[1]));tt=this._jsPlumb.instance.makeAnchor("Center");tt.isFloating=!0;this._jsPlumb.floatingEndpoint=e(this.getPaintStyle(),tt,g,this.canvas,c.element,s,y,this.scope);it=this._jsPlumb.floatingEndpoint.anchor;null==r?(this.setHover(!1,!1),r=d({sourceEndpoint:this,targetEndpoint:this._jsPlumb.floatingEndpoint,source:this.element,target:c.element,anchors:[this.anchor,this._jsPlumb.floatingEndpoint.anchor],paintStyle:i.connectorStyle,hoverPaintStyle:i.connectorHoverStyle,connector:i.connector,overlays:i.connectorOverlays,type:this.connectionType,cssClass:this.connectorClass,hoverClass:this.connectorHoverClass,scope:i.scope,data:h}),r.pending=!0,r.addClass(s.draggingClass),this._jsPlumb.floatingEndpoint.addClass(s.draggingClass),this._jsPlumb.floatingEndpoint.anchor=it,s.fire("connectionDrag",r),s.anchorManager.newConnection(r)):(p=!0,r.setHover(!1),u=r.endpoints[0].id===this.id?0:1,this.detachFromConnection(r,null,!0),b=s.getDragScope(k),s.setAttribute(this.canvas,"originalScope",b),s.fire("connectionDrag",r),0===u?(l=[r.source,r.sourceId,k,b],s.anchorManager.sourceChanged(r.endpoints[u].elementId,c.id,r,c.element)):(l=[r.target,r.targetId,k,b],r.target=c.element,r.targetId=c.id,s.anchorManager.updateOtherEndpoint(r.sourceId,r.endpoints[u].elementId,r.targetId,r)),r.suspendedEndpoint=r.endpoints[u],r.suspendedElement=r.endpoints[u].getElement(),r.suspendedElementId=r.endpoints[u].elementId,r.suspendedElementType=0===u?"source":"target",r.suspendedEndpoint.setHover(!1),this._jsPlumb.floatingEndpoint.referenceEndpoint=r.suspendedEndpoint,r.endpoints[u]=this._jsPlumb.floatingEndpoint,r.addClass(s.draggingClass),this._jsPlumb.floatingEndpoint.addClass(s.draggingClass));s.floatingConnections[c.id]=r;t.addToList(i.endpointsByElement,c.id,this._jsPlumb.floatingEndpoint);s.currentlyDragging=!0}.bind(this),rt=function(){var t,n,i;(s.setConnectionBeingDragged(!1),r&&null!=r.endpoints)&&(t=s.getDropEvent(arguments),n=s.getFloatingAnchorIndex(r),(r.endpoints[0===n?1:0].anchor.locked=!1,r.removeClass(s.draggingClass),this._jsPlumb&&(r.deleteConnectionNow||r.endpoints[n]===this._jsPlumb.floatingEndpoint)&&p&&r.suspendedEndpoint)&&(0===n?(r.floatingElement=r.source,r.floatingId=r.sourceId,r.floatingEndpoint=r.endpoints[0],r.floatingIndex=0,r.source=l[0],r.sourceId=l[1]):(r.floatingElement=r.target,r.floatingId=r.targetId,r.floatingEndpoint=r.endpoints[1],r.floatingIndex=1,r.target=l[0],r.targetId=l[1]),i=this._jsPlumb.floatingEndpoint,s.setDragScope(l[2],l[3]),r.endpoints[n]=r.suspendedEndpoint,r.isReattach()||r._forceReattach||r._forceDetach||!s.deleteConnection(r)?(r.setHover(!1),r._forceDetach=null,r._forceReattach=null,this._jsPlumb.floatingEndpoint.detachFromConnection(r),r.suspendedEndpoint.addConnection(r),1===n?s.anchorManager.updateOtherEndpoint(r.sourceId,r.floatingId,r.targetId,r):s.anchorManager.sourceChanged(r.floatingId,r.sourceId,r,r.source),s.repaint(l[1])):s.deleteObject({endpoint:i})),this.deleteAfterDragStop?s.deleteObject({endpoint:this}):this._jsPlumb&&this.paint({recalc:!1}),s.fire("connectionDragStop",r,t),r.pending&&s.fire("connectionAborted",r,t),s.currentlyDragging=!1,r.suspendedElement=null,r.suspendedEndpoint=null,r=null);c&&c.element&&s.remove(c.element,!1,!1);h&&s.deleteObject({endpoint:h});this._jsPlumb&&(this.canvas.style.visibility="visible",this.anchor.locked=!1,this._jsPlumb.floatingEndpoint=null)}.bind(this);o=n.extend({},o);o.scope=this.scope||o.scope;o[nt]=t.wrap(o[nt],tt,!1);o[b]=t.wrap(o[b],it,!1);o[g]=t.wrap(o[g],w.drag);o[k]=t.wrap(o[k],rt);o.multipleDrop=!1;o.canDrag=function(){return this.isSource||this.isTemporarySource||this.connections.length>0}.bind(this);s.initDraggable(this.canvas,o,"internal");this.canvas._jsPlumbRelatedElement=this.element;v=!0}},p=i.endpoint||this._jsPlumb.instance.Defaults.Endpoint||n.Defaults.Endpoint,this.setEndpoint(p,!0),w=i.anchor?i.anchor:i.anchors?i.anchors:s.Defaults.Anchor||"Top",this.setAnchor(w,!0),b=["default",i.type||""].join(" "),this.addType(b,i.data,!0),this.canvas=this.endpoint.canvas,this.canvas._jsPlumb=this,this.initDraggable(),k=function(r,u,f,e){var o;if(n.isDropSupported(this.element)){o=i.dropOptions||s.Defaults.DropOptions||n.Defaults.DropOptions;o=n.extend({},o);o.scope=o.scope||this.scope;var c=n.dragEvents.drop,l=n.dragEvents.over,a=n.dragEvents.out,h=this,v=s.EndpointDropHandler({getEndpoint:function(){return h},jsPlumb:s,enabled:function(){return null==f||f.isEnabled()},isFull:function(){return f.isFull()},element:this.element,elementId:this.elementId,isSource:this.isSource,isTarget:this.isTarget,addClass:function(n){h.addClass(n)},removeClass:function(n){h.removeClass(n)},isDropAllowed:function(){return h.isDropAllowed.apply(h,arguments)},reference:e,isRedrop:function(n,t){return n.suspendedEndpoint&&t.reference&&n.suspendedEndpoint.id===t.reference.id}});o[c]=t.wrap(o[c],v,!0);o[l]=t.wrap(o[l],function(){var f=n.getDragObject(arguments),e=s.getAttribute(n.getElement(f),"dragId"),t=s.floatingConnections[e],i,u,r;null!=t&&(i=s.getFloatingAnchorIndex(t),u=this.isTarget&&0!==i||t.suspendedEndpoint&&this.referenceEndpoint&&this.referenceEndpoint.id===t.suspendedEndpoint.id,u&&(r=s.checkCondition("checkDropAllowed",{sourceEndpoint:t.endpoints[i],targetEndpoint:this,connection:t}),this[(r?"add":"remove")+"Class"](s.endpointDropAllowedClass),this[(r?"remove":"add")+"Class"](s.endpointDropForbiddenClass),t.endpoints[i].anchor.over(this.anchor,this)))}.bind(this));o[a]=t.wrap(o[a],function(){var r=n.getDragObject(arguments),u=null==r?null:s.getAttribute(n.getElement(r),"dragId"),t=u?s.floatingConnections[u]:null,i,f;null!=t&&(i=s.getFloatingAnchorIndex(t),f=this.isTarget&&0!==i||t.suspendedEndpoint&&this.referenceEndpoint&&this.referenceEndpoint.id===t.suspendedEndpoint.id,f&&(this.removeClass(s.endpointDropAllowedClass),this.removeClass(s.endpointDropForbiddenClass),t.endpoints[i].anchor.out()))}.bind(this));s.initDroppable(r,o,"internal",u)}}.bind(this),this.anchor.isFloating||k(this.canvas,!(i._transient||this.anchor.isFloating),this,i.reference),this};t.extend(n.Endpoint,n.OverlayCapableJsPlumbUIComponent,{setVisible:function(n,t,i){var r,u;if(this._jsPlumb.visible=n,this.canvas&&(this.canvas.style.display=n?"block":"none"),this[n?"showOverlays":"hideOverlays"](),!t)for(r=0;r<this.connections.length;r++)(this.connections[r].setVisible(n),i)||(u=this===this.connections[r].endpoints[0]?1:0,1===this.connections[r].endpoints[u].connections.length&&this.connections[r].endpoints[u].setVisible(n,!0,!0))},getAttachedElements:function(){return this.connections},applyType:function(t,i){this.setPaintStyle(t.endpointStyle||t.paintStyle,i);this.setHoverPaintStyle(t.endpointHoverStyle||t.hoverPaintStyle,i);null!=t.maxConnections&&(this._jsPlumb.maxConnections=t.maxConnections);t.scope&&(this.scope=t.scope);n.extend(this,t,r);null!=t.cssClass&&this.canvas&&this._jsPlumb.instance.addClass(this.canvas,t.cssClass);n.OverlayCapableJsPlumbUIComponent.applyType(this,t)},isEnabled:function(){return this._jsPlumb.enabled},setEnabled:function(n){this._jsPlumb.enabled=n},cleanup:function(){var t=this._jsPlumb.instance.endpointAnchorClassPrefix+(this._jsPlumb.currentAnchorClass?"-"+this._jsPlumb.currentAnchorClass:"");n.removeClass(this.element,t);this.anchor=null;this.endpoint.cleanup(!0);this.endpoint.destroy();this.endpoint=null;this._jsPlumb.instance.destroyDraggable(this.canvas,"internal");this._jsPlumb.instance.destroyDroppable(this.canvas,"internal")},setHover:function(n){this.endpoint&&this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()&&this.endpoint.setHover(n)},isFull:function(){return 0===this._jsPlumb.maxConnections||!(this.isFloating()||this._jsPlumb.maxConnections<0||this.connections.length<this._jsPlumb.maxConnections)},isFloating:function(){return null!=this.anchor&&this.anchor.isFloating},isConnectedTo:function(n){var i=!1,t;if(n)for(t=0;t<this.connections.length;t++)if(this.connections[t].endpoints[1]===n||this.connections[t].endpoints[0]===n){i=!0;break}return i},getConnectionCost:function(){return this._jsPlumb.connectionCost},setConnectionCost:function(n){this._jsPlumb.connectionCost=n},areConnectionsDirected:function(){return this._jsPlumb.connectionsDirected},setConnectionsDirected:function(n){this._jsPlumb.connectionsDirected=n},setElementId:function(n){this.elementId=n;this.anchor.elementId=n},setReferenceElement:function(t){this.element=n.getElement(t)},setDragAllowedWhenFull:function(n){this.dragAllowedWhenFull=n},equals:function(n){return this.anchor.equals(n.anchor)},getUuid:function(){return this._jsPlumb.uuid},computeAnchor:function(n){return this.anchor.compute(n)}});i.jsPlumbInstance.prototype.EndpointDropHandler=function(n){return function(i){var u=n.jsPlumb,h,e,f,l,o,v,y;n.removeClass(u.endpointDropAllowedClass);n.removeClass(u.endpointDropForbiddenClass);var c=u.getDropEvent(arguments),s=u.getDragObject(arguments),p=u.getAttribute(s,"dragId"),a=(u.getAttribute(s,"elId"),u.getAttribute(s,"originalScope")),r=u.floatingConnections[p];if(null!=r&&(h=null!=r.suspendedEndpoint,(!h||null!=r.suspendedEndpoint._jsPlumb)&&(e=n.getEndpoint(r),null!=e))){if(n.isRedrop(r,n))return r._forceReattach=!0,r.setHover(!1),void(n.maybeCleanup&&n.maybeCleanup(e));if(f=u.getFloatingAnchorIndex(r),0===f&&!n.isSource||1===f&&!n.isTarget)return void(n.maybeCleanup&&n.maybeCleanup(e));if(n.onDrop&&n.onDrop(r),a&&u.setDragScope(s,a),l=n.isFull(i),l&&e.fire("maxConnections",{endpoint:this,connection:r,maxConnections:e._jsPlumb.maxConnections},c),!l&&n.enabled()){if(o=!0,0===f?(r.floatingElement=r.source,r.floatingId=r.sourceId,r.floatingEndpoint=r.endpoints[0],r.floatingIndex=0,r.source=n.element,r.sourceId=n.elementId):(r.floatingElement=r.target,r.floatingId=r.targetId,r.floatingEndpoint=r.endpoints[1],r.floatingIndex=1,r.target=n.element,r.targetId=n.elementId),h&&r.suspendedEndpoint.id!==e.id&&(r.isDetachAllowed(r)&&r.endpoints[f].isDetachAllowed(r)&&r.suspendedEndpoint.isDetachAllowed(r)&&u.checkCondition("beforeDetach",r)||(o=!1)),v=function(i){var o,s,l,a;r.endpoints[f].detachFromConnection(r);r.suspendedEndpoint&&r.suspendedEndpoint.detachFromConnection(r);r.endpoints[f]=e;e.addConnection(r);o=e.getParameters();for(s in o)r.setParameter(s,o[s]);h?(l=r.suspendedEndpoint.elementId,u.fireMoveEvent({index:f,originalSourceId:0===f?l:r.sourceId,newSourceId:0===f?e.elementId:r.sourceId,originalTargetId:1===f?l:r.targetId,newTargetId:1===f?e.elementId:r.targetId,originalSourceEndpoint:0===f?r.suspendedEndpoint:r.endpoints[0],newSourceEndpoint:0===f?e:r.endpoints[0],originalTargetEndpoint:1===f?r.suspendedEndpoint:r.endpoints[1],newTargetEndpoint:1===f?e:r.endpoints[1],connection:r},c)):o.draggable&&u.initDraggable(this.element,n.dragOptions,"internal",u);(1===f?u.anchorManager.updateOtherEndpoint(r.sourceId,r.floatingId,r.targetId,r):u.anchorManager.sourceChanged(r.floatingId,r.sourceId,r,r.source),r.endpoints[0].finalEndpoint)&&(a=r.endpoints[0],a.detachFromConnection(r),r.endpoints[0]=r.endpoints[0].finalEndpoint,r.endpoints[0].addConnection(r));t.isObject(i)&&r.mergeData(i);u.finaliseConnection(r,null,c,!1);r.setHover(!1)}.bind(this),y=function(){r.suspendedEndpoint&&(r.endpoints[f]=r.suspendedEndpoint,r.setHover(!1),r._forceDetach=!0,0===f?(r.source=r.suspendedEndpoint.element,r.sourceId=r.suspendedEndpoint.elementId):(r.target=r.suspendedEndpoint.element,r.targetId=r.suspendedEndpoint.elementId),r.suspendedEndpoint.addConnection(r),1===f?u.anchorManager.updateOtherEndpoint(r.sourceId,r.floatingId,r.targetId,r):u.anchorManager.sourceChanged(r.floatingId,r.sourceId,r,r.source),u.repaint(r.sourceId),r._forceDetach=!1)},o=o&&n.isDropAllowed(r.sourceId,r.targetId,r.scope,r,e))return v(o),!0;y()}n.maybeCleanup&&n.maybeCleanup(e);u.currentlyDragging=!1}}}}.call("undefined"!=typeof window?window:this),function(){"use strict";var i=this,n=i.jsPlumb,t=i.jsPlumbUtil,u=function(t,i,r,u,f){if(!t.Defaults.DoNotThrowErrors&&null==n.Connectors[i][r])throw{msg:"jsPlumb: unknown connector type '"+r+"'"};return new n.Connectors[i][r](u,f)},r=function(n,t,i){return n?i.makeAnchor(n,t,i):null},f=function(n,i,r,u){null!=i&&(i._jsPlumbConnections=i._jsPlumbConnections||{},u?delete i._jsPlumbConnections[n.id]:i._jsPlumbConnections[n.id]=!0,t.isEmpty(i._jsPlumbConnections)?r.removeClass(i,r.connectedClass):r.addClass(i,r.connectedClass))};n.Connection=function(i){var g=i.newEndpoint,r,c,l,u,y,p,h,f,v;if(this.id=i.id,this.connector=null,this.idPrefix="_jsplumb_c_",this.defaultLabelLocation=.5,this.defaultOverlayKeys=["Overlays","ConnectionOverlays"],this.previousConnection=i.previousConnection,this.source=n.getElement(i.source),this.target=n.getElement(i.target),i.sourceEndpoint&&(this.source=i.sourceEndpoint.getElement()),i.targetEndpoint&&(this.target=i.targetEndpoint.getElement()),n.OverlayCapableJsPlumbUIComponent.apply(this,arguments),this.sourceId=this._jsPlumb.instance.getId(this.source),this.targetId=this._jsPlumb.instance.getId(this.target),this.scope=i.scope,this.endpoints=[],this.endpointStyles=[],r=this._jsPlumb.instance,r.manage(this.sourceId,this.source),r.manage(this.targetId,this.target),this._jsPlumb.visible=!0,this._jsPlumb.editable=i.editable===!0,this._jsPlumb.params={cssClass:i.cssClass,container:i.container,"pointer-events":i["pointer-events"],editorParams:i.editorParams,overlays:i.overlays},this._jsPlumb.lastPaintedAt=null,this.bind("mouseover",function(){this.setHover(!0)}.bind(this)),this.bind("mouseout",function(){this.setHover(!1)}.bind(this)),this.editableRequested=i.editable!==!1,this.setEditable=function(n){return!!this.connector&&this.connector.setEditable(n)},this.isEditable=function(){return!!this.connector&&this.connector.isEditable()},this.isEditing=function(){return!!this.connector&&this.connector.isEditing()},this.makeEndpoint=function(n,t,u,f){return u=u||this._jsPlumb.instance.getId(t),this.prepareEndpoint(r,g,this,f,n?0:1,i,t,u)},i.type&&(i.endpoints=i.endpoints||this._jsPlumb.instance.deriveEndpointAndAnchorSpec(i.type).endpoints),c=this.makeEndpoint(!0,this.source,this.sourceId,i.sourceEndpoint),l=this.makeEndpoint(!1,this.target,this.targetId,i.targetEndpoint),c&&t.addToList(i.endpointsByElement,this.sourceId,c),l&&t.addToList(i.endpointsByElement,this.targetId,l),this.scope||(this.scope=this.endpoints[0].scope),null!=i.deleteEndpointsOnEmpty&&(this.endpoints[0].setDeleteOnEmpty(i.deleteEndpointsOnEmpty),this.endpoints[1].setDeleteOnEmpty(i.deleteEndpointsOnEmpty)),u=r.Defaults.ConnectionsDetachable,i.detachable===!1&&(u=!1),this.endpoints[0].connectionsDetachable===!1&&(u=!1),this.endpoints[1].connectionsDetachable===!1&&(u=!1),y=i.reattach||this.endpoints[0].reattachConnections||this.endpoints[1].reattachConnections||r.Defaults.ReattachConnections,this.appendToDefaultType({detachable:u,reattach:y,paintStyle:this.endpoints[0].connectorStyle||this.endpoints[1].connectorStyle||i.paintStyle||r.Defaults.PaintStyle||n.Defaults.PaintStyle,hoverPaintStyle:this.endpoints[0].connectorHoverStyle||this.endpoints[1].connectorHoverStyle||i.hoverPaintStyle||r.Defaults.HoverPaintStyle||n.Defaults.HoverPaintStyle}),p=r.getSuspendedAt(),!r.isSuspendDrawing()){var w=r.getCachedData(this.sourceId),e=w.o,b=w.s,k=r.getCachedData(this.targetId),o=k.o,d=k.s,s=p||r.timestamp(),a=this.endpoints[0].anchor.compute({xy:[e.left,e.top],wh:b,element:this.endpoints[0],elementId:this.endpoints[0].elementId,txy:[o.left,o.top],twh:d,tElement:this.endpoints[1],timestamp:s});this.endpoints[0].paint({anchorLoc:a,timestamp:s});a=this.endpoints[1].anchor.compute({xy:[o.left,o.top],wh:d,element:this.endpoints[1],elementId:this.endpoints[1].elementId,txy:[e.left,e.top],twh:b,tElement:this.endpoints[0],timestamp:s});this.endpoints[1].paint({anchorLoc:a,timestamp:s})}this.getTypeDescriptor=function(){return"connection"};this.getAttachedElements=function(){return this.endpoints};this.isDetachable=function(){return this._jsPlumb.detachable===!0};this.setDetachable=function(n){this._jsPlumb.detachable=n===!0};this.isReattach=function(){return this._jsPlumb.reattach===!0||this.endpoints[0].reattachConnections===!0||this.endpoints[1].reattachConnections===!0};this.setReattach=function(n){this._jsPlumb.reattach=n===!0};this._jsPlumb.cost=i.cost||this.endpoints[0].getConnectionCost();this._jsPlumb.directed=i.directed;null==i.directed&&(this._jsPlumb.directed=this.endpoints[0].areConnectionsDirected());h=n.extend({},this.endpoints[1].getParameters());n.extend(h,this.endpoints[0].getParameters());n.extend(h,this.getParameters());this.setParameters(h);this.setConnector(this.endpoints[0].connector||this.endpoints[1].connector||i.connector||r.Defaults.Connector||n.Defaults.Connector,!0);i.geometry&&this.connector.setGeometry(i.geometry);f=null!=i.data&&t.isObject(i.data)?i.data:{};this.getData=function(){return f};this.setData=function(n){f=n||{}};this.mergeData=function(t){f=n.extend(f,t)};v=["default",this.endpoints[0].connectionType,this.endpoints[1].connectionType,i.type].join(" ");/[^\s]/.test(v)&&this.addType(v,i.data,!0);this.updateConnectedClass()};t.extend(n.Connection,n.OverlayCapableJsPlumbUIComponent,{applyType:function(t,i,r){null!=t.detachable&&this.setDetachable(t.detachable);null!=t.reattach&&this.setReattach(t.reattach);t.scope&&(this.scope=t.scope);null!=t.cssClass&&this.canvas&&this._jsPlumb.instance.addClass(this.canvas,t.cssClass);var u=null;t.anchor?(u=this.getCachedTypeItem("anchors",r.anchor),null==u&&(u=[this._jsPlumb.instance.makeAnchor(t.anchor),this._jsPlumb.instance.makeAnchor(t.anchor)],this.cacheTypeItem("anchors",u,r.anchor))):t.anchors&&(u=this.getCachedTypeItem("anchors",r.anchors),null==u&&(u=[this._jsPlumb.instance.makeAnchor(t.anchors[0]),this._jsPlumb.instance.makeAnchor(t.anchors[1])],this.cacheTypeItem("anchors",u,r.anchors)));null!=u&&(this.endpoints[0].anchor=u[0],this.endpoints[1].anchor=u[1],this.endpoints[1].anchor.isDynamic&&this._jsPlumb.instance.repaint(this.endpoints[1].elementId));n.OverlayCapableJsPlumbUIComponent.applyType(this,t)},addClass:function(n,t){t&&(this.endpoints[0].addClass(n),this.endpoints[1].addClass(n),this.suspendedEndpoint&&this.suspendedEndpoint.addClass(n));this.connector&&this.connector.addClass(n)},removeClass:function(n,t){t&&(this.endpoints[0].removeClass(n),this.endpoints[1].removeClass(n),this.suspendedEndpoint&&this.suspendedEndpoint.removeClass(n));this.connector&&this.connector.removeClass(n)},isVisible:function(){return this._jsPlumb.visible},setVisible:function(n){this._jsPlumb.visible=n;this.connector&&this.connector.setVisible(n);this.repaint()},cleanup:function(){this.updateConnectedClass(!0);this.endpoints=null;this.source=null;this.target=null;null!=this.connector&&(this.connector.cleanup(!0),this.connector.destroy(!0));this.connector=null},updateConnectedClass:function(n){this._jsPlumb&&(f(this,this.source,this._jsPlumb.instance,n),f(this,this.target,this._jsPlumb.instance,n))},setHover:function(n){this.connector&&this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()&&(this.connector.setHover(n),i.jsPlumb[n?"addClass":"removeClass"](this.source,this._jsPlumb.instance.hoverSourceClass),i.jsPlumb[n?"addClass":"removeClass"](this.target,this._jsPlumb.instance.hoverTargetClass))},getUuids:function(){return[this.endpoints[0].getUuid(),this.endpoints[1].getUuid()]},getCost:function(){return this._jsPlumb?this._jsPlumb.cost:-(1/0)},setCost:function(n){this._jsPlumb.cost=n},isDirected:function(){return this._jsPlumb.directed===!0},getConnector:function(){return this.connector},getGeometry:function(){return this.connector?this.connector.getGeometry():null},setGeometry:function(n){this.connector&&this.connector.setGeometry(n)},prepareConnector:function(n,i){var r,f={_jsPlumb:this._jsPlumb.instance,cssClass:(this._jsPlumb.params.cssClass||"")+(this.isEditable()?this._jsPlumb.instance.editableConnectorClass:""),container:this._jsPlumb.params.container,"pointer-events":this._jsPlumb.params["pointer-events"],editable:this.editableRequested},e=this._jsPlumb.instance.getRenderMode();return t.isString(n)?r=u(this._jsPlumb.instance,e,n,f,this):t.isArray(n)&&(r=1===n.length?u(this._jsPlumb.instance,e,n[0],f,this):u(this._jsPlumb.instance,e,n[0],t.merge(n[1],f),this)),null!=i&&(r.typeId=i),r},setPreparedConnector:function(n,t,i,r){var e,o="",f,u;if(null!=this.connector&&(e=this.connector,o=e.getClass(),this.connector.cleanup(),this.connector.destroy()),this.connector=n,r&&this.cacheTypeItem("connector",n,r),this.canvas=this.connector.canvas,this.bgCanvas=this.connector.bgCanvas,this.addClass(o),this.canvas&&(this.canvas._jsPlumb=this),this.bgCanvas&&(this.bgCanvas._jsPlumb=this),null!=e)for(f=this.getOverlays(),u=0;u<f.length;u++)f[u].transfer&&f[u].transfer(this.connector);i||this.setListenerComponent(this.connector);t||this.repaint()},setConnector:function(n,t,i,r){var u=this.prepareConnector(n,r);this.setPreparedConnector(u,t,i,r)},paint:function(n){var t,i,o,c,l;if(!this._jsPlumb.instance.isSuspendDrawing()&&this._jsPlumb.visible){n=n||{};var r=n.timestamp,e=!1,b=e?this.sourceId:this.targetId,k=e?this.targetId:this.sourceId,a=e?0:1,v=e?1:0;if(null==r||r!==this._jsPlumb.lastPaintedAt){var u=this._jsPlumb.instance.updateOffset({elId:k}).o,f=this._jsPlumb.instance.updateOffset({elId:b}).o,y=this.endpoints[v],p=this.endpoints[a],d=y.anchor.getCurrentLocation({xy:[u.left,u.top],wh:[u.width,u.height],element:y,timestamp:r}),g=p.anchor.getCurrentLocation({xy:[f.left,f.top],wh:[f.width,f.height],element:p,timestamp:r});this.connector.resetBounds();this.connector.compute({sourcePos:d,targetPos:g,sourceEndpoint:this.endpoints[v],targetEndpoint:this.endpoints[a],"stroke-width":this._jsPlumb.paintStyleInUse.strokeWidth,sourceInfo:u,targetInfo:f});t={minX:1/0,minY:1/0,maxX:-(1/0),maxY:-(1/0)};for(i in this._jsPlumb.overlays)this._jsPlumb.overlays.hasOwnProperty(i)&&(o=this._jsPlumb.overlays[i],o.isVisible()&&(this._jsPlumb.overlayPlacements[i]=o.draw(this.connector,this._jsPlumb.paintStyleInUse,this.getAbsoluteOverlayPosition(o)),t.minX=Math.min(t.minX,this._jsPlumb.overlayPlacements[i].minX),t.maxX=Math.max(t.maxX,this._jsPlumb.overlayPlacements[i].maxX),t.minY=Math.min(t.minY,this._jsPlumb.overlayPlacements[i].minY),t.maxY=Math.max(t.maxY,this._jsPlumb.overlayPlacements[i].maxY)));var s=parseFloat(this._jsPlumb.paintStyleInUse.strokeWidth||1)/2,h=parseFloat(this._jsPlumb.paintStyleInUse.strokeWidth||0),w={xmin:Math.min(this.connector.bounds.minX-(s+h),t.minX),ymin:Math.min(this.connector.bounds.minY-(s+h),t.minY),xmax:Math.max(this.connector.bounds.maxX+(s+h),t.maxX),ymax:Math.max(this.connector.bounds.maxY+(s+h),t.maxY)};this.connector.paint(this._jsPlumb.paintStyleInUse,null,w);for(c in this._jsPlumb.overlays)this._jsPlumb.overlays.hasOwnProperty(c)&&(l=this._jsPlumb.overlays[c],l.isVisible()&&l.paint(this._jsPlumb.overlayPlacements[c],w))}this._jsPlumb.lastPaintedAt=r}},repaint:function(n){n=n||{};this.paint({elId:this.sourceId,recalc:!(n.recalc===!1),timestamp:n.timestamp})},prepareEndpoint:function(t,i,u,f,e,o,s,h){var a,v,c,l,y,p;return f?(u.endpoints[e]=f,f.addConnection(u)):(o.endpoints||(o.endpoints=[null,null]),v=o.endpoints[e]||o.endpoint||t.Defaults.Endpoints[e]||n.Defaults.Endpoints[e]||t.Defaults.Endpoint||n.Defaults.Endpoint,o.endpointStyles||(o.endpointStyles=[null,null]),o.endpointHoverStyles||(o.endpointHoverStyles=[null,null]),c=o.endpointStyles[e]||o.endpointStyle||t.Defaults.EndpointStyles[e]||n.Defaults.EndpointStyles[e]||t.Defaults.EndpointStyle||n.Defaults.EndpointStyle,null==c.fill&&null!=o.paintStyle&&(c.fill=o.paintStyle.stroke),null==c.outlineStroke&&null!=o.paintStyle&&(c.outlineStroke=o.paintStyle.outlineStroke),null==c.outlineWidth&&null!=o.paintStyle&&(c.outlineWidth=o.paintStyle.outlineWidth),l=o.endpointHoverStyles[e]||o.endpointHoverStyle||t.Defaults.EndpointHoverStyles[e]||n.Defaults.EndpointHoverStyles[e]||t.Defaults.EndpointHoverStyle||n.Defaults.EndpointHoverStyle,null!=o.hoverPaintStyle&&(null==l&&(l={}),null==l.fill&&(l.fill=o.hoverPaintStyle.stroke)),y=o.anchors?o.anchors[e]:o.anchor?o.anchor:r(t.Defaults.Anchors[e],h,t)||r(n.Defaults.Anchors[e],h,t)||r(t.Defaults.Anchor,h,t)||r(n.Defaults.Anchor,h,t),p=o.uuids?o.uuids[e]:null,a=i({paintStyle:c,hoverPaintStyle:l,endpoint:v,connections:[u],uuid:p,anchor:y,source:s,scope:o.scope,reattach:o.reattach||t.Defaults.ReattachConnections,detachable:o.detachable||t.Defaults.ConnectionsDetachable}),null==f&&a.setDeleteOnEmpty(!0),u.endpoints[e]=a,o.drawEndpoints===!1&&a.setVisible(!1,!0,!0)),a}})}.call("undefined"!=typeof window?window:this),function(){"use strict";var u=this,n=u.jsPlumbUtil,t=u.jsPlumb,f,i,r;t.AnchorManager=function(i){var f={},a={},h={},y={},b={HORIZONTAL:"horizontal",VERTICAL:"vertical",DIAGONAL:"diagonal",IDENTITY:"identity"},o=["left","top","right","bottom"],r={},c=this,u={},e=i.jsPlumbInstance,v={},k=function(n,t,i,r,u,f){var h,c;if(n===t)return{orientation:b.IDENTITY,a:["top","top"]};var y=Math.atan2(r.centery-i.centery,r.centerx-i.centerx),p=Math.atan2(i.centery-r.centery,i.centerx-r.centerx),e=[],l={};for(!function(n,t){for(var i=0;i<n.length;i++)l[n[i]]={left:[t[i].left,t[i].centery],right:[t[i].right,t[i].centery],top:[t[i].centerx,t[i].top],bottom:[t[i].centerx,t[i].bottom]}}(["source","target"],[i,r]),h=0;h<o.length;h++)for(c=0;c<o.length;c++)e.push({source:o[h],target:o[c],dist:Biltong.lineLength(l.source[o[h]],l.target[o[c]])});e.sort(function(n,t){return n.dist<t.dist?-1:n.dist>t.dist?1:0});for(var a=e[0].source,v=e[0].target,s=0;s<e.length&&(a=!u.isContinuous||u.isEdgeSupported(e[s].source)?e[s].source:null,v=!f.isContinuous||f.isEdgeSupported(e[s].target)?e[s].target:null,null==a||null==v);s++);return{a:[a,v],theta:y,theta2:p}},d=function(n,t,i,r,u,f,e){for(var s,h,c=[],v=t[u?0:1]/(r.length+1),o=0;o<r.length;o++){s=(o+1)*v;h=f*t[u?1:0];e&&(s=t[u?0:1]-s);var l=u?s:h,y=i[0]+l,p=l/t[0],a=u?h:s,w=i[1]+a,b=a/t[1];c.push([y,w,p,b,r[o][1],r[o][2]])}return c},p=function(n){return function(t,i){var r=!0;return r=n?t[0][0]<i[0][0]:t[0][0]>i[0][0],r===!1?-1:1}},g=function(n,t){var i=n[0][0]<0?-Math.PI-n[0][0]:Math.PI-n[0][0],r=t[0][0]<0?-Math.PI-t[0][0]:Math.PI-t[0][0];return i>r?1:-1},nt={top:function(n,t){return n[0]>t[0]?1:-1},right:p(!0),bottom:p(!0),left:g},tt=function(n,t){return n.sort(t)},it=function(n,t){var f=e.getCachedData(n),r=f.s,i=f.o,u=function(t,i,r,u,f,e,o){if(u.length>0)for(var v=tt(u,nt[t]),p="right"===t||"top"===t,h=d(t,i,r,v,f,e,p),l=function(n,t){a[n.id]=[t[0],t[1],t[2],t[3]];y[n.id]=o},s=0;s<h.length;s++){var c=h[s][4],w=c.endpoints[0].elementId===n,b=c.endpoints[1].elementId===n;w&&l(c.endpoints[0],h[s]);b&&l(c.endpoints[1],h[s])}};u("bottom",r,[i.left,i.top],t.bottom,!0,1,[0,1]);u("top",r,[i.left,i.top],t.top,!0,0,[0,-1]);u("left",r,[i.left,i.top],t.left,!1,0,[-1,0]);u("right",r,[i.left,i.top],t.right,!1,1,[1,0])},l,s,w;this.reset=function(){f={};r={};u={}};this.addFloatingConnection=function(n,t){v[n]=t};this.removeFloatingConnection=function(n){delete v[n]};this.newConnection=function(i){var f=i.sourceId,e=i.targetId,u=i.endpoints,o=!0,s=function(s,h,c,l,a){f===e&&c.isContinuous&&(i._jsPlumb.instance.removeElement(u[1].canvas),o=!1);n.addToList(r,l,[a,h,c.constructor===t.DynamicAnchor])};s(0,u[0],u[0].anchor,e,i);o&&s(1,u[1],u[1].anchor,f,i)};l=function(t){!function(t,i){if(t){var r=function(n){return n[4]===i};n.removeWithFunction(t.top,r);n.removeWithFunction(t.left,r);n.removeWithFunction(t.bottom,r);n.removeWithFunction(t.right,r)}}(u[t.elementId],t.id)};this.connectionDetached=function(t,i){var u=t.connection||t,o=t.sourceId,s=t.targetId,f=u.endpoints,e=function(t,i,u,f,e){n.removeWithFunction(r[f],function(n){return n[0].id===e.id})};e(1,f[1],f[1].anchor,o,u);e(0,f[0],f[0].anchor,s,u);u.floatingId&&(e(u.floatingIndex,u.floatingEndpoint,u.floatingEndpoint.anchor,u.floatingId,u),l(u.floatingEndpoint));l(u.endpoints[0]);l(u.endpoints[1]);i||(c.redraw(u.sourceId),u.targetId!==u.sourceId&&c.redraw(u.targetId))};this.add=function(t,i){n.addToList(f,i,t)};this.changeId=function(n,t){r[t]=r[n];f[t]=f[n];delete r[n];delete f[n]};this.getConnectionsFor=function(n){return r[n]||[]};this.getEndpointsFor=function(n){return f[n]||[]};this.deleteEndpoint=function(t){n.removeWithFunction(f[t.elementId],function(n){return n.id===t.id});l(t)};this.clearFor=function(n){delete f[n];f[n]=[]};s=function(t,r,u,f,e,o,s,h,c,l,a,v){var y,p,tt=-1,k=-1,d=f.endpoints[s],it=d.id,g=[1,0][s],rt=[[r,u],f,e,o,it],w=t[c],b=d._continuousAnchorEdge?t[d._continuousAnchorEdge]:null,nt,ut;if(b&&(nt=n.findWithFunction(b,function(n){return n[4]===it}),nt!==-1))for(b.splice(nt,1),y=0;y<b.length;y++)p=b[y][1],n.addWithFunction(a,p,function(n){return n.id===p.id}),n.addWithFunction(v,b[y][1].endpoints[s],function(n){return n.id===p.endpoints[s].id}),n.addWithFunction(v,b[y][1].endpoints[g],function(n){return n.id===p.endpoints[g].id});for(y=0;y<w.length;y++)p=w[y][1],1===i.idx&&w[y][3]===o&&k===-1&&(k=y),n.addWithFunction(a,p,function(n){return n.id===p.id}),n.addWithFunction(v,w[y][1].endpoints[s],function(n){return n.id===p.endpoints[s].id}),n.addWithFunction(v,w[y][1].endpoints[g],function(n){return n.id===p.endpoints[g].id});tt!==-1?w[tt]=rt:(ut=h?k!==-1?k:0:w.length,w.splice(ut,0,rt));d._continuousAnchorEdge=c};this.updateOtherEndpoint=function(i,u,f,e){var o=n.findWithFunction(r[i],function(n){return n[0].id===e.id}),s=n.findWithFunction(r[u],function(n){return n[0].id===e.id});o!==-1&&(r[i][o][0]=e,r[i][o][1]=e.endpoints[1],r[i][o][2]=e.endpoints[1].anchor.constructor===t.DynamicAnchor);s>-1&&(r[u].splice(s,1),n.addToList(r,f,[e,e.endpoints[0],e.endpoints[0].anchor.constructor===t.DynamicAnchor]));e.updateConnectedClass()};this.sourceChanged=function(i,u,f,e){if(i!==u){f.sourceId=u;f.source=e;n.removeWithFunction(r[i],function(n){return n[0].id===f.id});var o=n.findWithFunction(r[f.targetId],function(n){return n[0].id===f.id});o>-1&&(r[f.targetId][o][0]=f,r[f.targetId][o][1]=f.endpoints[0],r[f.targetId][o][2]=f.endpoints[0].anchor.constructor===t.DynamicAnchor);n.addToList(r,u,[f,f.endpoints[1],f.endpoints[1].anchor.constructor===t.DynamicAnchor]);f.endpoints[1].anchor.isContinuous&&(f.source===f.target?f._jsPlumb.instance.removeElement(f.endpoints[1].canvas):null==f.endpoints[1].canvas.parentNode&&f._jsPlumb.instance.appendElement(f.endpoints[1].canvas));f.updateConnectedClass()}};this.rehomeEndpoint=function(n,t,i){var o=f[t]||[],s=e.getId(i),u,h,r;for(s!==t&&(u=o.indexOf(n),u>-1&&(h=o.splice(u,1)[0],c.add(h,s))),r=0;r<n.connections.length;r++)n.connections[r].sourceId===t?c.sourceChanged(t,n.elementId,n.connections[r],n.element):n.connections[r].targetId===t&&(n.connections[r].targetId=n.elementId,n.connections[r].target=n.element,c.updateOtherEndpoint(n.connections[r].sourceId,t,n.elementId,n.connections[r]))};this.redraw=function(i,o,h,c,l,a){var pt,wt,ct,rt,st,lt;if(!e.isSuspendDrawing()){var tt=f[i]||[],g=r[i]||[],d=[],nt=[],ft=[];h=h||e.timestamp();c=c||{left:0,top:0};o&&(o={left:o.left+c.left,top:o.top+c.top});for(var at=e.updateOffset({elId:i,offset:o,recalc:!1,timestamp:h}),vt={},y=0;y<g.length;y++){var b=g[y][0],p=b.sourceId,w=b.targetId,et=b.endpoints[0].anchor.isContinuous,ot=b.endpoints[1].anchor.isContinuous;if(et||ot){var yt=p+"_"+w,ut=vt[yt],ht=b.sourceId===i?1:0;et&&!u[p]&&(u[p]={top:[],right:[],bottom:[],left:[]});ot&&!u[w]&&(u[w]={top:[],right:[],bottom:[],left:[]});i!==w&&e.updateOffset({elId:w,timestamp:h});i!==p&&e.updateOffset({elId:p,timestamp:h});pt=e.getCachedData(w);wt=e.getCachedData(p);w===p&&(et||ot)?(s(u[p],-Math.PI/2,0,b,!1,w,0,!1,"top",p,d,nt),s(u[w],-Math.PI/2,0,b,!1,p,1,!1,"top",w,d,nt)):(ut||(ut=k(p,w,wt.o,pt.o,b.endpoints[0].anchor,b.endpoints[1].anchor),vt[yt]=ut),et&&s(u[p],ut.theta,0,b,!1,w,0,!1,ut.a[0],p,d,nt),ot&&s(u[w],ut.theta2,-1,b,!0,p,1,!0,ut.a[1],w,d,nt));et&&n.addWithFunction(ft,p,function(n){return n===p});ot&&n.addWithFunction(ft,w,function(n){return n===w});n.addWithFunction(d,b,function(n){return n.id===b.id});(et&&0===ht||ot&&1===ht)&&n.addWithFunction(nt,b.endpoints[ht],function(n){return n.id===b.endpoints[ht].id})}}for(y=0;y<tt.length;y++)0===tt[y].connections.length&&tt[y].anchor.isContinuous&&(u[i]||(u[i]={top:[],right:[],bottom:[],left:[]}),s(u[i],-Math.PI/2,0,{endpoints:[tt[y],tt[y]],paint:function(){}},!1,i,0,!1,tt[y].anchor.getDefaultFace(),i,d,nt),n.addWithFunction(ft,i,function(n){return n===i}));for(y=0;y<ft.length;y++)it(ft[y],u[ft[y]]);for(y=0;y<tt.length;y++)tt[y].paint({timestamp:h,offset:at,dimensions:at.s,recalc:a!==!0});for(y=0;y<nt.length;y++)ct=e.getCachedData(nt[y].elementId),nt[y].paint({timestamp:h,offset:ct,dimensions:ct.s});for(y=0;y<g.length;y++)if(rt=g[y][1],rt.anchor.constructor===t.DynamicAnchor)for(rt.paint({elementWithPrecedence:i,timestamp:h}),n.addWithFunction(d,g[y][0],function(n){return n.id===g[y][0].id}),st=0;st<rt.connections.length;st++)rt.connections[st]!==g[y][0]&&n.addWithFunction(d,rt.connections[st],function(n){return n.id===rt.connections[st].id});else rt.anchor.constructor===t.Anchor&&n.addWithFunction(d,g[y][0],function(n){return n.id===g[y][0].id});for(lt=v[i],lt&&lt.paint({timestamp:h,recalc:!1,elId:i}),y=0;y<d.length;y++)d[y].paint({elId:i,timestamp:h,recalc:!1,clearEdits:l})}};w=function(t){n.EventGenerator.apply(this);this.type="Continuous";this.isDynamic=!0;this.isContinuous=!0;for(var r=t.faces||["top","right","bottom","left"],f=!(t.clockwise===!1),i={},e={top:"bottom",right:"left",left:"right",bottom:"top"},o={top:"right",right:"bottom",left:"top",bottom:"left"},s={top:"left",right:"top",left:"bottom",bottom:"right"},c=f?o:s,l=f?s:o,v=t.cssClass||"",u=0;u<r.length;u++)i[r[u]]=!0;this.getDefaultFace=function(){return 0===r.length?"top":r[0]};this.verifyEdge=function(n){return i[n]?n:i[e[n]]?e[n]:i[c[n]]?c[n]:i[l[n]]?l[n]:n};this.isEdgeSupported=function(n){return i[n]===!0};this.compute=function(n){return h[n.element.id]||a[n.element.id]||[0,0]};this.getCurrentLocation=function(n){return h[n.element.id]||a[n.element.id]||[0,0]};this.getOrientation=function(n){return y[n.id]||[0,0]};this.clearUserDefinedLocation=function(){delete h[t.elementId]};this.setUserDefinedLocation=function(n){h[t.elementId]=n};this.getCssClass=function(){return v}};e.continuousAnchorFactory={get:function(n){return new w(n)},clear:function(n){delete h[n];delete a[n]}}};t.Anchor=function(t){this.x=t.x||0;this.y=t.y||0;this.elementId=t.elementId;this.cssClass=t.cssClass||"";this.userDefinedLocation=null;this.orientation=t.orientation||[0,0];this.lastReturnValue=null;this.offsets=t.offsets||[0,0];this.timestamp=null;n.EventGenerator.apply(this);this.compute=function(n){var i=n.xy,r=n.wh,t=n.timestamp;return n.clearUserDefinedLocation&&(this.userDefinedLocation=null),t&&t===this.timestamp?this.lastReturnValue:(this.lastReturnValue=null!=this.userDefinedLocation?this.userDefinedLocation:[i[0]+this.x*r[0]+this.offsets[0],i[1]+this.y*r[1]+this.offsets[1]],this.timestamp=t,this.lastReturnValue)};this.getCurrentLocation=function(n){return n=n||{},null==this.lastReturnValue||null!=n.timestamp&&this.timestamp!==n.timestamp?this.compute(n):this.lastReturnValue}};n.extend(t.Anchor,n.EventGenerator,{equals:function(n){if(!n)return!1;var t=n.getOrientation(),i=this.getOrientation();return this.x===n.x&&this.y===n.y&&this.offsets[0]===n.offsets[0]&&this.offsets[1]===n.offsets[1]&&i[0]===t[0]&&i[1]===t[1]},getUserDefinedLocation:function(){return this.userDefinedLocation},setUserDefinedLocation:function(n){this.userDefinedLocation=n},clearUserDefinedLocation:function(){this.userDefinedLocation=null},getOrientation:function(){return this.orientation},getCssClass:function(){return this.cssClass}});t.FloatingAnchor=function(n){t.Anchor.apply(this,arguments);var f=n.reference,e=n.referenceCanvas,u=t.getSize(e),o=0,s=0,i=null,r=null;this.orientation=null;this.x=0;this.y=0;this.isFloating=!0;this.compute=function(n){var t=n.xy,i=[t[0]+u[0]/2,t[1]+u[1]/2];return r=i,i};this.getOrientation=function(n){if(i)return i;var t=f.getOrientation(n);return[Math.abs(t[0])*o*-1,Math.abs(t[1])*s*-1]};this.over=function(n,t){i=n.getOrientation(t)};this.out=function(){i=null};this.getCurrentLocation=function(n){return null==r?this.compute(n):r}};n.extend(t.FloatingAnchor,t.Anchor);f=function(n,i,r){return n.constructor===t.Anchor?n:i.makeAnchor(n,r,i)};t.DynamicAnchor=function(n){var r;for(t.Anchor.apply(this,arguments),this.isDynamic=!0,this.anchors=[],this.elementId=n.elementId,this.jsPlumbInstance=n.jsPlumbInstance,r=0;r<n.anchors.length;r++)this.anchors[r]=f(n.anchors[r],this.jsPlumbInstance,this.elementId);this.getAnchors=function(){return this.anchors};this.locked=!1;var i=this.anchors.length>0?this.anchors[0]:null,u=i,e=this,o=function(n,t,i,r,u){var f=r[0]+n.x*u[0],e=r[1]+n.y*u[1],o=r[0]+u[0]/2,s=r[1]+u[1]/2;return Math.sqrt(Math.pow(t-f,2)+Math.pow(i-e,2))+Math.sqrt(Math.pow(o-f,2)+Math.pow(s-e,2))},s=n.selector||function(n,t,i,r,u){for(var e,c=i[0]+r[0]/2,l=i[1]+r[1]/2,s=-1,h=1/0,f=0;f<u.length;f++)e=o(u[f],c,l,n,t),e<h&&(s=f+0,h=e);return u[s]};this.compute=function(n){var o=n.xy,h=n.wh,r=n.txy,f=n.twh,t;return this.timestamp=n.timestamp,t=e.getUserDefinedLocation(),null!=t?t:this.locked||null==r||null==f?i.compute(n):(n.timestamp=null,i=s(o,h,r,f,this.anchors),this.x=i.x,this.y=i.y,i!==u&&this.fire("anchorChanged",i),u=i,i.compute(n))};this.getCurrentLocation=function(n){return this.getUserDefinedLocation()||(null!=i?i.getCurrentLocation(n):null)};this.getOrientation=function(n){return null!=i?i.getOrientation(n):[0,0]};this.over=function(n,t){null!=i&&i.over(n,t)};this.out=function(){null!=i&&i.out()};this.getCssClass=function(){return i&&i.getCssClass()||""}};n.extend(t.DynamicAnchor,t.Anchor);i=function(n,i,r,u,f,e){t.Anchors[f]=function(t){var o=t.jsPlumbInstance.makeAnchor([n,i,r,u,0,0],t.elementId,t.jsPlumbInstance);return o.type=f,e&&e(o,t),o}};i(.5,0,0,-1,"TopCenter");i(.5,1,0,1,"BottomCenter");i(0,.5,-1,0,"LeftMiddle");i(1,.5,1,0,"RightMiddle");i(.5,0,0,-1,"Top");i(.5,1,0,1,"Bottom");i(0,.5,-1,0,"Left");i(1,.5,1,0,"Right");i(.5,.5,0,0,"Center");i(1,0,0,-1,"TopRight");i(1,1,0,1,"BottomRight");i(0,0,0,-1,"TopLeft");i(0,1,0,1,"BottomLeft");t.Defaults.DynamicAnchors=function(n){return n.jsPlumbInstance.makeAnchors(["TopCenter","RightMiddle","BottomCenter","LeftMiddle"],n.elementId,n.jsPlumbInstance)};t.Anchors.AutoDefault=function(n){var i=n.jsPlumbInstance.makeDynamicAnchor(t.Defaults.DynamicAnchors(n));return i.type="AutoDefault",i};r=function(n,i){t.Anchors[n]=function(t){var r=t.jsPlumbInstance.makeAnchor(["Continuous",{faces:i}],t.elementId,t.jsPlumbInstance);return r.type=n,r}};t.Anchors.Continuous=function(n){return n.jsPlumbInstance.continuousAnchorFactory.get(n)};r("ContinuousLeft",["left"]);r("ContinuousTop",["top"]);r("ContinuousBottom",["bottom"]);r("ContinuousRight",["right"]);i(0,0,0,0,"Assign",function(n,t){var i=t.position||"Fixed";n.positionFinder=i.constructor===String?t.jsPlumbInstance.AnchorPositionFinders[i]:i;n.constructorParams=t});u.jsPlumbInstance.prototype.AnchorPositionFinders={Fixed:function(n,t,i){return[(n.left-t.left)/i[0],(n.top-t.top)/i[1]]},Grid:function(n,t,i,r){var e=n.left-t.left,o=n.top-t.top,u=i[0]/r.grid[0],f=i[1]/r.grid[1],s=Math.floor(e/u),h=Math.floor(o/f);return[(s*u+u/2)/i[0],(h*f+f/2)/i[1]]}};t.Anchors.Perimeter=function(n){var t,i,r,f;if(n=n||{},t=n.anchorCount||60,i=n.shape,!i)throw new Error("no shape supplied to Perimeter Anchor type");var e=function(){for(var f,e,n=.5,o=2*Math.PI/t,i=0,r=[],u=0;u<t;u++)f=n+n*Math.sin(i),e=n+n*Math.cos(i),r.push([f,e,0,0]),i+=o;return r},o=function(n){for(var i=t/n.length,u=[],f=function(n,r,f,e,o){i=t*o;for(var h=(f-n)/i,c=(e-r)/i,s=0;s<i;s++)u.push([n+h*s,r+c*s,0,0])},r=0;r<n.length;r++)f.apply(null,n[r]);return u},u=function(n){for(var i=[],t=0;t<n.length;t++)i.push([n[t][0],n[t][1],n[t][2],n[t][3],1/n.length]);return o(i)},s=function(){return u([[0,0,1,0],[1,0,1,1],[1,1,0,1],[0,1,0,0]])},h={Circle:e,Ellipse:e,Diamond:function(){return u([[.5,0,1,.5],[1,.5,.5,1],[.5,1,0,.5],[0,.5,.5,0]])},Rectangle:s,Square:s,Triangle:function(){return u([[.5,0,1,1],[1,1,0,1],[0,1,.5,0]])},Path:function(n){for(var f,u,i=n.points,r=[],e=0,t=0;t<i.length-1;t++)f=Math.sqrt(Math.pow(i[t][2]-i[t][0])+Math.pow(i[t][3]-i[t][1])),e+=f,r.push([i[t][0],i[t][1],i[t+1][0],i[t+1][1],f]);for(u=0;u<r.length;u++)r[u][4]=r[u][4]/e;return o(r)}},c=function(n,t){for(var u,f,e=[],r=t/180*Math.PI,i=0;i<n.length;i++)u=n[i][0]-.5,f=n[i][1]-.5,e.push([.5+(u*Math.cos(r)-f*Math.sin(r)),.5+(u*Math.sin(r)+f*Math.cos(r)),n[i][2],n[i][3]]);return e};if(!h[i])throw new Error("Shape ["+i+"] is unknown by Perimeter Anchor type");return r=h[i](n),n.rotation&&(r=c(r,n.rotation)),f=n.jsPlumbInstance.makeDynamicAnchor(r),f.type="Perimeter",f}}.call("undefined"!=typeof window?window:this),function(){"use strict";var r=this,n=r.jsPlumb,t=r.jsPlumbUtil,i=r.Biltong,e,f,u,s,o;n.Segments={AbstractSegment:function(n){this.params=n;this.findClosestPointOnPath=function(){return{d:1/0,x:null,y:null,l:null}};this.getBounds=function(){return{minX:Math.min(n.x1,n.x2),minY:Math.min(n.y1,n.y2),maxX:Math.max(n.x1,n.x2),maxY:Math.max(n.y1,n.y2)}}},Straight:function(t){var s,o,l,r,f,u,e,a=(n.Segments.AbstractSegment.apply(this,arguments),function(){s=Math.sqrt(Math.pow(f-r,2)+Math.pow(e-u,2));o=i.gradient({x:r,y:u},{x:f,y:e});l=-1/o}),h,c;this.type="Straight";this.getLength=function(){return s};this.getGradient=function(){return o};this.getCoordinates=function(){return{x1:r,y1:u,x2:f,y2:e}};this.setCoordinates=function(n){r=n.x1;u=n.y1;f=n.x2;e=n.y2;a()};this.setCoordinates({x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2});this.getBounds=function(){return{minX:Math.min(r,f),minY:Math.min(u,e),maxX:Math.max(r,f),maxY:Math.max(u,e)}};this.pointOnPath=function(n,t){if(0!==n||t){if(1!==n||t){var o=t?n>0?n:s+n:n*s;return i.pointOnLine({x:r,y:u},{x:f,y:e},o)}return{x:f,y:e}}return{x:r,y:u}};this.gradientAtPoint=function(){return o};this.pointAlongPathFrom=function(n,t,o){var s=this.pointOnPath(n,o),h=t<=0?{x:r,y:u}:{x:f,y:e};return t<=0&&Math.abs(t)>1&&(t*=-1),i.pointOnLine(s,h,t)};h=function(n,t,i){return i>=Math.min(n,t)&&i<=Math.max(n,t)};c=function(n,t,i){return Math.abs(i-n)<Math.abs(i-t)?n:t};this.findClosestPointOnPath=function(n,t){var a={d:1/0,x:null,y:null,l:null,x1:r,x2:f,y1:u,y2:e},w;if(0===o)a.y=u,a.x=h(r,f,n)?n:c(r,f,n);else if(o===1/0||o===-(1/0))a.x=r,a.y=h(u,e,t)?t:c(u,e,t);else{var p=u-o*r,b=t-l*n,v=(b-p)/(o-l),y=o*v+p;a.x=h(r,f,v)?v:c(r,f,v);a.y=h(u,e,y)?y:c(u,e,y)}return w=i.lineLength([a.x,a.y],[r,u]),a.d=i.lineLength([n,t],[a.x,a.y]),a.l=w/s,a}},Arc:function(t){var e=(n.Segments.AbstractSegment.apply(this,arguments),function(n,r){return i.theta([t.cx,t.cy],[n,r])}),c=function(n,t){var i,u,f,e;return n.anticlockwise?(i=n.startAngle<n.endAngle?n.startAngle+r:n.startAngle,u=Math.abs(i-n.endAngle),i-u*t):(f=n.endAngle<n.startAngle?n.endAngle+r:n.endAngle,e=Math.abs(f-n.startAngle),n.startAngle+e*t)},r=2*Math.PI,o,u,f;this.radius=t.r;this.anticlockwise=t.ac;this.type="Arc";t.startAngle&&t.endAngle?(this.startAngle=t.startAngle,this.endAngle=t.endAngle,this.x1=t.cx+this.radius*Math.cos(t.startAngle),this.y1=t.cy+this.radius*Math.sin(t.startAngle),this.x2=t.cx+this.radius*Math.cos(t.endAngle),this.y2=t.cy+this.radius*Math.sin(t.endAngle)):(this.startAngle=e(t.x1,t.y1),this.endAngle=e(t.x2,t.y2),this.x1=t.x1,this.y1=t.y1,this.x2=t.x2,this.y2=t.y2);this.endAngle<0&&(this.endAngle+=r);this.startAngle<0&&(this.startAngle+=r);o=this.endAngle<this.startAngle?this.endAngle+r:this.endAngle;this.sweep=Math.abs(o-this.startAngle);this.anticlockwise&&(this.sweep=r-this.sweep);var s=2*Math.PI*this.radius,l=this.sweep/r,h=s*l;this.getLength=function(){return h};this.getBounds=function(){return{minX:t.cx-t.r,maxX:t.cx+t.r,minY:t.cy-t.r,maxY:t.cy+t.r}};u=1e-10;f=function(n){var t=Math.floor(n),i=Math.ceil(n);return n-t<u?t:i-n<u?i:n};this.pointOnPath=function(n,i){if(0===n)return{x:this.x1,y:this.y1,theta:this.startAngle};if(1===n)return{x:this.x2,y:this.y2,theta:this.endAngle};i&&(n/=h);var r=c(this,n),u=t.cx+t.r*Math.cos(r),e=t.cy+t.r*Math.sin(r);return{x:f(u),y:f(e),theta:r}};this.gradientAtPoint=function(n,r){var f=this.pointOnPath(n,r),u=i.normal([t.cx,t.cy],[f.x,f.y]);return this.anticlockwise||u!==1/0&&u!==-(1/0)||(u*=-1),u};this.pointAlongPathFrom=function(n,i,r){var f=this.pointOnPath(n,r),e=i/s*2*Math.PI,o=this.anticlockwise?-1:1,u=f.theta+o*e,h=t.cx+this.radius*Math.cos(u),c=t.cy+this.radius*Math.sin(u);return{x:h,y:c}}},Bezier:function(t){this.curve=[{x:t.x1,y:t.y1},{x:t.cp1x,y:t.cp1y},{x:t.cp2x,y:t.cp2y},{x:t.x2,y:t.y2}];n.Segments.AbstractSegment.apply(this,arguments);this.bounds={minX:Math.min(t.x1,t.x2,t.cp1x,t.cp2x),minY:Math.min(t.y1,t.y2,t.cp1y,t.cp2y),maxX:Math.max(t.x1,t.x2,t.cp1x,t.cp2x),maxY:Math.max(t.y1,t.y2,t.cp1y,t.cp2y)};this.type="Bezier";var i=function(n,t,i){return i&&(t=r.jsBezier.locationAlongCurveFrom(n,t>0?0:1,t)),t};this.pointOnPath=function(n,t){return n=i(this.curve,n,t),r.jsBezier.pointOnCurve(this.curve,n)};this.gradientAtPoint=function(n,t){return n=i(this.curve,n,t),r.jsBezier.gradientAtPoint(this.curve,n)};this.pointAlongPathFrom=function(n,t,u){return n=i(this.curve,n,u),r.jsBezier.pointAlongCurveFrom(this.curve,n,t)};this.getLength=function(){return r.jsBezier.getLength(this.curve)};this.getBounds=function(){return this.bounds}}};n.SegmentRenderer={getPath:function(n){return{Straight:function(){var t=n.getCoordinates();return"M "+t.x1+" "+t.y1+" L "+t.x2+" "+t.y2},Bezier:function(){var t=n.params;return"M "+t.x1+" "+t.y1+" C "+t.cp1x+" "+t.cp1y+" "+t.cp2x+" "+t.cp2y+" "+t.x2+" "+t.y2},Arc:function(){var t=n.params,i=n.sweep>Math.PI?1:0,r=n.anticlockwise?0:1;return"M"+n.x1+" "+n.y1+" A "+n.radius+" "+t.r+" 0 "+i+","+r+" "+n.x2+" "+n.y2}}[n.type]()}};e=function(){this.resetBounds=function(){this.bounds={minX:1/0,minY:1/0,maxX:-(1/0),maxY:-(1/0)}};this.resetBounds()};n.Connectors.AbstractConnector=function(r){var b;e.apply(this,arguments);var u=[],f=0,s=[],p=[],h=r.stub||0,c=t.isArray(h)?h[0]:h,l=t.isArray(h)?h[1]:h,a=r.gap||0,v=t.isArray(a)?a[0]:a,y=t.isArray(a)?a[1]:a,k=null,d=!1,o=null,g=null,nt=r.editable!==!1&&null!=n.ConnectorEditors&&null!=n.ConnectorEditors[this.type],tt=this.setGeometry=function(n,t){d=!t;g=n},it=this.getGeometry=function(){return g};this.getPathData=function(){for(var t="",i=0;i<u.length;i++)t+=n.SegmentRenderer.getPath(u[i]),t+=" ";return t};this.hasBeenEdited=function(){return d};this.isEditing=function(){return null!=this.editor&&this.editor.isActive()};this.setEditable=function(t){return nt=!(!t||null==n.ConnectorEditors||null==n.ConnectorEditors[this.type]||null!=this.overrideSetEditable&&!this.overrideSetEditable())&&t};this.isEditable=function(){return nt};this.findSegmentForPoint=function(n,t){for(var r,i={d:1/0,s:null,x:null,y:null,l:null},f=0;f<u.length;f++)r=u[f].findClosestPointOnPath(n,t),r.d<i.d&&(i.d=r.d,i.l=r.l,i.x=r.x,i.y=r.y,i.s=u[f],i.x1=r.x1,i.x2=r.x2,i.y1=r.y1,i.y2=r.y2,i.index=f);return i};var rt=function(){for(var i,t=0,n=0;n<u.length;n++)i=u[n].getLength(),p[n]=i/f,s[n]=[t,t+=i/f]},w=function(n,t){t&&(n=n>0?n/f:(f+n)/f);for(var r=s.length-1,e=1,i=0;i<s.length;i++)if(s[i][1]>=n){r=i;e=1===n?1:0===n?0:(n-s[i][0])/p[i];break}return{segment:u[r],proportion:e,index:r}},ut=function(t,i,r){if(r.x1!==r.x2||r.y1!==r.y2){var e=new n.Segments[i](r);u.push(e);f+=e.getLength();t.updateBounds(e)}},ft=function(){f=u.length=s.length=p.length=0};return this.setSegments=function(n){k=[];f=0;for(var t=0;t<n.length;t++)k.push(n[t]),f+=n[t].getLength()},this.getLength=function(){return f},b=function(n){var u,k;this.strokeWidth=n.strokeWidth;var tt=i.quadrant(n.sourcePos,n.targetPos),w=n.targetPos[0]<n.sourcePos[0],b=n.targetPos[1]<n.sourcePos[1],it=n.strokeWidth||1,t=n.sourceEndpoint.anchor.getOrientation(n.sourceEndpoint),r=n.targetEndpoint.anchor.getOrientation(n.targetEndpoint),g=w?n.targetPos[0]:n.sourcePos[0],nt=b?n.targetPos[1]:n.sourcePos[1],h=Math.abs(n.targetPos[0]-n.sourcePos[0]),a=Math.abs(n.targetPos[1]-n.sourcePos[1]);(0===t[0]&&0===t[1]||0===r[0]&&0===r[1])&&(u=h>a?0:1,k=[1,0][u],t=[],r=[],t[u]=n.sourcePos[u]>n.targetPos[u]?-1:1,r[u]=n.sourcePos[u]>n.targetPos[u]?1:-1,t[k]=0,r[k]=0);var f=w?h+v*t[0]:v*t[0],e=b?a+v*t[1]:v*t[1],o=w?y*r[0]:h+y*r[0],s=b?y*r[1]:a+y*r[1],d=t[0]*r[0]+t[1]*r[1],p={sx:f,sy:e,tx:o,ty:s,lw:it,xSpan:Math.abs(o-f),ySpan:Math.abs(s-e),mx:(f+o)/2,my:(e+s)/2,so:t,to:r,x:g,y:nt,w:h,h:a,segment:tt,startStubX:f+t[0]*c,startStubY:e+t[1]*c,endStubX:o+r[0]*l,endStubY:s+r[1]*l,isXGreaterThanStubTimes2:Math.abs(f-o)>c+l,isYGreaterThanStubTimes2:Math.abs(e-s)>c+l,opposite:d===-1,perpendicular:0===d,orthogonal:1===d,sourceAxis:0===t[0]?"y":"x",points:[g,nt,h,a,f,e,o,s]};return p.anchorOrientation=p.opposite?"opposite":p.orthogonal?"orthogonal":"perpendicular",p},this.getSegments=function(){return u},this.updateBounds=function(n){var t=n.getBounds();this.bounds.minX=Math.min(this.bounds.minX,t.minX);this.bounds.maxX=Math.max(this.bounds.maxX,t.maxX);this.bounds.minY=Math.min(this.bounds.minY,t.minY);this.bounds.maxY=Math.max(this.bounds.maxY,t.maxY)},this.pointOnPath=function(n,t){var i=w(n,t);return i.segment&&i.segment.pointOnPath(i.proportion,!1)||[0,0]},this.gradientAtPoint=function(n,t){var i=w(n,t);return i.segment&&i.segment.gradientAtPoint(i.proportion,!1)||0},this.pointAlongPathFrom=function(n,t,i){var r=w(n,i);return r.segment&&r.segment.pointAlongPathFrom(r.proportion,t,!1)||[0,0]},this.compute=function(n){o=b.call(this,n);ft();this._compute(o,n);this.x=o.points[0];this.y=o.points[1];this.w=o.points[2];this.h=o.points[3];this.segment=o.segment;rt()},{addSegment:ut,prepareCompute:b,sourceStub:c,targetStub:l,maxStub:Math.max(c,l),sourceGap:v,targetGap:y,maxGap:Math.max(v,y),setGeometry:tt,getGeometry:it}};t.extend(n.Connectors.AbstractConnector,e);n.Endpoints.AbstractEndpoint=function(n){e.apply(this,arguments);var t=this.compute=function(){var n=this._compute.apply(this,arguments);return this.x=n[0],this.y=n[1],this.w=n[2],this.h=n[3],this.bounds.minX=this.x,this.bounds.minY=this.y,this.bounds.maxX=this.x+this.w,this.bounds.maxY=this.y+this.h,n};return{compute:t,cssClass:n.cssClass}};t.extend(n.Endpoints.AbstractEndpoint,e);n.Endpoints.Dot=function(t){this.type="Dot";n.Endpoints.AbstractEndpoint.apply(this,arguments);t=t||{};this.radius=t.radius||10;this.defaultOffset=.5*this.radius;this.defaultInnerRadius=this.radius/3;this._compute=function(n,t,i){var r;this.radius=i.radius||this.radius;var u=n[0]-this.radius,f=n[1]-this.radius,e=2*this.radius,o=2*this.radius;return i.stroke&&(r=i.strokeWidth||1,u-=r,f-=r,e+=2*r,o+=2*r),[u,f,e,o,this.radius]}};t.extend(n.Endpoints.Dot,n.Endpoints.AbstractEndpoint);n.Endpoints.Rectangle=function(t){this.type="Rectangle";n.Endpoints.AbstractEndpoint.apply(this,arguments);t=t||{};this.width=t.width||20;this.height=t.height||20;this._compute=function(n,t,i){var r=i.width||this.width,u=i.height||this.height,f=n[0]-r/2,e=n[1]-u/2;return[f,e,r,u]}};t.extend(n.Endpoints.Rectangle,n.Endpoints.AbstractEndpoint);f=function(){n.jsPlumbUIComponent.apply(this,arguments);this._jsPlumb.displayElements=[]};t.extend(f,n.jsPlumbUIComponent,{getDisplayElements:function(){return this._jsPlumb.displayElements},appendDisplayElement:function(n){this._jsPlumb.displayElements.push(n)}});n.Endpoints.Image=function(i){this.type="Image";f.apply(this,arguments);n.Endpoints.AbstractEndpoint.apply(this,arguments);var u=i.onload,e=i.src||i.url,o=i.cssClass?" "+i.cssClass:"";this._jsPlumb.img=new Image;this._jsPlumb.ready=!1;this._jsPlumb.initialized=!1;this._jsPlumb.deleted=!1;this._jsPlumb.widthToUse=i.width;this._jsPlumb.heightToUse=i.height;this._jsPlumb.endpoint=i.endpoint;this._jsPlumb.img.onload=function(){null!=this._jsPlumb&&(this._jsPlumb.ready=!0,this._jsPlumb.widthToUse=this._jsPlumb.widthToUse||this._jsPlumb.img.width,this._jsPlumb.heightToUse=this._jsPlumb.heightToUse||this._jsPlumb.img.height,u&&u(this))}.bind(this);this._jsPlumb.endpoint.setImage=function(n,t){var i=n.constructor===String?n:n.src;u=t;this._jsPlumb.img.src=i;null!=this.canvas&&this.canvas.setAttribute("src",this._jsPlumb.img.src)}.bind(this);this._jsPlumb.endpoint.setImage(e,u);this._compute=function(n){return this.anchorPoint=n,this._jsPlumb.ready?[n[0]-this._jsPlumb.widthToUse/2,n[1]-this._jsPlumb.heightToUse/2,this._jsPlumb.widthToUse,this._jsPlumb.heightToUse]:[0,0,0,0]};this.canvas=n.createElement("img",{position:"absolute",margin:0,padding:0,outline:0},this._jsPlumb.instance.endpointClass+o);this._jsPlumb.widthToUse&&this.canvas.setAttribute("width",this._jsPlumb.widthToUse);this._jsPlumb.heightToUse&&this.canvas.setAttribute("height",this._jsPlumb.heightToUse);this._jsPlumb.instance.appendElement(this.canvas);this.actuallyPaint=function(){if(!this._jsPlumb.deleted){this._jsPlumb.initialized||(this.canvas.setAttribute("src",this._jsPlumb.img.src),this.appendDisplayElement(this.canvas),this._jsPlumb.initialized=!0);var n=this.anchorPoint[0]-this._jsPlumb.widthToUse/2,i=this.anchorPoint[1]-this._jsPlumb.heightToUse/2;t.sizeElement(this.canvas,n,i,this._jsPlumb.widthToUse,this._jsPlumb.heightToUse)}};this.paint=function(n,t){null!=this._jsPlumb&&(this._jsPlumb.ready?this.actuallyPaint(n,t):r.setTimeout(function(){this.paint(n,t)}.bind(this),200))}};t.extend(n.Endpoints.Image,[f,n.Endpoints.AbstractEndpoint],{cleanup:function(n){n&&(this._jsPlumb.deleted=!0,this.canvas&&this.canvas.parentNode.removeChild(this.canvas),this.canvas=null)}});n.Endpoints.Blank=function(i){n.Endpoints.AbstractEndpoint.apply(this,arguments);this.type="Blank";f.apply(this,arguments);this._compute=function(n){return[n[0],n[1],10,0]};var r=i.cssClass?" "+i.cssClass:"";this.canvas=n.createElement("div",{display:"block",width:"1px",height:"1px",background:"transparent",position:"absolute"},this._jsPlumb.instance.endpointClass+r);this._jsPlumb.instance.appendElement(this.canvas);this.paint=function(){t.sizeElement(this.canvas,this.x,this.y,this.w,this.h)}};t.extend(n.Endpoints.Blank,[n.Endpoints.AbstractEndpoint,f],{cleanup:function(){this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas)}});n.Endpoints.Triangle=function(t){this.type="Triangle";n.Endpoints.AbstractEndpoint.apply(this,arguments);var i=this;t=t||{};t.width=t.width||55;t.height=t.height||55;this.width=t.width;this.height=t.height;this._compute=function(n,t,r){var u=r.width||i.width,f=r.height||i.height,e=n[0]-u/2,o=n[1]-f/2;return[e,o,u,f]}};u=n.Overlays.AbstractOverlay=function(n){this.visible=!0;this.isAppendedAtTopLevel=!0;this.component=n.component;this.loc=null==n.location?.5:n.location;this.endpointLoc=null==n.endpointLocation?[.5,.5]:n.endpointLocation;this.visible=n.visible!==!1};u.prototype={cleanup:function(n){n&&(this.component=null,this.canvas=null,this.endpointLoc=null)},reattach:function(){},setVisible:function(n){this.visible=n;this.component.repaint()},isVisible:function(){return this.visible},hide:function(){this.setVisible(!1)},show:function(){this.setVisible(!0)},incrementLocation:function(n){this.loc+=n;this.component.repaint()},setLocation:function(n){this.loc=n;this.component.repaint()},getLocation:function(){return this.loc},updateFrom:function(){}};n.Overlays.Arrow=function(r){var o;this.type="Arrow";u.apply(this,arguments);this.isAppendedAtTopLevel=!1;r=r||{};o=this;this.length=r.length||20;this.width=r.width||20;this.id=r.id;var f=(r.direction||1)<0?-1:1,e=r.paintStyle||{"stroke-width":1},s=r.foldback||.623;this.computeMaxSize=function(){return 1.5*o.width};this.elementCreated=function(t){if(this.path=t,r.events)for(var i in r.events)n.on(t,i,r.events[i])};this.draw=function(n,r){var u,c,o,h,v,l,a,y,p;if(n.pointAlongPathFrom){t.isString(this.loc)||this.loc>1||this.loc<0?(l=parseInt(this.loc,10),a=this.loc<0?1:0,u=n.pointAlongPathFrom(a,l,!1),c=n.pointAlongPathFrom(a,l-f*this.length/2,!1),o=i.pointOnLine(u,c,this.length)):1===this.loc?(u=n.pointOnPath(this.loc),c=n.pointAlongPathFrom(this.loc,-this.length),o=i.pointOnLine(u,c,this.length),f===-1)&&(y=o,o=u,u=y):0===this.loc?(o=n.pointOnPath(this.loc),c=n.pointAlongPathFrom(this.loc,this.length),u=i.pointOnLine(o,c,this.length),f===-1)&&(p=o,o=u,u=p):(u=n.pointAlongPathFrom(this.loc,f*this.length/2),c=n.pointOnPath(this.loc),o=i.pointOnLine(u,c,this.length));h=i.perpendicularLineTo(u,o,this.width);v=i.pointOnLine(u,o,s*this.length);var w={hxy:u,tail:h,cxy:v},b=e.stroke||r.stroke,k=e.fill||r.stroke,d=e.strokeWidth||r.strokeWidth;return{component:n,d:w,"stroke-width":d,stroke:b,fill:k,minX:Math.min(u.x,h[0].x,h[1].x),maxX:Math.max(u.x,h[0].x,h[1].x),minY:Math.min(u.y,h[0].y,h[1].y),maxY:Math.max(u.y,h[0].y,h[1].y)}}return{component:n,minX:0,maxX:0,minY:0,maxY:0}}};t.extend(n.Overlays.Arrow,u,{updateFrom:function(n){this.length=n.length||this.length;this.width=n.width||this.width;this.direction=null!=n.direction?n.direction:this.direction;this.foldback=n.foldback||this.foldback}});n.Overlays.PlainArrow=function(t){t=t||{};var i=n.extend(t,{foldback:1});n.Overlays.Arrow.call(this,i);this.type="PlainArrow"};t.extend(n.Overlays.PlainArrow,n.Overlays.Arrow);n.Overlays.Diamond=function(t){t=t||{};var i=t.length||40,r=n.extend(t,{length:i/2,foldback:2});n.Overlays.Arrow.call(this,r);this.type="Diamond"};t.extend(n.Overlays.Diamond,n.Overlays.Arrow);s=function(n,t){return(null==n._jsPlumb.cachedDimensions||t)&&(n._jsPlumb.cachedDimensions=n.getDimensions()),n._jsPlumb.cachedDimensions};o=function(i){n.jsPlumbUIComponent.apply(this,arguments);u.apply(this,arguments);var r=this.fire;this.fire=function(){r.apply(this,arguments);this.component&&this.component.fire.apply(this.component,arguments)};this.detached=!1;this.id=i.id;this._jsPlumb.div=null;this._jsPlumb.initialised=!1;this._jsPlumb.component=i.component;this._jsPlumb.cachedDimensions=null;this._jsPlumb.create=i.create;this._jsPlumb.initiallyInvisible=i.visible===!1;this.getElement=function(){var t,r;return null==this._jsPlumb.div&&(t=this._jsPlumb.div=n.getElement(this._jsPlumb.create(this._jsPlumb.component)),t.style.position="absolute",t.className=this._jsPlumb.instance.overlayClass+" "+(this.cssClass?this.cssClass:i.cssClass?i.cssClass:""),this._jsPlumb.instance.appendElement(t),this._jsPlumb.instance.getId(t),this.canvas=t,r="translate(-50%, -50%)",t.style.webkitTransform=r,t.style.mozTransform=r,t.style.msTransform=r,t.style.oTransform=r,t.style.transform=r,t._jsPlumb=this,i.visible===!1&&(t.style.display="none")),this._jsPlumb.div};this.draw=function(n,i,r){var u=s(this),f,h,c,l,e,o;return null!=u&&2===u.length?(f={x:0,y:0},r?f={x:r[0],y:r[1]}:n.pointOnPath?(h=this.loc,c=!1,(t.isString(this.loc)||this.loc<0||this.loc>1)&&(h=parseInt(this.loc,10),c=!0),f=n.pointOnPath(h,c)):(l=this.loc.constructor===Array?this.loc:this.endpointLoc,f={x:l[0]*n.w,y:l[1]*n.h}),e=f.x-u[0]/2,o=f.y-u[1]/2,{component:n,d:{minx:e,miny:o,td:u,cxy:f},minX:e,maxX:e+u[0],minY:o,maxY:o+u[1]}):{minX:0,maxX:0,minY:0,maxY:0}}};t.extend(o,[n.jsPlumbUIComponent,u],{getDimensions:function(){return[1,1]},setVisible:function(n){this._jsPlumb.div&&(this._jsPlumb.div.style.display=n?"block":"none",n&&this._jsPlumb.initiallyInvisible&&(s(this,!0),this.component.repaint(),this._jsPlumb.initiallyInvisible=!1))},clearCachedDimensions:function(){this._jsPlumb.cachedDimensions=null},cleanup:function(n){n?null!=this._jsPlumb.div&&(this._jsPlumb.div._jsPlumb=null,this._jsPlumb.instance.removeElement(this._jsPlumb.div)):(this._jsPlumb&&this._jsPlumb.div&&this._jsPlumb.div.parentNode&&this._jsPlumb.div.parentNode.removeChild(this._jsPlumb.div),this.detached=!0)},reattach:function(n){null!=this._jsPlumb.div&&n.getContainer().appendChild(this._jsPlumb.div);this.detached=!1},computeMaxSize:function(){var n=s(this);return Math.max(n[0],n[1])},paint:function(n){this._jsPlumb.initialised||(this.getElement(),n.component.appendDisplayElement(this._jsPlumb.div),this._jsPlumb.initialised=!0,this.detached&&this._jsPlumb.div.parentNode.removeChild(this._jsPlumb.div));this._jsPlumb.div.style.left=n.component.x+n.d.minx+"px";this._jsPlumb.div.style.top=n.component.y+n.d.miny+"px"}});n.Overlays.Custom=function(){this.type="Custom";o.apply(this,arguments)};t.extend(n.Overlays.Custom,o);n.Overlays.GuideLines=function(){var t=this;t.length=50;t.strokeWidth=5;this.type="GuideLines";u.apply(this,arguments);n.jsPlumbUIComponent.apply(this,arguments);this.draw=function(n){var u=n.pointAlongPathFrom(t.loc,t.length/2),e=n.pointOnPath(t.loc),f=i.pointOnLine(u,e,t.length),o=i.perpendicularLineTo(u,f,40),r=i.perpendicularLineTo(f,u,20);return{connector:n,head:u,tail:f,headLine:r,tailLine:o,minX:Math.min(u.x,f.x,r[0].x,r[1].x),minY:Math.min(u.y,f.y,r[0].y,r[1].y),maxX:Math.max(u.x,f.x,r[0].x,r[1].x),maxY:Math.max(u.y,f.y,r[0].y,r[1].y)}}};n.Overlays.Label=function(t){var r,i,u;this.labelStyle=t.labelStyle;this.cssClass=null!=this.labelStyle?this.labelStyle.cssClass:null;r=n.extend({create:function(){return n.createElement("div")}},t);(n.Overlays.Custom.call(this,r),this.type="Label",this.label=t.label||"",this.labelText=null,this.labelStyle)&&(i=this.getElement(),(this.labelStyle.font=this.labelStyle.font||"12px sans-serif",i.style.font=this.labelStyle.font,i.style.color=this.labelStyle.color||"black",this.labelStyle.fill&&(i.style.background=this.labelStyle.fill),this.labelStyle.borderWidth>0)&&(u=this.labelStyle.borderStyle?this.labelStyle.borderStyle:"black",i.style.border=this.labelStyle.borderWidth+"px solid "+u),this.labelStyle.padding&&(i.style.padding=this.labelStyle.padding))};t.extend(n.Overlays.Label,n.Overlays.Custom,{cleanup:function(n){n&&(this.div=null,this.label=null,this.labelText=null,this.cssClass=null,this.labelStyle=null)},getLabel:function(){return this.label},setLabel:function(n){this.label=n;this.labelText=null;this.clearCachedDimensions();this.update();this.component.repaint()},getDimensions:function(){return this.update(),o.prototype.getDimensions.apply(this,arguments)},update:function(){if("function"==typeof this.label){var n=this.label(this);this.getElement().innerHTML=n.replace(/\r\n/g,"<br/>")}else null==this.labelText&&(this.labelText=this.label,this.getElement().innerHTML=this.labelText.replace(/\r\n/g,"<br/>"))},updateFrom:function(n){null!=n.label&&this.setLabel(n.label)}})}.call("undefined"!=typeof window?window:this),function(){"use strict";var n=this,t=n.jsPlumb,i=function(t){var i=t._mottle;return i||(i=t._mottle=new n.Mottle),i};t.extend(n.jsPlumbInstance.prototype,{getEventManager:function(){return i(this)},on:function(){return this.getEventManager().on.apply(this,arguments),this},off:function(){return this.getEventManager().off.apply(this,arguments),this}})}.call("undefined"!=typeof window?window:this),function(){"use strict";var r=this,i=r.jsPlumbUtil,t=r.jsPlumbInstance,e="jtk-group-collapsed",u="jtk-group-expanded",c="[jtk-group-content]",l="elementDraggable",o="stop",s="revert",f="_groupManager",n="_jsPlumbGroup",a="_jsPlumbGroupDrag",h="group:addMember",v="group:removeMember",y="group:add",p="group:remove",w="group:expand",b="group:collapse",k="groupDragStop",d="connectionMoved",g="internal.connectionDetached",nt="removeAll",tt="orphanAll",it="show",rt="hide",ut=function(t){function k(n){delete n.proxies;var r,t=f[n.id];null!=t&&(r=function(t){return t.id===n.id},i.removeWithFunction(t.connections.source,r),i.removeWithFunction(t.connections.target,r),delete f[n.id]);t=o[n.id];null!=t&&(r=function(t){return t.id===n.id},i.removeWithFunction(t.connections.source,r),i.removeWithFunction(t.connections.target,r),delete o[n.id])}function l(n,i){for(var u=n.getMembers(),r=0;r<u.length;r++)t[i?it:rt](u[r],!0)}function c(n){var r=n.getMembers(),e=t.getConnections({source:r},!0),s=t.getConnections({target:r},!0),u={},i;n.connections.source.length=0;n.connections.target.length=0;i=function(t){for(var i=0;i<t.length;i++)u[t[i].id]||(u[t[i].id]=!0,t[i].source._jsPlumbGroup===n?(t[i].target._jsPlumbGroup!==n&&n.connections.source.push(t[i]),f[t[i].id]=n):t[i].target._jsPlumbGroup===n&&(n.connections.target.push(t[i]),o[t[i].id]=n))};i(e);i(s)}var r={},f={},o={},s=this,a,v;t.bind("connection",function(t){null!=t.source[n]&&null!=t.target[n]&&t.source[n]===t.target[n]?(f[t.connection.id]=t.source[n],o[t.connection.id]=t.source[n]):(null!=t.source[n]&&(i.suggest(t.source[n].connections.source,t.connection),f[t.connection.id]=t.source[n]),null!=t.target[n]&&(i.suggest(t.target[n].connections.target,t.connection),o[t.connection.id]=t.target[n]))});t.bind(g,function(n){k(n.connection)});t.bind(d,function(n){var u=0===n.index?f:o,r=u[n.connection.id],t,i;r&&(t=r.connections[0===n.index?"source":"target"],i=t.indexOf(n.connection),i!==-1&&t.splice(i,1))});this.addGroup=function(n){t.addClass(n.getEl(),u);r[n.id]=n;n.manager=this;c(n);t.fire(y,{group:n})};this.addToGroup=function(n,i,r){var e,u,f,c,l,o,a;if(n=this.getGroup(n)){if(e=n.getEl(),i._isJsPlumbGroup)return;u=i._jsPlumbGroup;u!==n&&(f=t.getOffset(i,!0),c=n.collapsed?t.getOffset(e,!0):t.getOffset(n.getDragArea(),!0),null!=u&&(u.remove(i,r),s.updateConnectionsForGroup(u)),n.add(i,r),l=function(t,i){var r=0===i?1:0;t.each(function(t){t.setVisible(!1);t.endpoints[r].element._jsPlumbGroup===n?(t.endpoints[r].setVisible(!1),s.expandConnection(t,r,n)):(t.endpoints[i].setVisible(!1),s.collapseConnection(t,i,n))})},n.collapsed&&(l(t.select({source:i}),0),l(t.select({target:i}),1)),o=t.getId(i),t.dragManager.setParent(i,o,e,t.getId(e),f),a={left:f.left-c.left,top:f.top-c.top},t.setPosition(i,a),t.dragManager.revalidateParent(i,o,f),s.updateConnectionsForGroup(n),t.revalidate(o),setTimeout(function(){t.fire(h,{group:n,el:i})},0))}};this.removeFromGroup=function(n,t,i){n=this.getGroup(n);n&&n.remove(t,null,i)};this.getGroup=function(n){var t=n;if(i.isString(n)&&(t=r[n],null==t))throw new TypeError("No such group ["+n+"]");return t};this.getGroups=function(){var n=[];for(var t in r)n.push(r[t]);return n};this.removeGroup=function(n,i,u,f){n=this.getGroup(n);this.expandGroup(n,!0);n[i?nt:tt](u,f);t.remove(n.getEl());delete r[n.id];delete t._groups[n.id];t.fire(p,{group:n})};this.removeAllGroups=function(n,t,i){for(var u in r)this.removeGroup(r[u],n,t,i)};a=this.collapseConnection=function(i,r,u){var f,e=u.getEl(),o=t.getId(e),h=i.endpoints[r].elementId,s=i.endpoints[0===r?1:0].element;s[n]&&!s[n].shouldProxy()&&s[n].collapsed||(i.proxies=i.proxies||[],f=i.proxies[r]?i.proxies[r].ep:t.addEndpoint(e,{endpoint:u.getEndpoint(i,r),anchor:u.getAnchor(i,r),parameters:{isProxyEndpoint:!0}}),f.setDeleteOnEmpty(!0),i.proxies[r]={ep:f,originalEp:i.endpoints[r]},0===r?t.anchorManager.sourceChanged(h,o,i,e):(t.anchorManager.updateOtherEndpoint(i.endpoints[0].elementId,h,o,i),i.target=e,i.targetId=o),i.proxies[r].originalEp.detachFromConnection(i,null,!0),f.connections=[i],i.endpoints[r]=f,i.setVisible(!0))};this.collapseGroup=function(n){var i,r;(n=this.getGroup(n),null==n||n.collapsed)||(i=n.getEl(),(l(n,!1),n.shouldProxy())&&(r=function(t,i){for(var u,r=0;r<t.length;r++)u=t[r],a(u,i,n)},r(n.connections.source,0),r(n.connections.target,1)),n.collapsed=!0,t.removeClass(i,u),t.addClass(i,e),t.revalidate(i),t.fire(b,{group:n}))};v=this.expandConnection=function(n,i,r){if(null!=n.proxies&&null!=n.proxies[i]){var f=t.getId(r.getEl()),e=n.proxies[i].originalEp.element,u=n.proxies[i].originalEp.elementId;n.endpoints[i]=n.proxies[i].originalEp;0===i?t.anchorManager.sourceChanged(f,u,n,e):(t.anchorManager.updateOtherEndpoint(n.endpoints[0].elementId,f,u,n),n.target=e,n.targetId=u);n.proxies[i].ep.detachFromConnection(n,null);n.proxies[i].originalEp.addConnection(n);delete n.proxies[i]}};this.expandGroup=function(n,i){var r,f;(n=this.getGroup(n),null!=n&&n.collapsed)&&(r=n.getEl(),(l(n,!0),n.shouldProxy())&&(f=function(t,i){for(var u,r=0;r<t.length;r++)u=t[r],v(u,i,n)},f(n.connections.source,0),f(n.connections.target,1)),n.collapsed=!1,t.addClass(r,u),t.removeClass(r,e),t.revalidate(r),this.repaintGroup(n),i||t.fire(w,{group:n}))};this.repaintGroup=function(n){n=this.getGroup(n);for(var r=n.getMembers(),i=0;i<r.length;i++)t.revalidate(r[i])};this.updateConnectionsForGroup=c;this.refreshAllGroups=function(){for(var n in r)c(r[n]),t.dragManager.updateOffsets(t.getId(r[n].getEl()))}},ft=function(t,u){function ot(n){return n.offsetParent}function nt(n,i){var o=ot(n),r=t.getSize(o),u=t.getSize(n),f=i[0],s=f+u[0],e=i[1],h=e+u[1];return s>0&&f<r[0]&&h>0&&e<r[1]}function tt(n){var i=t.getId(n),r=t.getOffset(n);n.parentNode.removeChild(n);t.getContainer().appendChild(n);t.setPosition(n,r);delete n._jsPlumbGroup;ut(n);t.dragManager.clearParent(n,i)}function it(n){if(!nt(n.el,n.pos)){var i=n.el._jsPlumbGroup;y?t.remove(n.el):tt(n.el);i.remove(n.el)}}function rt(n){var i=t.getId(n);t.revalidate(n);t.dragManager.revalidateParent(n,i)}function ut(n){n._katavorioDrag&&((y||w)&&n._katavorioDrag.off(o,it),y||w||!b||(n._katavorioDrag.off(s,rt),n._katavorioDrag.setRevert(null)))}function ft(n){n._katavorioDrag&&((y||w)&&n._katavorioDrag.on(o,it),ht&&n._katavorioDrag.setConstrain(!0),et&&n._katavorioDrag.setUseGhostProxy(!0),y||w||!b||(n._katavorioDrag.on(s,rt),n._katavorioDrag.setRevert(function(n,t){return!nt(n,t)})))}var f=this,p=u.el,d,g;this.getEl=function(){return p};this.id=u.id||i.uuid();p._isJsPlumbGroup=!0;var st=this.getDragArea=function(){var n=t.getSelector(p,c);return n&&n.length>0?n[0]:p},et=u.ghost===!0,ht=et||u.constrain===!0,b=u.revert!==!1,w=u.orphan===!0,y=u.prune===!0,ct=u.dropOverride===!0,lt=u.proxied!==!1,e=[];(this.connections={source:[],target:[],internal:[]},this.getAnchor=function(){return u.anchor||"Continuous"},this.getEndpoint=function(){return u.endpoint||["Dot",{radius:10}]},this.collapsed=!1,u.draggable!==!1)&&(d={stop:function(n){t.fire(k,jsPlumb.extend(n,{group:f}))},scope:a},u.dragOptions&&r.jsPlumb.extend(d,u.dragOptions),t.draggable(u.el,d));u.droppable!==!1&&t.droppable(u.el,{drop:function(n){var i=n.drag.el,r;if(!i._isJsPlumbGroup&&(r=i._jsPlumbGroup,r!==f)){if(null!=r&&r.overrideDrop(i,f))return;t.getGroupManager().addToGroup(f,i,!1)}}});g=function(n,t){for(var r=null==n.nodeType?n:[n],i=0;i<r.length;i++)t(r[i])};this.overrideDrop=function(){return ct&&(b||y||w)};this.add=function(n,i){var r=st();g(n,function(n){if(null!=n._jsPlumbGroup){if(n._jsPlumbGroup===f)return;n._jsPlumbGroup.remove(n,!0,i,!1)}n._jsPlumbGroup=f;e.push(n);t.isAlreadyDraggable(n)&&ft(n);n.parentNode!==r&&r.appendChild(n);i||t.fire(h,{group:f,el:n})});t.getGroupManager().updateConnectionsForGroup(f)};this.remove=function(n,r,u,o){g(n,function(n){if(delete n._jsPlumbGroup,i.removeWithFunction(e,function(t){return t===n}),r)try{f.getDragArea().removeChild(n)}catch(n){jsPlumbUtil.log("Could not remove element from Group "+n)}ut(n);u||t.fire(v,{group:f,el:n})});o||t.getGroupManager().updateConnectionsForGroup(f)};this.removeAll=function(n,i){for(var r=0,u=e.length;r<u;r++)f.remove(e[0],n,i,!0);e.length=0;t.getGroupManager().updateConnectionsForGroup(f)};this.orphanAll=function(){for(var n=0;n<e.length;n++)tt(e[n]);e.length=0};this.getMembers=function(){return e};p[n]=this;t.bind(l,function(n){n.el._jsPlumbGroup===this&&ft(n.el)}.bind(this));this.shouldProxy=function(){return lt};t.getGroupManager().addGroup(this)};t.prototype.addGroup=function(t){var i=this,r;if(i._groups=i._groups||{},null!=i._groups[t.id])throw new TypeError("cannot create Group ["+t.id+"]; a Group with that ID exists");if(null!=t.el[n])throw new TypeError("cannot create Group ["+t.id+"]; the given element is already a Group");return r=new ft(i,t),i._groups[r.id]=r,t.collapsed&&this.collapseGroup(r),r};t.prototype.addToGroup=function(n,t,i){var u=function(t){var r=this.getId(t);this.manage(r,t);this.getGroupManager().addToGroup(n,t,i)}.bind(this),r;if(Array.isArray(t))for(r=0;r<t.length;r++)u(t[r]);else u(t)};t.prototype.removeFromGroup=function(n,t,i){this.getGroupManager().removeFromGroup(n,t,i)};t.prototype.removeGroup=function(n,t,i,r){this.getGroupManager().removeGroup(n,t,i,r)};t.prototype.removeAllGroups=function(n,t,i){this.getGroupManager().removeAllGroups(n,t,i)};t.prototype.getGroup=function(n){return this.getGroupManager().getGroup(n)};t.prototype.getGroups=function(){return this.getGroupManager().getGroups()};t.prototype.expandGroup=function(n){this.getGroupManager().expandGroup(n)};t.prototype.collapseGroup=function(n){this.getGroupManager().collapseGroup(n)};t.prototype.repaintGroup=function(n){this.getGroupManager().repaintGroup(n)};t.prototype.toggleGroup=function(n){n=this.getGroupManager().getGroup(n);null!=n&&this.getGroupManager()[n.collapsed?"expandGroup":"collapseGroup"](n)};t.prototype.getGroupManager=function(){var n=this[f];return null==n&&(n=this[f]=new ut(this)),n};t.prototype.removeGroupManager=function(){delete this[f]};t.prototype.getGroupFor=function(t){if(t=this.getElement(t))return t[n]}}.call("undefined"!=typeof window?window:this),function(){"use strict";var t=this,n=t.jsPlumb,r=t.jsPlumbUtil,i=function(t){this.type="Flowchart";t=t||{};t.stub=null==t.stub?30:t.stub;var i,a,r=n.Connectors.AbstractConnector.apply(this,arguments),o=null==t.midpoint?.5:t.midpoint,v=t.alwaysRespectStubs===!0,u=null,f=null,s=null!=t.cornerRadius?t.cornerRadius:0,h=(t.loopbackRadius||25,function(n){return n<0?-1:0===n?0:1}),e=function(n,t,i,r){if(u!==t||f!==i){var e=null==u?r.sx:u,o=null==f?r.sy:f,s=e===t?"v":"h",c=h(t-e),l=h(i-o);u=t;f=i;n.push([e,o,t,i,s,c,l])}},c=function(n){return Math.sqrt(Math.pow(n[0]-n[2],2)+Math.pow(n[1]-n[3],2))},l=function(n){var t=[];return t.push.apply(t,n),t},y=function(n,t,i){for(var f,e,v,y,u=null,o=0;o<t.length-1;o++){if(u=u||l(t[o]),f=l(t[o+1]),s>0&&u[4]!==f[4]){e=Math.min(s,c(u),c(f));u[2]-=u[5]*e;u[3]-=u[6]*e;f[0]+=f[5]*e;f[1]+=f[6]*e;var h=u[6]===f[5]&&1===f[5]||u[6]===f[5]&&0===f[5]&&u[5]!==f[6]||u[6]===f[5]&&f[5]===-1,p=f[1]>u[3]?1:-1,w=f[0]>u[2]?1:-1,a=p===w,b=a&&h||!a&&!h?f[0]:u[2],k=a&&h||!a&&!h?u[3]:f[1];r.addSegment(n,"Straight",{x1:u[0],y1:u[1],x2:u[2],y2:u[3]});r.addSegment(n,"Arc",{r:e,x1:u[2],y1:u[3],x2:f[0],y2:f[1],cx:b,cy:k,ac:h})}else v=u[2]===u[0]?0:u[2]>u[0]?i.lw/2:-(i.lw/2),y=u[3]===u[1]?0:u[3]>u[1]?i.lw/2:-(i.lw/2),r.addSegment(n,"Straight",{x1:u[0]-v,y1:u[1]-y,x2:u[2]+v,y2:u[3]+y});u=f}null!=f&&r.addSegment(n,"Straight",{x1:f[0],y1:f[1],x2:f[2],y2:f[3]})};this._compute=function(n,t){var p;i=[];u=null;f=null;a=null;var b=function(){return[n.startStubX,n.startStubY,n.endStubX,n.endStubY]},g={perpendicular:b,orthogonal:b,opposite:function(t){var i=n,r="x"===t?0:1,u={x:function(){return 1===i.so[r]&&(i.startStubX>i.endStubX&&i.tx>i.startStubX||i.sx>i.endStubX&&i.tx>i.sx)||i.so[r]===-1&&(i.startStubX<i.endStubX&&i.tx<i.startStubX||i.sx<i.endStubX&&i.tx<i.sx)},y:function(){return 1===i.so[r]&&(i.startStubY>i.endStubY&&i.ty>i.startStubY||i.sy>i.endStubY&&i.ty>i.sy)||i.so[r]===-1&&(i.startStubY<i.endStubY&&i.ty<i.startStubY||i.sy<i.endStubY&&i.ty<i.sy)}};return!v&&u[t]()?{x:[(n.sx+n.tx)/2,n.startStubY,(n.sx+n.tx)/2,n.endStubY],y:[n.startStubX,(n.sy+n.ty)/2,n.endStubX,(n.sy+n.ty)/2]}[t]:[n.startStubX,n.startStubY,n.endStubX,n.endStubY]}},s=g[n.anchorOrientation](n.sourceAxis),l="x"===n.sourceAxis?0:1,k="x"===n.sourceAxis?1:0,nt=s[l],tt=s[k],it=s[l+2],rt=s[k+2];e(i,s[0],s[1],n);var h=n.startStubX+(n.endStubX-n.startStubX)*o,c=n.startStubY+(n.endStubY-n.startStubY)*o,d={x:[0,1],y:[1,0]},ut={perpendicular:function(t){var i=n,s={x:[[i.startStubX,i.endStubX],null,[i.endStubX,i.startStubX]],y:[[i.startStubY,i.endStubY],null,[i.endStubY,i.startStubY]]},v={x:[[h,i.startStubY],[h,i.endStubY]],y:[[i.startStubX,c],[i.endStubX,c]]},y={x:[[i.endStubX,i.startStubY]],y:[[i.startStubX,i.endStubY]]},p={x:[[i.startStubX,i.endStubY],[i.endStubX,i.endStubY]],y:[[i.endStubX,i.startStubY],[i.endStubX,i.endStubY]]},w={x:[[i.startStubX,c],[i.endStubX,c],[i.endStubX,i.endStubY]],y:[[h,i.startStubY],[h,i.endStubY],[i.endStubX,i.endStubY]]},u={x:[i.startStubY,i.endStubY],y:[i.startStubX,i.endStubX]},b=d[t][0],f=d[t][1],e=i.so[b]+1,k=i.to[f]+1,o=i.to[f]===-1&&u[t][1]<u[t][0]||1===i.to[f]&&u[t][1]>u[t][0],l=s[t][e][0],a=s[t][e][1],r={x:[[[1,2,3,4],null,[2,1,4,3]],null,[[4,3,2,1],null,[3,4,1,2]]],y:[[[3,2,1,4],null,[2,3,4,1]],null,[[4,1,2,3],null,[1,4,3,2]]]}[t][e][k];return i.segment===r[3]||i.segment===r[2]&&o?v[t]:i.segment===r[2]&&a<l?y[t]:i.segment===r[2]&&a>=l||i.segment===r[1]&&!o?w[t]:i.segment===r[0]||i.segment===r[1]&&o?p[t]:void 0},orthogonal:function(t,i,r,u,f){var o=n,e={x:o.so[0]===-1?Math.min(i,u):Math.max(i,u),y:o.so[1]===-1?Math.min(i,u):Math.max(i,u)}[t];return{x:[[e,r],[e,f],[u,f]],y:[[r,e],[f,e],[f,u]]}[t]},opposite:function(i,u,f,e){var o=n,a={x:"y",y:"x"}[i],v={x:"height",y:"width"}[i],y=o["is"+i.toUpperCase()+"GreaterThanStubTimes2"],s;return t.sourceEndpoint.elementId===t.targetEndpoint.elementId?(s=f+(1-t.sourceEndpoint.anchor[a])*t.sourceInfo[v]+r.maxStub,{x:[[u,s],[e,s]],y:[[s,u],[s,e]]}[i]):!y||1===o.so[l]&&u>e||o.so[l]===-1&&u<e?{x:[[u,c],[e,c]],y:[[h,u],[h,e]]}[i]:1===o.so[l]&&u<e||o.so[l]===-1&&u>e?{x:[[h,o.sy],[h,o.ty]],y:[[o.sx,c],[o.tx,c]]}[i]:void 0}},w=ut[n.anchorOrientation](n.sourceAxis,nt,tt,it,rt);if(w)for(p=0;p<w.length;p++)e(i,w[p][0],w[p][1],n);e(i,s[2],s[3],n);e(i,n.tx,n.ty,n);y(this,i,n)}};r.extend(i,n.Connectors.AbstractConnector);n.registerConnectorType(i,"Flowchart")}.call("undefined"!=typeof window?window:this),function(){"use strict";var i=this,n=i.jsPlumb,r=i.jsPlumbUtil,t;n.Connectors.AbstractBezierConnector=function(t){t=t||{};var u,f=t.showLoopback!==!1,e=(t.curviness||10,t.margin||5),o=(t.proximityLimit||80,t.orientation&&"clockwise"===t.orientation),i=t.loopbackRadius||25,r=!1;return this.overrideSetEditable=function(){return!r},this._compute=function(n,t){var c=t.sourcePos,l=t.targetPos,a=Math.abs(c[0]-l[0]),v=Math.abs(c[1]-l[1]);if(f&&t.sourceEndpoint.elementId===t.targetEndpoint.elementId){r=!0;var y=t.sourcePos[0],p=t.sourcePos[1]-e,w=y,b=p-i,s=w-i,h=b-i;a=2*i;v=2*i;n.points[0]=s;n.points[1]=h;n.points[2]=a;n.points[3]=v;u.addSegment(this,"Arc",{loopback:!0,x1:y-s+4,y1:p-h,startAngle:0,endAngle:2*Math.PI,r:i,ac:!o,x2:y-s-4,y2:p-h,cx:w-s,cy:b-h})}else r=!1,this._computeBezier(n,t,c,l,a,v)},u=n.Connectors.AbstractConnector.apply(this,arguments)};r.extend(n.Connectors.AbstractBezierConnector,n.Connectors.AbstractConnector);t=function(t){t=t||{};this.type="Bezier";var u=n.Connectors.AbstractBezierConnector.apply(this,arguments),r=t.curviness||150,i=10;this.getCurviness=function(){return r};this._findControlPoint=function(n,t,u,f,e,o,s){var c=o[0]!==s[0]||o[1]===s[1],h=[];return c?(0===s[0]?h.push(u[0]<t[0]?n[0]+i:n[0]-i):h.push(n[0]+r*s[0]),0===s[1]?h.push(u[1]<t[1]?n[1]+i:n[1]-i):h.push(n[1]+r*o[1])):(0===o[0]?h.push(t[0]<u[0]?n[0]+i:n[0]-i):h.push(n[0]-r*o[0]),0===o[1]?h.push(t[1]<u[1]?n[1]+i:n[1]-i):h.push(n[1]+r*s[1])),h};this._computeBezier=function(n,t,i,r,f,e){var s,h,o=this.getGeometry(),c=i[0]<r[0]?f:0,l=i[1]<r[1]?e:0,a=i[0]<r[0]?0:f,v=i[1]<r[1]?0:e;(this.hasBeenEdited()||this.isEditing())&&null!=o&&null!=o.controlPoints&&null!=o.controlPoints[0]&&null!=o.controlPoints[1]?(s=o.controlPoints[0],h=o.controlPoints[1]):(s=this._findControlPoint([c,l],i,r,t.sourceEndpoint,t.targetEndpoint,n.so,n.to),h=this._findControlPoint([a,v],r,i,t.targetEndpoint,t.sourceEndpoint,n.to,n.so));u.setGeometry({controlPoints:[s,h]},!0);u.addSegment(this,"Bezier",{x1:c,y1:l,x2:a,y2:v,cp1x:s[0],cp1y:s[1],cp2x:h[0],cp2y:h[1]})}};r.extend(t,n.Connectors.AbstractBezierConnector);n.registerConnectorType(t,"Bezier")}.call("undefined"!=typeof window?window:this),function(){"use strict";var t=this,n=t.jsPlumb,r=t.jsPlumbUtil,u=function(n,t,i,r){return n<=i&&r<=t?1:n<=i&&t<=r?2:i<=n&&r>=t?3:4},f=function(n,t,i,r,u,f,e,o,s){return o<=s?[n,t]:1===i?r[3]<=0&&u[3]>=1?[n+(r[2]<.5?-1*f:f),t]:r[2]>=1&&u[2]<=0?[n,t+(r[3]<.5?-1*e:e)]:[n+-1*f,t+-1*e]:2===i?r[3]>=1&&u[3]<=0?[n+(r[2]<.5?-1*f:f),t]:r[2]>=1&&u[2]<=0?[n,t+(r[3]<.5?-1*e:e)]:[n+f,t+-1*e]:3===i?r[3]>=1&&u[3]<=0?[n+(r[2]<.5?-1*f:f),t]:r[2]<=0&&u[2]>=1?[n,t+(r[3]<.5?-1*e:e)]:[n+-1*f,t+-1*e]:4===i?r[3]<=0&&u[3]>=1?[n+(r[2]<.5?-1*f:f),t]:r[2]<=0&&u[2]>=1?[n,t+(r[3]<.5?-1*e:e)]:[n+f,t+-1*e]:void 0},i=function(t){t=t||{};this.type="StateMachine";var r,e=n.Connectors.AbstractBezierConnector.apply(this,arguments),o=t.curviness||10,i=t.margin||5,s=t.proximityLimit||80;t.orientation&&"clockwise"===t.orientation;this._computeBezier=function(n,t,h,c,l,a){var v=t.sourcePos[0]<t.targetPos[0]?0:l,y=t.sourcePos[1]<t.targetPos[1]?0:a,p=t.sourcePos[0]<t.targetPos[0]?l:0,w=t.sourcePos[1]<t.targetPos[1]?a:0;0===t.sourcePos[2]&&(v-=i);1===t.sourcePos[2]&&(v+=i);0===t.sourcePos[3]&&(y-=i);1===t.sourcePos[3]&&(y+=i);0===t.targetPos[2]&&(p-=i);1===t.targetPos[2]&&(p+=i);0===t.targetPos[3]&&(w-=i);1===t.targetPos[3]&&(w+=i);var k,d,g,nt,tt=(v+p)/2,it=(y+w)/2,rt=u(v,y,p,w),ut=Math.sqrt(Math.pow(p-v,2)+Math.pow(w-y,2)),b=e.getGeometry();(this.hasBeenEdited()||this.isEditing())&&null!=b?(k=b.controlPoints[0][0],g=b.controlPoints[0][1],d=b.controlPoints[1][0],nt=b.controlPoints[1][1]):(r=f(tt,it,rt,t.sourcePos,t.targetPos,o,o,ut,s),k=r[0],d=r[0],g=r[1],nt=r[1],e.setGeometry({controlPoints:[r,r]},!0));e.addSegment(this,"Bezier",{x1:p,y1:w,x2:v,y2:y,cp1x:k,cp1y:g,cp2x:d,cp2y:nt})}};r.extend(i,n.Connectors.AbstractBezierConnector);n.registerConnectorType(i,"StateMachine")}.call("undefined"!=typeof window?window:this),function(){"use strict";var i=this,t=i.jsPlumb,u=i.jsPlumbUtil,n="Straight",r=function(){this.type=n;var i=t.Connectors.AbstractConnector.apply(this,arguments);this._compute=function(t){i.addSegment(this,n,{x1:t.sx,y1:t.sy,x2:t.startStubX,y2:t.startStubY});i.addSegment(this,n,{x1:t.startStubX,y1:t.startStubY,x2:t.endStubX,y2:t.endStubY});i.addSegment(this,n,{x1:t.endStubX,y1:t.endStubY,x2:t.tx,y2:t.ty})}};u.extend(r,t.Connectors.AbstractConnector);t.registerConnectorType(r,n)}.call("undefined"!=typeof window?window:this),function(){"use strict";var l=this,n=l.jsPlumb,i=l.jsPlumbUtil,a={"stroke-linejoin":"stroke-linejoin","stroke-dashoffset":"stroke-dashoffset","stroke-linecap":"stroke-linecap"},o="stroke-dasharray",h="dashstyle",d="linearGradient",g="radialGradient",nt="defs",v="fill",tt="stop",y="stroke",it="stroke-width",rt="style",p="none",ut="jsplumb_gradient_",ft="strokeWidth",w={svg:"http://www.w3.org/2000/svg"},r=function(n,t){for(var i in t)n.setAttribute(i,""+t[i])},t=function(t,i){return i=i||{},i.version="1.1",i.xmlns=w.svg,n.createElementNS(w.svg,t,null,null,i)},s=function(n){return"position:absolute;left:"+n[0]+"px;top:"+n[1]+"px"},b=function(n){for(var i=n.querySelectorAll(" defs,linearGradient,radialGradient"),t=0;t<i.length;t++)i[t].parentNode.removeChild(i[t])},et=function(n,i,r,u,f){var o=ut+f._jsPlumb.instance.idstamp(),s,h,e,c;for(b(n),s=r.gradient.offset?t(g,{id:o}):t(d,{id:o,gradientUnits:"userSpaceOnUse"}),h=t(nt),n.appendChild(h),h.appendChild(s),e=0;e<r.gradient.stops.length;e++){var l=1===f.segment||2===f.segment?e:r.gradient.stops.length-1-e,a=r.gradient.stops[l][1],p=t(tt,{offset:Math.floor(100*r.gradient.stops[e][0])+"%","stop-color":a});s.appendChild(p)}c=r.stroke?y:v;i.setAttribute(c,"url(#"+o+")")},c=function(n,t,i,r,u){var f;if(t.setAttribute(v,i.fill?i.fill:p),t.setAttribute(y,i.stroke?i.stroke:p),i.gradient?et(n,t,i,r,u):(b(n),t.setAttribute(rt,"")),i.strokeWidth&&t.setAttribute(it,i.strokeWidth),i[h]&&i[ft]&&!i[o]){var e=i[h].indexOf(",")===-1?" ":",",c=i[h].split(e),s="";c.forEach(function(n){s+=Math.floor(n*i.strokeWidth)+e});t.setAttribute(o,s)}else i[o]&&t.setAttribute(o,i[o]);for(f in a)i[f]&&t.setAttribute(a[f],i[f])},k=function(n,t,i){n.childNodes.length>i?n.insertBefore(t,n.childNodes[i]):n.appendChild(t)},f,e,u;i.svg={node:t,attr:r,pos:s};f=function(u){var c=u.pointerEventsSpec||"all",o={},f,h,e;return n.jsPlumbUIComponent.apply(this,u.originalArgs),this.canvas=null,this.path=null,this.svg=null,this.bgCanvas=null,f=u.cssClass+" "+(u.originalArgs[0].cssClass||""),h={style:"",width:0,height:0,"pointer-events":c,position:"absolute"},this.svg=t("svg",h),u.useDivWrapper?(this.canvas=n.createElement("div",{position:"absolute"}),i.sizeElement(this.canvas,0,0,1,1),this.canvas.className=f):(r(this.svg,{"class":f}),this.canvas=this.svg),u._jsPlumb.appendElement(this.canvas,u.originalArgs[0].parent),u.useDivWrapper&&this.canvas.appendChild(this.svg),e=[this.canvas],this.getDisplayElements=function(){return e},this.appendDisplayElement=function(n){e.push(n)},this.paint=function(n,t,f){if(null!=n){var c,e=[this.x,this.y],h=[this.w,this.h];null!=f&&(f.xmin<0&&(e[0]+=f.xmin),f.ymin<0&&(e[1]+=f.ymin),h[0]=f.xmax+(f.xmin<0?-f.xmin:0),h[1]=f.ymax+(f.ymin<0?-f.ymin:0));u.useDivWrapper?(i.sizeElement(this.canvas,e[0],e[1],h[0],h[1]),e[0]=0,e[1]=0,c=s([0,0])):c=s([e[0],e[1]]);o.paint.apply(this,arguments);r(this.svg,{style:c,width:h[0]||0,height:h[1]||0})}},{renderer:o}};i.extend(f,n.jsPlumbUIComponent,{cleanup:function(n){n||null==this.typeId?(this.canvas&&(this.canvas._jsPlumb=null),this.svg&&(this.svg._jsPlumb=null),this.bgCanvas&&(this.bgCanvas._jsPlumb=null),this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.bgCanvas&&this.bgCanvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.svg=null,this.canvas=null,this.path=null,this.group=null):(this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.bgCanvas&&this.bgCanvas.parentNode&&this.bgCanvas.parentNode.removeChild(this.bgCanvas))},reattach:function(n){var t=n.getContainer();this.canvas&&null==this.canvas.parentNode&&t.appendChild(this.canvas);this.bgCanvas&&null==this.bgCanvas.parentNode&&t.appendChild(this.bgCanvas)},setVisible:function(n){this.canvas&&(this.canvas.style.display=n?"block":"none")}});n.ConnectorRenderers.svg=function(i){var u=this,e=f.apply(this,[{cssClass:i._jsPlumb.connectorClass+(this.isEditable()?" "+i._jsPlumb.editableConnectorClass:""),originalArgs:arguments,pointerEventsSpec:"none",_jsPlumb:i._jsPlumb}]),o=this.setEditable;this.setEditable=function(t){var i=o.apply(this,[t]);n[i?"addClass":"removeClass"](this.canvas,this._jsPlumb.instance.editableConnectorClass)};e.renderer.paint=function(f,e,o){var w=u.getSegments(),a="",h=[0,0],y,p;if(o.xmin<0&&(h[0]=-o.xmin),o.ymin<0&&(h[1]=-o.ymin),w.length>0){a=u.getPathData();var l={d:a,transform:"translate("+h[0]+","+h[1]+")","pointer-events":i["pointer-events"]||"visibleStroke"},s=null,v=[u.x,u.y,u.w,u.h];f.outlineStroke&&(y=f.outlineWidth||1,p=f.strokeWidth+2*y,s=n.extend({},f),delete s.gradient,s.stroke=f.outlineStroke,s.strokeWidth=p,null==u.bgPath?(u.bgPath=t("path",l),n.addClass(u.bgPath,n.connectorOutlineClass),k(u.svg,u.bgPath,0)):r(u.bgPath,l),c(u.svg,u.bgPath,s,v,u));null==u.path?(u.path=t("path",l),k(u.svg,u.path,f.outlineStroke?1:0)):r(u.path,l);c(u.svg,u.path,f,v,u)}}};i.extend(n.ConnectorRenderers.svg,f);e=n.SvgEndpoint=function(t){var i=f.apply(this,[{cssClass:t._jsPlumb.endpointClass,originalArgs:arguments,pointerEventsSpec:"all",useDivWrapper:!0,_jsPlumb:t._jsPlumb}]);i.renderer.paint=function(t){var i=n.extend({},t);i.outlineStroke&&(i.stroke=i.outlineStroke);null==this.node?(this.node=this.makeNode(i),this.svg.appendChild(this.node)):null!=this.updateNode&&this.updateNode(this.node);c(this.svg,this.node,i,[this.x,this.y,this.w,this.h],this);s(this.node,[this.x,this.y])}.bind(this)};i.extend(e,f);n.Endpoints.svg.Dot=function(){n.Endpoints.Dot.apply(this,arguments);e.apply(this,arguments);this.makeNode=function(){return t("circle",{cx:this.w/2,cy:this.h/2,r:this.radius})};this.updateNode=function(n){r(n,{cx:this.w/2,cy:this.h/2,r:this.radius})}};i.extend(n.Endpoints.svg.Dot,[n.Endpoints.Dot,e]);n.Endpoints.svg.Rectangle=function(){n.Endpoints.Rectangle.apply(this,arguments);e.apply(this,arguments);this.makeNode=function(){return t("rect",{width:this.w,height:this.h})};this.updateNode=function(n){r(n,{width:this.w,height:this.h})}};i.extend(n.Endpoints.svg.Rectangle,[n.Endpoints.Rectangle,e]);n.Endpoints.svg.Image=n.Endpoints.Image;n.Endpoints.svg.Blank=n.Endpoints.Blank;n.Overlays.svg.Label=n.Overlays.Label;n.Overlays.svg.Custom=n.Overlays.Custom;u=function(i,u){i.apply(this,u);n.jsPlumbUIComponent.apply(this,u);this.isAppendedAtTopLevel=!1;this.path=null;this.paint=function(n,i){if(n.component.svg&&i){null==this.path&&(this.path=t("path",{"pointer-events":"all"}),n.component.svg.appendChild(this.path),this.elementCreated&&this.elementCreated(this.path,n.component),this.canvas=n.component.svg);var o=u&&1===u.length?u[0].cssClass||"":"",e=[0,0];i.xmin<0&&(e[0]=-i.xmin);i.ymin<0&&(e[1]=-i.ymin);r(this.path,{d:f(n.d),"class":o,stroke:n.stroke?n.stroke:null,fill:n.fill?n.fill:null,transform:"translate("+e[0]+","+e[1]+")"})}};var f=function(n){return isNaN(n.cxy.x)||isNaN(n.cxy.y)?"":"M"+n.hxy.x+","+n.hxy.y+" L"+n.tail[0].x+","+n.tail[0].y+" L"+n.cxy.x+","+n.cxy.y+" L"+n.tail[1].x+","+n.tail[1].y+" L"+n.hxy.x+","+n.hxy.y};this.transfer=function(n){n.canvas&&this.path&&this.path.parentNode&&(this.path.parentNode.removeChild(this.path),n.canvas.appendChild(this.path))}};i.extend(u,[n.jsPlumbUIComponent,n.Overlays.AbstractOverlay],{cleanup:function(n){null!=this.path&&(n?this._jsPlumb.instance.removeElement(this.path):this.path.parentNode&&this.path.parentNode.removeChild(this.path))},reattach:function(){this.path&&this.canvas&&null==this.path.parentNode&&this.canvas.appendChild(this.path)},setVisible:function(n){null!=this.path&&(this.path.style.display=n?"block":"none")}});n.Overlays.svg.Arrow=function(){u.apply(this,[n.Overlays.Arrow,arguments])};i.extend(n.Overlays.svg.Arrow,[n.Overlays.Arrow,u]);n.Overlays.svg.PlainArrow=function(){u.apply(this,[n.Overlays.PlainArrow,arguments])};i.extend(n.Overlays.svg.PlainArrow,[n.Overlays.PlainArrow,u]);n.Overlays.svg.Diamond=function(){u.apply(this,[n.Overlays.Diamond,arguments])};i.extend(n.Overlays.svg.Diamond,[n.Overlays.Diamond,u]);n.Overlays.svg.GuideLines=function(){var f,e,u=null,i=this,o;n.Overlays.GuideLines.apply(this,arguments);this.paint=function(n,s){null==u&&(u=t("path"),n.connector.svg.appendChild(u),i.attachListeners(u,n.connector),i.attachListeners(u,i),f=t("path"),n.connector.svg.appendChild(f),i.attachListeners(f,n.connector),i.attachListeners(f,i),e=t("path"),n.connector.svg.appendChild(e),i.attachListeners(e,n.connector),i.attachListeners(e,i));var h=[0,0];s.xmin<0&&(h[0]=-s.xmin);s.ymin<0&&(h[1]=-s.ymin);r(u,{d:o(n.head,n.tail),stroke:"red",fill:null,transform:"translate("+h[0]+","+h[1]+")"});r(f,{d:o(n.tailLine[0],n.tailLine[1]),stroke:"blue",fill:null,transform:"translate("+h[0]+","+h[1]+")"});r(e,{d:o(n.headLine[0],n.headLine[1]),stroke:"green",fill:null,transform:"translate("+h[0]+","+h[1]+")"})};o=function(n,t){return"M "+n.x+","+n.y+" L"+t.x+","+t.y}};i.extend(n.Overlays.svg.GuideLines,n.Overlays.GuideLines)}.call("undefined"!=typeof window?window:this),function(){"use strict";var i=this,n=i.jsPlumb,u=i.jsPlumbUtil,f=i.Katavorio,e=i.Biltong,t=function(t,i){i=i||"main";var u="_katavorio_"+i,r=t[u],o=t.getEventManager();return r||(r=new f({bind:o.on,unbind:o.off,getSize:n.getSize,getPosition:function(n,i){var r=t.getOffset(n,i,n._katavorioDrag?n.offsetParent:null);return[r.left,r.top]},setPosition:function(n,t){n.style.left=t[0]+"px";n.style.top=t[1]+"px"},addClass:n.addClass,removeClass:n.removeClass,intersects:e.intersects,indexOf:function(n,t){return n.indexOf(t)},scope:t.getDefaultScope(),css:{noSelect:t.dragSelectClass,droppable:"jtk-droppable",draggable:"jtk-draggable",drag:"jtk-drag",selected:"jtk-drag-selected",active:"jtk-drag-active",hover:"jtk-drag-hover",ghostProxy:"jtk-ghost-proxy"}}),r.setZoom(t.getZoom()),t[u]=r,t.bind("zoom",r.setZoom)),r},o=function(n,t){var i=function(i){if(null!=t[i]){if(u.isString(t[i])){var r=t[i].match(/-=/)?-1:1,f=t[i].substring(2);return n[i]+r*f}return t[i]}return n[i]};return[i("left"),i("top")]},r;n.extend(i.jsPlumbInstance.prototype,{animationSupported:!0,getElement:function(n){return null==n?null:(n="string"==typeof n?n:null!=n.length&&null==n.enctype?n[0]:n,"string"==typeof n?document.getElementById(n):n)},removeElement:function(n){t(this).elementRemoved(n);this.getEventManager().remove(n)},doAnimate:function(t,i,r){r=r||{};var u=this.getOffset(t),h=o(u,i),l=h[0]-u.left,a=h[1]-u.top,s=r.duration||250,e=15,c=s/e,v=e/s*l,y=e/s*a,f=0,p=setInterval(function(){n.setPosition(t,{left:u.left+v*(f+1),top:u.top+y*(f+1)});null!=r.step&&r.step(f,Math.ceil(c));f++;f>=c&&(window.clearInterval(p),null!=r.complete&&r.complete())},e)},destroyDraggable:function(n,i){t(this,i).destroyDraggable(n)},destroyDroppable:function(n,i){t(this,i).destroyDroppable(n)},initDraggable:function(n,i,r){t(this,r).draggable(n,i)},initDroppable:function(n,i,r){t(this,r).droppable(n,i)},isAlreadyDraggable:function(n){return null!=n._katavorioDrag},isDragSupported:function(){return!0},isDropSupported:function(){return!0},isElementDraggable:function(t){return t=n.getElement(t),t._katavorioDrag&&t._katavorioDrag.isEnabled()},getDragObject:function(n){return n[0].drag.getDragElement()},getDragScope:function(n){return n._katavorioDrag&&n._katavorioDrag.scopes.join(" ")||""},getDropEvent:function(n){return n[0].e},getUIPosition:function(n){var t=n[0].el,r,i,u;return null==t.offsetParent?null:(r=n[0].finalPos||n[0].pos,i={left:r[0],top:r[1]},t._katavorioDrag&&t.offsetParent!==this.getContainer()&&(u=this.getOffset(t.offsetParent),i.left+=u.left,i.top+=u.top),i)},setDragFilter:function(n,t,i){n._katavorioDrag&&n._katavorioDrag.setFilter(t,i)},setElementDraggable:function(t,i){t=n.getElement(t);t._katavorioDrag&&t._katavorioDrag.setEnabled(i)},setDragScope:function(n,t){n._katavorioDrag&&n._katavorioDrag.k.setDragScope(n,t)},setDropScope:function(n,t){n._katavorioDrop&&n._katavorioDrop.length>0&&n._katavorioDrop[0].k.setDropScope(n,t)},addToPosse:function(i){var u=Array.prototype.slice.call(arguments,1),r=t(this);n.each(i,function(t){t=[n.getElement(t)];t.push.apply(t,u);r.addToPosse.apply(r,t)})},setPosse:function(i){var u=Array.prototype.slice.call(arguments,1),r=t(this);n.each(i,function(t){t=[n.getElement(t)];t.push.apply(t,u);r.setPosse.apply(r,t)})},removeFromPosse:function(i){var u=Array.prototype.slice.call(arguments,1),r=t(this);n.each(i,function(t){t=[n.getElement(t)];t.push.apply(t,u);r.removeFromPosse.apply(r,t)})},removeFromAllPosses:function(i){var r=t(this);n.each(i,function(t){r.removeFromAllPosses(n.getElement(t))})},setPosseState:function(i,r,u){var f=t(this);n.each(i,function(t){f.setPosseState(n.getElement(t),r,u)})},dragEvents:{start:"start",stop:"stop",drag:"drag",step:"step",over:"over",out:"out",drop:"drop",complete:"complete",beforeStart:"beforeStart"},animEvents:{step:"step",complete:"complete"},stopDrag:function(n){n._katavorioDrag&&n._katavorioDrag.abort()},addToDragSelection:function(n){t(this).select(n)},removeFromDragSelection:function(n){t(this).deselect(n)},clearDragSelection:function(){t(this).deselectAll()},trigger:function(n,t,i,r){this.getEventManager().trigger(n,t,i,r)},doReset:function(){for(var n in this)0===n.indexOf("_katavorio_")&&this[n].reset()}});r=function(n){var t=function(){/complete|loaded|interactive/.test(document.readyState)&&"undefined"!=typeof document.body&&null!=document.body?n():setTimeout(t,9)};t()};r(n.init)}.call("undefined"!=typeof window?window:this),function(){"use strict";var f=this,t=f.Farahey={};"undefined"!=typeof exports&&(exports.Farahey=t);var h=function(n,t,i){for(var u=0,f=n.length,r=-1,e=0;u<f;)if(r=parseInt((u+f)/2),e=i(n[r],t),e<0)u=r+1;else{if(!(e>0))return r;f=r}return u},n=f.Biltong,c=function(n,t,i){var r=h(n,t,i);n.splice(r,0,t)},l=function(t,i){var u=t,r={},f=function(n){if(!r[n[1]]){var t=i(n[2]);r[n[1]]={l:n[0][0],t:n[0][1],w:t[0],h:t[1],center:[n[0][0]+t[0]/2,n[0][1]+t[1]/2]}}return r[n[1]]};this.setOrigin=function(n){u=n;r={}};this.compare=function(t,i){var r=n.lineLength(u,f(t).center),e=n.lineLength(u,f(i).center);return r<e?-1:r==e?0:1}},a=function(n,t,i,r){return n[t]<=r&&r<=n[t]+n[i]},i=[function(n,t){return n.x+n.w-t.x},function(n,t){return n.x-(t.x+t.w)}],r=[function(n,t){return n.y+n.h-t.y},function(n,t){return n.y-(t.y+t.h)}],e=[null,[i[0],r[1]],[i[0],r[0]],[i[1],r[0]],[i[1],r[1]]],v=function(n,t,i,r,u){isNaN(i)&&(i=0);var f,s,o,c=t.y+t.h,l=i==1/0||i==-(1/0)?t.x+t.w/2:(c-r)/i,h=Math.atan(i);return a(t,"x","w",l)?(f=e[u][1](n,t),s=f/Math.sin(h),o=s*Math.cos(h),{left:o,top:f}):(o=e[u][0](n,t),s=o/Math.cos(h),f=s*Math.sin(h),{left:o,top:f})},o=t.calculateSpacingAdjustment=function(t,i){var u=t.center||[t.x+t.w/2,t.y+t.h/2],f=i.center||[i.x+i.w/2,i.y+i.h/2],r=n.gradient(u,f),e=n.quadrant(u,f),o=r==1/0||r==-(1/0)||isNaN(r)?0:u[1]-r*u[0];return v(t,i,r,o,e)},u=t.paddedRectangle=function(n,t,i){return{x:n[0]-i[0],y:n[1]-i[1],w:t[0]+2*i[0],h:t[1]+2*i[1]}},y=function(t,i,r,f,e,s,h,c,l,a,v,y,p){s=s||[0,0];a=a||function(){};v=v||2;var b,w,g=u(s,[1,1],f),nt=1,k=!0,tt={},it=function(n,t,i,r){tt[n]=!0;t[0]+=i;t[1]+=r},d=function(){for(var tt,s=0;s<t.length;s++)if(!y(t[s][1],t[s][2])){var ut=i[t[s][1]],st=t[s][1],et=(t[s][2],r[t[s][1]]),rt=u(ut,et,f);for(!p&&h(t[s][1],t[s][2])&&n.intersects(g,rt)&&(b=o(g,rt),w=e(t[s][1],ut,b),it(st,ut,w.left,w.top)),rt=u(ut,et,f),tt=0;tt<t.length;tt++)if(s!=tt){if(y(t[tt][1],t[tt][2]))continue;if(h(t[tt][1],t[tt][2])){var ft=i[t[tt][1]],ht=r[t[tt][1]],ot=u(ft,ht,f);n.intersects(rt,ot)&&(k=!0,b=o(rt,ot),w=e(t[tt][1],ft,b),it(t[tt][1],ft,w.left,w.top))}}}c&&a();k&&nt<v&&(k=!1,nt++,c?window.setTimeout(d,l):d())};return d(),tt},s=function(n){var t,i,r;if(null==n)return null;if("[object Array]"===Object.prototype.toString.call(n))return t=[],t.push.apply(t,n),t;i=[];for(r in n)i.push(n[r]);return i},p=function(n){var f,tt=n.getPosition,h=n.getSize,a=n.getId,it=n.setPosition,v=n.padding||[20,20],p=n.constrain||function(n,t,i){return i},i=[],r={},e={},t=s(n.elements||[]),u=n.origin||[0,0],rt=n.executeNow,w=(this.getOrigin=function(){return u},n.filter||function(){return!0}),ut=n.exclude||function(){return!1},ft=n.orderByDistanceFromOrigin,o=new l(u,h),et=n.updateOnStep,ot=n.stepInterval||350,b=n.debug,st=function(){var n=document.createElement("div");n.style.position="absolute";n.style.width="10px";n.style.height="10px";n.style.backgroundColor="red";document.body.appendChild(n);f=n},ht=function(n){ft&&0!=i.length?c(i,n,o.compare):i.push(n)},ct=function(n){var u,f,o,s,i;for(u=f=1/0,o=s=-(1/0),i=0;i<n.length;i++){var t=tt(n[i]),c=h(n[i]),l=a(n[i]);r[l]=[t.left,t.top];ht([[t.left,t.top],l,n[i]]);e[l]=c;u=Math.min(u,t.left);f=Math.min(f,t.top);o=Math.max(o,t.left+c[0]);s=Math.max(s,t.top+c[1])}return[u,o,f,s]},k=function(){return o.setOrigin(u),i=[],r={},e={},ct(t)},d=function(n){if(t.length>1){n=n||{};var f=n.filter||w,o=n.padding||v,s=n.iterations,h=n.exclude||ut,c=n.excludeFocus,l=y(i,r,e,o,p,u,f,et,ot,g,s,h,c);g(l)}},g=function(n){for(var u,i=0;i<t.length;i++)u=a(t[i]),n[u]&&it(t[i],{left:r[u][0],top:r[u][1]})},nt=function(n){null!=n&&(u=n,o.setOrigin(n))};return this.execute=function(n,t){nt(n);k();d(t)},this.executeAtCenter=function(n){var t=k();nt([(t[0]+t[1])/2,(t[2]+t[3])/2]);d(n)},this.executeAtEvent=function(t,i){var r=n.container,u=n.getContainerPosition(r),e=t.pageX-u.left+r.scrollLeft,o=t.pageY-u.top+r.scrollTop;b&&(f.style.left=t.pageX+"px",f.style.top=t.pageY+"px");this.execute([e,o],i)},this.setElements=function(n){return t=s(n),this},this.addElement=function(n,i){return null==n||!i&&t.indexOf(n)!==-1||t.push(n),this},this.addElements=function(n,i){if(i)Array.prototype.push.apply(t,n);else for(var r=0;r<n.length;r++)this.addElement(n[r]);return this},this.getElements=function(){return t},this.removeElement=function(n){for(var r=-1,i=0;i<t.length;i++)if(t[i]==n){r=i;break}return r!=-1&&t.splice(r,1),this},this.setPadding=function(n){v=n},this.setConstrain=function(n){p=n},this.setFilter=function(n){w=n},this.reset=function(){t.length=0},b&&st(),rt&&this.execute(),this};t.getInstance=function(n){return new p(n)}}.call("undefined"!=typeof window?window:this),function(){var n=this,w=function(n){return n.length>0?n[n.length-1]:null},s="undefined"!=typeof navigator&&/MSIE\s([\d.]+)/.test(navigator.userAgent)?new Number(RegExp.$1):-1,b=s>-1&&s<9,k=function(n,t,i){var r=function(t,i){for(var u,e=[],r=0;r<t.length;r++)u=h({},t[r]),e.push(u),h(u.atts,i.atts,function(t,i){f(t,i,u,null,n)});return e}.bind(this);this.template=i.template;this.getFunctionBody=function(t){return n.compile(r(n.parse(i.template,null,{originalCustomTag:t.tag,context:t.context}),t),!1,!0,!0)}.bind(this);this.getFunctionEnd=function(){return";_els.pop();"};this.rendered=i.rendered||function(){};this.updated=i.updated||function(){}},d=function(n,t){for(var r,i=0;i<n.length;i++)r=n[i],null!=r&&0!==r.length&&t(i,r)},h=function(n,t,i){for(var r in t)n[r]=t[r],i&&i(r,n[r]);return n},i=function(n,r,u){var s,e,a;if(null==n)return null;if("$data"===r||null==r)return n;if(s=r.match(/^\{(.*)\}$/),s){for(var c={},l=s[1].split(","),h=0;h<l.length;h++)e=l[h].split(":"),a=i(n,e[1]),c[t(e[0])]=a||e[1].replace(/'/g,"");return c}r=r.replace(/\['([^']*)'\]/g,".$1");var v=n,f=v,o=null;return r.replace(/([^\.])+/g,function(n,t,i,r){var h,c,s;if(null==o){var e=n.match(/([^\[0-9]+){1}(\[)([0-9+])/),a=i+n.length>=r.length,l=function(){return f[e[1]]||function(){return f[e[1]]=[],f[e[1]]}()};a?e?(h=l(),c=e[3],null==u?o=h[c]:h[c]=u):null==u?o=f[n]:f[n]=u:e?(s=l(),f=s[e[3]]||function(){return s[e[3]]={},s[e[3]]}()):f=f[n]||function(){return f[n]={},f[n]}()}}),o},g=function(t){var i=n.document.getElementById(t);return null!=i?i.innerHTML:null},c=function(n){return"[object Array]"===Object.prototype.toString.call(n)},u=function(n){for(var t=[],i=0;i<n.length;i++)c(n[i])?t.push.apply(t,u(n[i])):t[t.length]=n[i];return t},nt=function(n,t){for(var r=[],i=0,f=n.length;i<f;i++)r.push(t(n[i]));return u(r)},l=function(n,t){for(var r=[],i=0,u=n.length;i<u;i++)t(n[i])&&r.push(n[i]);return r},t=function(n){if(null==n)return n;for(var t=n.replace(/^\s\s*/,""),i=t.length;/\s/.test(t.charAt(--i)););return t.slice(0,i+1)},a=function(n,t,i,u,f){var o=r(),e={w:t,e:[],u:o},s,h;return f.bindings[o]=e,s=function(){return null!=u?"try {  if("+u+") { out = out.replace(this.e[k][0], eval(this.e[k][1])); } else out=''; } catch(__) { out='';}":"try { out = out.replace(this.e[k][0], eval(this.e[k][1])); } catch(__) { out=out.replace(this.e[k][0], '');}"},h=function(){return null!=u?"var out='';try { with($data) { if ("+u+") out = this.w; else return null; }}catch(_){return null;}":"var out = this.w;"},e.reapply=new Function("$data",h()+"for (var k = 0; k < this.e.length; k++) { with($data) { "+s()+" }} return out;"),i.bindings[n]=e,t.replace(/\$\{([^\}]*)\}/g,function(n,t){e.e.push([n,t])}),o},f=function(n,t,i,r,u){i.atts[n]=t;a(n,t,i,r,u)},tt=function(n,i){function a(n,t){var r=n.match(/([^=]+)=['"](.*)['"]/);return null==r&&null==t?u.atts[n]="":null==r?f(n,"",u,t,i):f(r[1],r[2],u,t,i),r}for(var r,e,l,o,s,h=i.parseAttributes(n),u={el:t(h[0]),atts:{},bindings:{}},c=1;c<h.length;c++)if(r=t(h[c]),null!=r&&r.length>0)if(e=r.match(i.inlineIfRe),e)for(l=e[2].split(i.attributesRe),o=0;o<l.length;o++)s=t(l[o]),null!=s&&s.length>0&&a(s,e[1]);else a(r);return u},r=function(n){var t=n?"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx":"xxxxxxxx-xxxx-4xxx";return t.replace(/[xy]/g,function(n){var t=16*Math.random()|0,i="x"==n?t:3&t|8;return i.toString(16)})},it=function(n){if(null==n||0===n.length)return!1;for(var t=n.length-1;t>-1;t--)if("each"===n[t].type)return!0;return!1},rt=function(n,t){var i=this.bindings[t];return null==i?"":i.reapply(n)},v=function(n,t){this.uuid=r();this.children=[];this.instance=t;t.entries[this.uuid]=this},ut=function(n,t){var i,r,u;v.apply(this,arguments);i=tt(n,t);null!=i.atts["r-toggle"]&&null!=t.toggleManager&&(this.discard=t.toggleManager(i.atts["r-toggle"])===!1);r=i.el.split(":");this.tag=i.el;2===r.length&&(this.namespace=r[0]);this.atts=i.atts;this.bindings=i.bindings;this.type="element";this.compile=function(n,t){var o=n.customTags[this.tag]||n.globalTags[this.tag],i,f,s,r;if(o){for(var e=o.getFunctionBody(this),h=n.customTags[this.tag]?"_rotors.customTags['"+this.tag+"'].rendered(_le, _rotors, data[0]);":"_rotors.globalTags['"+this.tag+"'].rendered(_le, _rotors, data[0]);",u=0;u<this.children.length;u++)this.children[u].precompile&&(e+=this.children[u].precompile(n)),e+=this.children[u].compile(n),this.children[u].postcompile&&(e+=this.children[u].postcompile(n));return e+("_le=_els.pop();"+h+"_rotors.pet(_eid,'"+this.uuid+"');")}if(i="/* element entry "+this.uuid+" */;",this.remove!==!0){i+=n.getExecutionContent(this.tag,this.uuid,!1,this.namespace);for(f in this.atts)this.atts.hasOwnProperty(f)&&(s=null!=this.bindings[f]?"_rotors.bind(data[0], '"+this.bindings[f].u+"');":"'"+this.atts[f]+"'",i+="__a="+s+";if(__a!=null) {_rotors.setAttribute(e,'"+f+"',__a || '');}")}for(r=0;r<this.children.length;r++)this.children[r].precompile&&(i+=this.children[r].precompile(n)),i+=this.children[r].compile(n),this.children[r].postcompile&&(i+=this.children[r].postcompile(n));return this.remove===!0||t||(i+="_le=_els.pop();",i+="_rotors.pet(_eid, '"+this.uuid+"');"),i};u=function(n,i){t.each(i.split(";"),function(t){var i=t.indexOf(":"),r=t.substring(0,i);n.style[r]=t.substring(i+1)})};this.update=function(n,i){var r,f,e;for(r in this.atts)this.atts.hasOwnProperty(r)&&"class"!==r&&(f=null!=this.bindings[r]?this.bindings[r].reapply(i):"'"+this.atts[r]+"'",null!=f&&("style"===r&&null!=n.style?u(n,f):n.setAttribute(r,f)));this.originalCustomTag&&(e=t.customTags[this.originalCustomTag]||t.globalTags[this.originalCustomTag],e&&e.updated(n,i))}},ft=function(n){this.uuid=r();this.comment=n;this.compile=function(){return""}},et=function(n){v.apply(this,arguments);this.value=n.value;this.type="text";this.bindings={};var t=function(){return"_rotors.bind(data[0], '"+this.bindings.__element.u+"', typeof $key !== 'undefined' ? $key : null, typeof $value !== 'undefined' ? $value : null)"}.bind(this);this.compile=function(n){return n.getExecutionContent(t(),this.uuid,!0)+";_rotors.pet(_eid, '"+this.uuid+"');"};this.update=function(n,t){n.nodeValue=this.bindings.__element.reapply(t)}},y=function(){this.childNodes=[];this.appendChild=function(n){this.childNodes.push(n)};this.toString=function(){for(var t="",n=0;n<this.childNodes.length;n++)t+=this.childNodes[n].toString();return t}},ot=function(n){y.apply(this);this.tag=n;var t={};this.setAttribute=function(n,i){t[n]=i};this.getAttribute=function(n){return t[n]};this.setAttributeNS=function(n,i,r){t[n+":"+i]=r};this.toString=function(){var n="<"+this.tag,u="",r,i;for(r in t)u+=" "+r+'="'+t[r]+'"';for(n=n+u+">",i=0;i<this.childNodes.length;i++)n+=this.childNodes[i].toString();return n+"<\/"+this.tag+">"}},st=function(n){this.nodeValue=n;this.toString=function(){return this.nodeValue}},ht=function(n){return n.isBrowser?g:null},p=function(n,t,i){return function(r){var u=i?null:n.cache[r];return null==u&&(u=t(r)),null==u&&(u=n.defaultTemplate),null!=u&&(n.cache[r]=u),u}},e=function(n){n=n||{};this.cache={};this.templateCache={};this.customTags={};null!=n.defaultTemplate&&this.setDefaultTemplate(n.defaultTemplate);this.templateResolver=n.templateResolver?n.templateResolver:n.templates?function(t){return n.templates[t]}:ht(this);this.toggleManager=null},ct=function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};ct(e.prototype,{bindings:{},entries:{},executions:{},bind:rt,defaultTemplate:"<div><\/div>",defaultCompiledTemplate:null,setDefaultTemplate:function(n){null!=n?(this.defaultTemplate=n,this.defaultCompiledTemplate=this.compile(this.parse(n))):this.clearDefaultTemplate()},clearDefaultTemplate:function(){this.defaultTemplate=null;this.defaultCompiledTemplate=null},clearCache:function(){this.cache={};this.templateCache={}},namespaceHandlers:{svg:function(n){return"e = document.createElementNS('http://www.w3.org/2000/svg', '"+n.split(":")[1]+"');e.setAttribute('version', '1.1');e.setAttribute('xmlns', 'http://www.w3.org/1999/xhtml');"}},namespaces:{xlink:"http://www.w3.org/1999/xlink"},each:function(n,t,i,r){var u;if(c(n))for(u=0;u<n.length;u++)t(n[u],i,u,r);else for(u in n)n.hasOwnProperty(u)&&t({$key:u,$value:n[u]},i,u,r)},openRe:new RegExp("<([^/>]*?)>$|<([^/].*[^/])>$"),closeRe:new RegExp("^<\/([^>]+)>"),openCloseRe:new RegExp("<(.*)(/>$)"),tokenizerRe:/(<[^\^>]+\/>)|(<!--[\s\S]*?-->)|(<[\/a-zA-Z0-9\-:]+(?:\s*[a-zA-Z\-]+=\"[^\"]*\"|\s*[a-zA-Z\-]+='[^']+'|\s*[a-zA-Z\-]|\s*\{\{.*\}\})*>)/,commentRe:/<!--[\s\S]*?-->/,attributesRe:/([a-zA-Z0-9\-_:]+="[^"]*")|(\{\{if [^(?:\}\})]+\}\}.*\{\{\/if\}\})/,inlineIfRe:/\{\{if ([^\}]+)\}\}(.*)\{\{\/if\}\}/,singleExpressionRe:/^[\s]*\$\{([^\}]*)\}[\s]*$/,parseAttributes:function(n){return null==n?n:this.filterEmpty(n.replace("/>",">").split(/^<|>$/)[1].split(this.attributesRe))},map:nt,flatten:u,filter:l,data:i,uuid:r,filterEmpty:function(n){return l(n,function(n){return null!=n&&t(n).length>0})},isBrowser:function(){return"undefined"!=typeof navigator}(),isOldIE:function(){return b},cf:function(){return this.isBrowser?this.isOldIE()?n.document.createElement("div"):n.document.createDocumentFragment():new y},ctn:function(t){return this.isBrowser?n.document.createTextNode(t):new st(t)},ce:function(t){return this.isBrowser?n.document.createElement(t):new ot(t)},customElements:{"r-each":{parse:function(n){n.context=n.atts.in;n.type="each"},compile:function(n){var t=function(){var t="function(item, _rotorsLoopId, _rotorsLoopIndex, _rotorsLoopContext) { ",i;for(t+="data.unshift(item);$value=item;$key=_rotorsLoopIndex;",i=0;i<this.children.length;i++)t+=this.children[i].compile(n);return t+="data.splice(0,1);",t+"}"}.bind(this),i=";_rotors.te(null, _eid, '"+this.uuid+"');",r=this.context?';data.unshift(_rotors.data(data[0], "'+this.context+'"));':"",u="_rotors.each(data[0], "+t()+",'"+this.uuid+"', '"+this.context.replace(/'/g,"\\'")+"');",f=this.context?";data.splice(0, 1);":"",e=";_rotors.pet(_eid, '"+this.uuid+"');";return i+r+u+f+e}},"r-if":{parse:function(n){n.test=n.atts.test},compile:function(n){for(var r="",i="",u=this.happyFlowChildren||this.children,t=0;t<u.length;t++)r+=u[t].compile(n)+";";if(null!=this.happyFlowChildren){for(i="else {",t=0;t<this.children.length;t++)i+=this.children[t].compile(n)+";";i+="}"}return";with (data[0]) { if("+this.test+") { "+r+" }"+i+"}"}},"r-else":{remove:!0,parse:function(n,t,i,r,u){var f=o.peek(u);null!=f&&"r-if"===f.tag&&(f.happyFlowChildren=f.children,f.children=[])},compile:function(){}},"r-for":{parse:function(n){n.loop=n.atts.loop},compile:function(n){var t="",i;for(t+="var __limit; with(data[0]){__limit=("+this.loop+");}",t+="for(var $index=0;$index<__limit;$index++){data[0].$index=$index;",i=0;i<this.children.length;i++)t+=this.children[i].compile(n)+";";return t+"}delete data[0].$index;"}},"r-tmpl":{remove:!0,parse:function(n,t,i,r,u,f){var s,h,e,o;if(n.type="template",n.context=n.atts.context,n.atts.lookup)n.lookup=n.atts.lookup,n.default=n.atts.default||"",n.compile=function(){return';with(data[0]){var tlid=eval("'+n.lookup.replace(/[\$\{\}]/g,"")+'");}if (_rotors.templateCache[tlid] == null){var ___t = _rotors.templateResolver(tlid) || _rotors.templateResolver("'+n.default+'");_rotors.templateCache[tlid]=_rotors.compile(_rotors.parse(___t));} eval(_rotors.templateCache[tlid].functionBody);'};else if(n.templateId=n.atts.id,s=it(u),f.indexOf(n.templateId)!==-1){if(!s)throw new TypeError("recursive template call ["+n.templateId+"]");n.compile=function(){return";eval(_rotors.templateCache['"+n.templateId+"'].functionBody);"}}else{for(h=i(n.templateId),f.push(n.templateId),e=r.parse(h,i,null,f),null==r.templateCache[n.templateId]&&(r.templateCache[n.templateId]=r.compile(e)),o=0;o<e.length;o++)e[o].context=n.context;r.debug("nested ast",e);n.children=e;f.pop()}},precompile:function(){return this.context?';data.unshift(_rotors.data(data[0], "'+this.context+'"));':""},postcompile:function(){return this.context?";data.splice(0, 1);":""}},"r-html":{parse:function(){},compile:function(){return";var __hp=_rotors.parse(data[0].value),__hc=_rotors.compile(__hp,true);var __f=__hc(data[0], _rotors);Rotors.peek(_els).appendChild(__f.childNodes[0]);"}}},globalTags:{},registerTag:function(n,t,i){this[i?"globalTags":"customTags"][n]=new k(this,n,t)},setAttribute:function(n,t,i){var r=t.split(":");1===r.length||null==this.namespaces[r[0]]?n.setAttribute(r[0],i):n.setAttributeNS(this.namespaces[r[0]],r[1],i)},setToggleManager:function(n){this.toggleManager=n},debugEnabled:!1,debug:function(){this.debugEnabled&&console.log.apply(console,arguments)},maybeDebug:function(){this.debugEnabled&&arguments[0]&&console.log.apply(console,arguments)},parse:function(n,i,r,u){var l;u=u||[];i=p(this,i||this.templateResolver,null);var f=[],e=[],s=this,b=function(n,t){var i=n.match(t);return null!=i&&i},v=function(){return f.length>0?f[f.length-1]:null},k=function(n){var t=v();return null!=t&&t.tag==n},h=function(n,t){f.length>0&&v().children.push(n);t?0==f.length&&e.push(n):f.push(n)},g=function(n){h(n,!0)},y=function(){var n=f.pop(),t;return 0!==f.length||n.discard?n.discard&&(t=o.peek(f),t&&t.children.pop()):e.push(n),n},w=function(n,t,i,r,u){var e=new ut(n,r),o=r.customElements[e.tag];return o&&(o.parse(e,t,i,r,f,u),o.compile&&(e.compile=o.compile),e.precompile=o.precompile,e.postcompile=o.postcompile,e.custom=!0,e.remove=o.remove,r.debug("  element is a custom element"),r.maybeDebug(e.remove,"  element's root should not appear in output")),e},c=[{re:s.commentRe,handler:function(n,t,i,r){r.debug("comment",n,t);h(new ft(n),!0)}},{re:s.openRe,handler:function(n,t,i,r,u){r.debug("open element",n,t);var f=w(n,t,i,r,u);h(f,f.remove)}},{re:s.closeRe,handler:function(n,t,i,r){r.debug("close element",n,t);var u=r.customElements[t[1]];if(null==u||!u.remove){if(!k(t[1]))throw new TypeError("Unbalanced closing tag '"+t[1]+"'; opening tag was '"+y().tag+"'");y()}}},{re:s.openCloseRe,handler:function(n,t,i,r,u){r.debug("open and close element",n,t);var f=w(n,t,i,r,u);h(f,!0)}},{re:/.*/,handler:function(n,t,i,r){r.debug("text node",n);var u=new et({value:n},r);g(u);a("__element",n,u,null,r)}}];if(d(t(n).split(this.tokenizerRe),function(n,r){for(var e,o=t(r),f=0;f<c.length;f++)if(e=b(o,c[f].re),e){c[f].handler(r,e,i,this,u);break}}.bind(this)),e.length>0&&r)for(l in r)e[0][l]=r[l];return e},compile:function(n,t,i,r){for(var f,e,o,c,s,h=[],u=0;u<n.length;u++)f="",n[u].precompile&&(f+=n[u].precompile(this)),f+=n[u].compile(this,r),n[u].postcompile&&(f+=n[u].postcompile(this)),h.push(f);return(e=h.join(""),this.debug("function body :",e),i)?e:(o=new Function("data,_rotors","data=[data||{}];var frag=_rotors.cf(),_els=[],e,_le,__a,$value,$key,_eid = _rotors.nec();_els.push(frag);"+e+"return frag;"),c=this,t)?o:(s=function(n){return o.apply(this,[n,c])},s.functionBody=e,s)},nec:function(){var n=this.uuid();return this.executions[n]={current:[{children:[]}]},n},te:function(n,t,i,r){var u={el:n,children:[],id:i,index:r},f;this.executions[t].current[0].children.push(u);f=i+(null!=r?"-"+r:"");this.executions[t][f]=u;this.executions[t].current.unshift(u)},pet:function(n){this.executions[n].current=this.executions[n].current.splice(1)},getExecutionContent:function(n,t,i,r){var u=null!=r?this.namespaceHandlers[r](n):i?"e=_rotors.ctn("+n+");":"e=_rotors.ce('"+n+"');";return u+"Rotors.peek(_els).appendChild(e);"+(i?"":"_els.push(e);")+"e._rotors=_rotors.entries['"+t+"'];e._rotorsEid=_eid;if(typeof _rotorsLoopId !== 'undefined') {e._rotorsLoopId=_rotorsLoopId;e._rotorsLoopIndex=_rotorsLoopIndex;e._rotorsLoopContext=_rotorsLoopContext;}_rotors.te(e, _eid, '"+t+"', typeof _rotorsLoopIndex != 'undefined' ? _rotorsLoopIndex : null);"},updaters:{},onUpdate:function(n,t){if(null!=n._rotors){var i=n._rotors.instance;n._RotorsUpdate=n._RotorsUpdate||r();i.updaters[n._RotorsUpdate]=i.updaters[n._RotorsUpdate]||[];i.updaters[n._RotorsUpdate].push(t)}},update:function(n,t){var h,c,i,e=[],l=n._rotorsEid,o,a,s,u,r,f;if(null!=l&&null!=n._rotors)for(i=n._rotors.instance,h=i.executions[l],o=n._rotorsLoopIndex,a=n._rotors.uuid+(null!=o?"-"+o:""),c=h[a],s=function(n,t,r){var u;for(null!=n&&(n._rotors.update(n,t),n._RotorsUpdate&&i.updaters[n._RotorsUpdate]&&e.push([n,i.updaters[n._RotorsUpdate],t])),u=0;u<r.children.length;u++){var f=i.entries[r.children[u].id],o="each"===i.entries[r.id].type,h=o&&null!=r.children[u].el&&null!=r.children[u].el._rotorsLoopIndex?t[r.children[u].el._rotorsLoopIndex]:i.data(t,f.context);s(r.children[u].el,h,r.children[u])}},s(n,t,c),u=0;u<e.length;u++)for(r=e[u],f=0;f<r[1].length;f++)try{r[1][f](r[0],r[2])}catch(n){}},updateExternal:function(n,t){t=t||{};var r,u,f,e=function(n){if(n.nodeType===Node.ELEMENT_NODE){for(var o=0,s=n.attributes.length;o<s;o++)r=n.attributes[o],"rotors"===r.name?(u=r.value,n.innerHTML=i(t,u)):0===r.name.indexOf("rotors-")&&(u=r.value,f=r.name.substring(7),n.setAttribute(f,i(t,u)));for(o=0;o<n.childNodes.length;o++)e(n.childNodes[o])}};e(n)},remove:function(n){n._RotorsUpdate&&this.updaters[n._RotorsUpdate]&&delete this.updaters[n._RotorsUpdate];n._rotorsEid&&this.executions[n._rotorsEid]&&delete this.executions[n._rotorsEid]},template:function(n,t,i,r){var u,o=r?null:this.templateCache[n],f,s,e;return null!=o?(u=o(t),this.isOldIE()?u.childNodes[0]:u):(i=p(this,i||this.templateResolver,r),f=i(n),null!=f)?(s=this.parse(f,i,null,[n]),e=this.compile(s),this.templateCache[n]=e,u=e(t),this.isOldIE()?u.childNodes[0]:u):this.cf()},precompileTemplate:function(n,t){var i=this.parse(n,t||this.templateResolver);return this.compile(i,!0)},precompileTemplates:function(n,t){var u=function(i){var r=n[i];return r||(t||this.templateResolver)(i)},i={};for(var r in n)i[r]=this.precompileTemplate(n[r],u);return i},importTemplate:function(n,t){var i=this;t="string"==typeof t?Function("data","_rotors",t):t;this.templateCache[n]=function(n){return t.apply(i,[n,i])}},importTemplates:function(n){for(var t in n)this.importTemplate(t,n[t])},importBindings:function(n){var i,t;this.bindings=this.bindings||{};for(i in n)t=n[i],this.bindings[i]={e:t.e,u:t.u,w:t.w,reapply:Function("$data",t.reapply)}}});var lt=function(n){return new e(n)},at=function(n){var r={},i,t;for(i in n.bindings)t=n.bindings[i],r[i]={e:t.e,u:t.u,w:t.w,reapply:String(t.reapply).replace(/^function\s*\S+\s*\([^)]*\)\s*\{|\}$/g,"")};return r},vt=function(t,i){var u,f;i=i||"rotors";var e,o=n.Rotors.newInstance(),r={},s=new RegExp("<script type=['\"]"+i+"['\"] id=['\"]([^'\"]+)['\"]>((.*\n)*?)<\/script>","g");e=t.replace(s,function(n,t,i){return r[t]=i,""});u=[{},null,e];for(f in r)u[0][f]=String(o.precompileTemplate(r[f],function(n){return r[n]})).replace(/^function\s*\S+\s*\([^)]*\)\s*\{|\}$/g,"");return u[1]=at(o),u},o=n.Rotors={newInstance:lt,precompile:vt,data:i,version:"0.3.17",peek:w};"undefined"!=typeof exports&&(exports.Rotors=o,exports.RotorsInstance=e)}.call("undefined"!=typeof window?window:this),function(){var n=this,t,i;n.jsPlumbToolkitUtil=n.jsPlumbToolkitUtil||{};t=n.jsPlumbToolkitUtil;i=function(n,t){return function(){return n.apply(t,arguments)}};t.requestAnimationFrame=i(n.requestAnimationFrame||n.webkitRequestAnimationFrame||n.mozRequestAnimationFrame||n.oRequestAnimationFrame||n.msRequestAnimationFrame||function(t){n.setTimeout(t,10)},n);t.ajax=function(n){var t=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),f=n.type||"GET",u,i,r;if(t){u="json"===n.dataType?function(n){return JSON.parse(n)}:function(n){return n};t.open(f,n.url,!0);i=n.headers||{};for(r in i)t.setRequestHeader(r,i[r]);t.onreadystatechange=function(){4===t.readyState&&("2"===(""+t.status)[0]?n.success(u(t.responseText)):n.error&&n.error(t.responseText,t.status))};t.send(n.data?JSON.stringify(n.data):null)}else n.error&&n.error("ajax not supported")};t.debounce=function(n,t){t=t||150;var i=null;return function(){window.clearTimeout(i);i=window.setTimeout(n,t)}};t.xml={setNodeText:function(n,t){n.text=t;try{n.textContent=t}catch(n){}},getNodeText:function(n){return null!=n?n.text||n.textContent:""},getChild:function(n,t){for(var r=null,i=0;i<n.childNodes.length;i++)if(1===n.childNodes[i].nodeType&&n.childNodes[i].nodeName===t){r=n.childNodes[i];break}return r},getChildren:function(n,t){for(var r=[],i=0;i<n.childNodes.length;i++)1===n.childNodes[i].nodeType&&n.childNodes[i].nodeName===t&&r.push(n.childNodes[i]);return r},xmlToString:function(n){try{return(new XMLSerializer).serializeToString(n).replace(/\s*xmlns=\"http\:\/\/www.w3.org\/1999\/xhtml\"/g,"")}catch(t){try{return n.xml}catch(n){throw new Error("Cannot serialize XML "+n);}}return!1},createElement:function(n,t,i){var r,u;try{r=new ActiveXObject("Microsoft.XMLDOM").createNode(1,n,"")}catch(t){r=document.createElement(n)}if(i&&jsPlumbToolkitUtil.xml.setNodeText(r,i),t)for(u in t)r.setAttribute(u,t[u]);return r}}}.call("undefined"!=typeof window?window:this),function(){"use strict";var i=this,n,t;i.jsPlumbToolkitUtil=i.jsPlumbToolkitUtil||{};n=i.jsPlumbToolkitUtil;t=i.jsPlumbUtil;n.fastTrim=function(n){for(var t=n.replace(/^\s\s*/,""),i=t.length;/\s/.test(t.charAt(--i)););return t.slice(0,i+1)};n.uuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=16*Math.random()|0,i="x"==n?t:3&t|8;return i.toString(16)})};n.each=function(n,t){n=null==n.length||"string"==typeof n?[n]:n;for(var i=0;i<n.length;i++)t(n[i])};n.map=function(n,t){for(var r=[],i=0;i<n.length;i++)r.push(t(n[i]));return r};n.populate=function(n,i){var u=function(n){var r=n.match(/(\${.*?})/g),t,u;if(null!=r)for(t=0;t<r.length;t++)u=i[r[t].substring(2,r[t].length-1)],u&&(n=n.replace(r[t],u));return n},r=function(n){var f,i;if(null!=n){if(t.isString(n))return u(n);if(t.isArray(n)){for(f=[],i=0;i<n.length;i++)f.push(r(n[i]));return f}if(t.isObject(n)){f={};for(i in n)f[i]=r(n[i]);return f}return n}};return r(n)};n.mergeWithParents=function(n,i,r){r=r||"parent";var f=function(n){return n?i[n]:null},e=function(n){return n?f(n[r]):null},o=function(n,i){if(null==n)return i;var r=t.merge(n,i);return o(e(n),r)},s=function(n){if(null==n)return{};if("string"==typeof n)return f(n);if(n.length){for(var t,r=!1,i=0;!r&&i<n.length;)t=s(n[i]),t?r=!0:i++;return t}},u=s(n);return u?o(e(u),u):{}};"undefined"!=typeof exports&&(exports.jsPlumbToolkitUtil=n)}.call("undefined"!=typeof window?window:this),function(){var r=this,t=r.jsPlumb,u=r.jsPlumbUtil,i={nodeTraverseStart:"startNodeTraversal",nodeTraverseEnd:"endNodeTraversal",start:"startOverlayAnimation",end:"endOverlayAnimation"},n={nodeTraversing:"jtk-animate-node-traversing",edgeTraversing:"jtk-animate-edge-traversing",nodeTraversable:"jtk-animate-node-traversable",edgeTraversable:"jtk-animate-edge-traversable"};t.Connection.prototype.animateOverlay=function(r,f){var e=this,o=new u.EventGenerator,nt=e.getConnector().getLength(),l;f=f||{};var p,w,a,v=u.uuid(),s=f.forwards!==!1,b=f.rate||30,k=f.dwell||250,tt=f.speed||100,it=nt/tt*1e3,rt=it/b,ut=1/rt*(s?1:-1),ft=f.isFinal!==!1,y=s?0:1,h=y,et=function(){return s?h>=1:h<=0},c=s?e.source:e.target,d=s?e.target:e.source;"string"==typeof r?a=[r,{location:y,id:v}]:(l=t.extend({},r[1]),l.location=y,l.id=v,a=[r[0],l]);var ot=function(){e.removeOverlay(v);window.clearInterval(p);ft?(t.addClass(d,n.nodeTraversing),window.setTimeout(function(){t.removeClass(d,n.nodeTraversing);e.removeClass(n.edgeTraversing);o.fire(i.end,e)},k)):(e.removeClass(n.edgeTraversing),o.fire(i.end,e))},st=function(){h+=ut;et()?ot():(w.loc=h,e.repaint())},ht=function(){o.fire(i.start,e);w=e.addOverlay(a);p=window.setInterval(st,b)},g=function(){o.fire(i.nodeTraverseStart,{connection:e,element:c});t.addClass(c,n.nodeTraversing);e.addClass(n.edgeTraversing);window.setTimeout(function(){t.removeClass(c,n.nodeTraversing);o.fire(i.nodeTraverseEnd,{connection:e,element:c});ht()},k)};return f.previous?f.previous.bind(i.end,g):g(),o}}.call("undefined"==typeof window?this:window),function(){"use strict";var t=this,i=["node","port","edge","group"],r=["Refreshed","Added","Removed","Updated","Moved"],u=["edge"],f=["Source","Target"],n=function(n,t,i,r){for(var f,u=0;u<n.length;u++)for(f=0;f<t.length;f++)i.bind(n[u]+t[f],r)};t.jsPlumbToolkitUtil.AutoSaver=function(t,e,o,s,h,c,l){function v(n){return function(){n&&n.apply(n,arguments);l&&l()}}var a=!1,y=function(){if(!a){try{c&&c()}catch(t){}t.save({url:e,success:v(s),error:v(h),headers:o})}};t.bind("dataLoadStart",function(){a=!0});t.bind("dataLoadEnd",function(){a=!1});t.bind("graphClearStart",function(){a=!0});t.bind("graphCleared",function(){a=!1});n(i,r,t,y);n(u,f,t,y)};t.jsPlumbToolkitUtil.CatchAllEventHandler=function(t){var e=function(){t.fire("dataUpdated")};n(i,r,t,e);n(u,f,t,e)}}.call("undefined"!=typeof window?window:this),function(){var i=this,n=i.jsPlumbToolkitUtil,t=i.jsPlumbUtil;n.Selection=function(i){t.EventGenerator.apply(this,arguments);var a,r=i.toolkit,f=[],o=[],s=[],v=Math.Infinity,y=Math.Infinity,k=Math.Infinity,p=i.generator,u={},e=this,d=i.onClear||function(){},w=function(n){return"Edge"===n.objectType?s:"Node"===n.objectType?f:o},g=function(t){var i=[],r=w(t),f="Edge"===t.objectType?y:"Node"===t.objectType?v:k;if(r.length>=f){if(a===n.Selection.DISCARD_NEW)return!1;i=r.splice(0,1);c(i[0],"Removed");delete u[i[0].getFullId()]}return r.push(t),c(t,"Added"),i},c=function(n,t){var i=n.objectType.toLowerCase()+t,r={Group:{data:n.data,group:n},Node:{data:n.data,node:n},Port:{data:n.data,node:n.node,port:n},Edge:{data:n.data,edge:n}};e.fire(i,r[n.objectType])};this.getModel=r.getModel;this.setSuspendGraph=r.setSuspendGraph;this.getNodeId=r.getNodeId;this.getGroupId=r.getNodeId;this.getEdgeId=r.getEdgeId;this.getPortId=r.getPortId;this.getNodeType=r.getNodeType;this.getGroupType=r.getNodeType;this.getEdgeType=r.getEdgeType;this.getPortType=r.getPortType;this.getObjectInfo=r.getObjectInfo;this.isDebugEnabled=r.isDebugEnabled;var b=function(n,t){if(!u[n.getFullId()]){var i=g(n);return i===!1?[[],[]]:(u[n.getFullId()]=n,t&&t(n,!0),[[n],i])}return[[],[]]},h=function(n,i){var r=t.removeWithFunction(w(n),function(t){return t.id==n.id});return r&&c(n,"Removed"),delete u[n.getFullId()],i&&i(n,!1),[[],[]]},nt=function(n,t){return u[n.getFullId()]?h(n,t):b(n,t)},l=function(n,i,u){var e,o=[],s=[],f;return null==n?o:(f=function(n){var c,h;if(t.isString(n))c=r.getNode(n)||r.getEdge(n)||r.getGroup(n),null!=c&&(e=i(c,u),o.push.apply(o,e[0]),s.push.apply(s,e[1]));else if(n.eachNode&&n.eachEdge)n.eachNode(function(n,t){f(t)}),n.eachEdge(function(n,t){f(t)}),n.eachGroup&&n.eachGroup(function(n,t){f(t)});else if(n.each)n.each(function(n,t){f(t.vertex||t)});else if(null!=n.length)for(h=0;h<n.length;h++)f(n[h],u);else e=i(n,u),o.push.apply(o,e[0]),s.push.apply(s,e[1])},f(n),[o,s])}.bind(this);r.bind("nodeRemoved",function(n){h(n.node)});r.bind("groupRemoved",function(n){h(n.group)});r.bind("portRemoved",function(n){h(n.port)});r.bind("edgeRemoved",function(n){h(n.edge)});r.bind("edgeTarget",function(n){u[n.edge.getFullId()]&&e.fire("edgeTarget",n)});r.bind("edgeSource",function(n){u[n.edge.getFullId()]&&e.fire("edgeSource",n)});r.bind("nodeUpdated",function(n){u[n.node.getFullId()]&&e.fire("nodeUpdated",n)});r.bind("groupUpdated",function(n){u[n.group.getFullId()]&&e.fire("groupUpdated",n)});r.bind("edgeUpdated",function(n){u[n.edge.getFullId()]&&e.fire("edgeUpdated",n)});r.bind("portUpdated",function(n){u[n.port.getFullId()]&&e.fire("portUpdated",n)});this.remove=function(n,t){return l(n,h,t)};this.append=function(n,t){return l(n,b,t)};this.toggle=function(n,t){return l(n,nt,t)};this.setMaxNodes=function(n){v=n};this.setMaxEdges=function(n){y=n};this.setCapacityPolicy=function(n){a=n};this.clear=function(n){f.length=0;s.length=0;o.length=0;u={};n||d(this)};this.reload=function(){if(null!=p){this.clear();var n;for(this.fire("dataLoadStart"),p(this,r),n=0;n<o.length;n++)e.fire("groupAdded",o[n]);for(n=0;n<f.length;n++)e.fire("nodeAdded",f[n]);for(n=0;n<s.length;n++)e.fire("edgeAdded",s[n]);this.fire("dataLoadEnd")}};this.each=function(n,i){for(var u="Edge"===i?s:"Group"===i?o:f,r=0;r<u.length;r++)try{n(r,u[r])}catch(n){t.log("Selection iterator function failed",n)}};this.eachNode=this.each;this.eachGroup=function(n){this.each(n,"Group")};this.eachNodeOrGroup=function(n){this.each(n,"Node");this.each(n,"Group")};this.eachEdge=function(n){this.each(n,"Edge")};this.getNodeCount=function(){return f.length};this.getNodeAt=function(n){return f[n]};this.getNodes=function(){return f};this.getNode=r.getNode;this.getGroupAt=function(n){return o[n]};this.getGroups=function(){return o};this.getGroup=r.getGroup;this.getGroupCount=function(){return o.length};this.getAll=function(){var n=[];return Array.prototype.push.apply(n,f),Array.prototype.push.apply(n,s),Array.prototype.push.apply(n,o),n};this.getAllEdgesFor=function(n){for(var i=n.getAllEdges(),r=[],t=0;t<i.length;t++)null!=u[i[t].getId()]&&r.push(i[t]);return r};this.getEdgeCount=function(){return s.length};this.get=this.getNodeAt=function(n){return f[n]};this.getEdge=this.getEdgeAt=function(n){return s[n]};this.setCapacityPolicy(n.Selection.DISCARD_EXISTING)};n.Selection.DISCARD_EXISTING="discardExisting";n.Selection.DISCARD_NEW="discardNew"}.call("undefined"!=typeof window?window:this),function(){"use strict";var s=this,n=s.jsPlumbGraph={};n.version="0.1";n.name="jsPlumbGraph";var f=function(n,t){var r={},i;this.setAttribute=function(n,t){r[n]=t};this.getAttribute=function(n){return r[n]};i=t.getType(n||{});this.getType=function(){return i};this.setType=function(n){i=n};this.graph=t},e=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=16*Math.random()|0,i="x"==n?t:3&t|8;return i.toString(16)})},i=function(n,t,i){if(null==n)return e();if("string"==typeof n)return n;var r=t||i.getIdFunction();return r(n)||e()},h=function(n){return"string"==typeof n?{id:n}:n},r=n.Vertex=n.Node=function(t,r,u){var s,v,w;f.apply(this,[t,u]);this.objectType="Node";this.id=i(t,r,u);this.data=h(t);this.getFullId=function(){return this.id};var o=[],y=0,p=0,e=[],l=[],a={};this.getEdges=function(n){if(null==n||null==n.filter)return o;for(var i=[],t=0;t<o.length;t++)n.filter(o[t])&&i.push(o[t]);return i};this.getSourceEdges=function(){return this.getEdges({filter:function(n){return n.source==this}.bind(this)})};this.getTargetEdges=function(){return this.getEdges({filter:function(n){return n.target==this}.bind(this)})};this.addEdge=function(n){o.push(n);n.source!==this&&n.isDirected()||p++;n.target!==this&&n.isDirected()||y++};this.deleteEdge=function(n){for(var i=-1,t=0;t<o.length;t++)if(o[t].getId()===n.getId()){i=t;break}return i>-1&&(o.splice(i,1),n.source!==this&&n.isDirected()||p--,n.target!==this&&n.isDirected()||y--,!0)};this.getAllEdges=function(n){for(var t=this.getEdges(n).slice(0),i=0;i<e.length;i++)t.push.apply(t,e[i].getEdges(n));return t};this.addGraph=function(t){return t="string"==typeof t?new n.Graph({id:t}):t,l.push(t),t.id||(t.id=""+l.length),t};this.getGraph=function(n){for(var t=0;t<l.length;t++)if(l[t].id===n)return l[t]};this.getIndegreeCentrality=function(){for(var t=0,n=0;n<e.length;n++)t+=e[n].getIndegreeCentrality();return y+t};this.getOutdegreeCentrality=function(){for(var t=0,n=0;n<e.length;n++)t+=e[n].getOutdegreeCentrality();return p+t};this.getPorts=function(){return e};this.addPort=function(n,t){var f=i(n,t,u),r=this.getPort(f);return null==r&&(r=new c(n,t,this),e.push(r),a[r.id]=r),r};this.setPort=function(n,t){var i=this.getPort(n);return i||(i=this.addPort({id:n})),i.data=t,i.setType(this.graph.getType(t)),i};this.getPort=function(n){return a[n]};s=function(t){return t.constructor==n.Port?t.id:t};this.removePort=function(n){var o;if(n){for(var r=s(n),t=-1,f=!1,i=0;i<e.length;i++)if(e[i].id===r){t=i;break}t!=-1&&(o=e[t],u.deleteVertex(o),e.splice(t,1),f=!0);delete a[r]}return f};v=0;w={};this.setDefaultInternalCost=function(n){v=n};this.getInternalEdge=function(n,t){var f=s(n),e=s(t),i={source:a[f],target:a[e],cost:1/0},r,u;if(i.source&&i.target){r=w[f+"-"+e]||{cost:v,directed:!1};for(u in r)i[u]=r[u]}return i};this.setInternalEdge=function(n,t,i,r){var u=s(n),f=s(t);return w[u+"-"+f]={cost:i||v,directed:r},this.getInternalEdge(n,t)};this.inspect=function(){for(var t="{ id:"+this.id+", edges:[\n",n=0;n<o.length;n++)t+=o[n].inspect()+"\n";return t+"]}"}},c=n.Port=function(n,t,i){r.apply(this,[n,t,i.graph]);this.objectType="Port";this.getNode=function(){return i};this.getFullId=function(){return i.id+this.graph.getPortSeparator()+this.id};this.isChildOf=function(n){return i==n};this.getPorts=this.addPort=this.deletePort=this.getPort=null},l=n.Edge=function(n){f.call(this,n.data,n.graph);this.source=n.source;this.target=n.target;this.objectType="Edge";var i=n.cost||1,r=!(n.directed===!1),t=n.id,u=null;this.data=n.data||{};this.getCost=function(){return i};this.setCost=function(n){i=n};this.getId=this.getFullId=function(){return null===t?this.source.id+"_"+this.target.id:t};this.setId=function(n){t=n};this.isDirected=function(){return r};this.setDirected=function(n){r=n};this.inspect=function(){if(null!=t)return"{ id:"+t+", connectionId:"+u+", cost:"+i+", directed:"+r+", source:"+this.source.id+", target:"+this.target.id+"}"}},a=n.Group=function(n,t,i){r.apply(this,arguments);this.objectType="Group";var u=[],f={};this.addVertex=this.addNode=function(n){return null==f[n.id]&&(u.push(n),f[n.id]=n,n.group=this,!0)};this.getVertexCount=this.getNodeCount=function(){return u.length};this.getVertices=this.getNodes=function(){return u};this.deleteVertex=this.deleteNode=function(n){if(n="string"==typeof n?f[n]:n){var t=u.indexOf(n);t!=-1&&(u.splice(t,1),delete f[n.id]);delete n.group}};this.cleanup=function(n){for(var r=this.getAllDirectEdges(),e=r.length,f,t=0;t<e;t++)i.deleteEdge(r[0]);for(f=u.length,t=0;t<f;t++)n?i.deleteVertex(u[0]):delete u[0].group;u.length=0};this.getAllDirectEdges=function(n){var i,t=[],r;for(t.push.apply(t,this.getEdges(n).slice(0)),r=this.getPorts(),i=0;i<r.length;i++)t.push.apply(t,r[i].getEdges(n));return t};this.getAllEdges=function(n){for(var t=[],r={},i=0;i<u.length;i++)Array.prototype.push.apply(t,u[i].getAllEdges(n).filter(function(n){var t=n.getId(),i=null==r[t];return r[t]=!0,i}));return t.push.apply(t,this.getAllDirectEdges(n)),t}},v=n.Cluster=function(n){this.vertices=[n];this.addVertex=function(n){this.vertices.push(n)}},y=(n.Graph=function(f){var e;f=f||{};this.vertices=[];this.edges=[];this.groups=[];this.id=f.id;var h={},w=0,s={},y=0,o={},tt=0,it=!(f.defaultDirected===!1),rt=f.defaultCost||1,c=f.idFunction||function(n){return n.id},g=f.typeFunction||function(n){return n.type||"default"},nt=f.enableSubgraphs===!0,b=f.portSeparator||".",p={},k=function(n){delete p[n.id]},d=function(n){p[n.id]=n},ut=function(){p={}};this.setIdFunction=function(n){c=n};this.getIdFunction=function(){return c};this.setTypeFunction=function(n){g=n};this.getType=function(n){return g(n)};this.getTopLevelElements=function(){return p};this.setEnableSubgraphs=function(n){nt=n};this.setPortSeparator=function(n){b=n};this.getPortSeparator=function(){return b};e=function(t,i){var e,r,f;if(null==t)return null;if("string"!=typeof t){if(t.constructor==n.Port||t.constructor==n.Node||t.constructor==n.Group)return t;if(e=t,t=c(t),"string"!=typeof t)return e}if(r=nt?t.split("/"):[t],f=function(n){var u;if(h[n])return h[n];if(o[n])return o[n];var t=n.split(b),f=t[0],r=h[f]||o[f];return 2===t.length&&null!=r?(u=r.getPort(t[1]),null==u&&i&&(u=r.addPort(t[1])),u):r},1==r.length)return f(r[0]);if(r.length>1&&r%2==0)throw"Subgraph path format error.";for(var s=null,l=null,u=0;u<r.length-1;u+=2)s=f(r[u]),l=s.getGraph(r[u+1]);return l.getVertex(r[r.length-1])};this.clear=function(){this.vertices.length=0;this.groups.length=0;w=0;y=0;h={};s={};o={};ut()};this.getVertices=this.getNodes=function(){return this.vertices};this.getVertexCount=this.getNodeCount=function(){return this.vertices.length};this.getVertexAt=this.getNodeAt=function(n){return this.vertices[n]};this.getEdgeCount=function(){return y};this.addEdge=function(n,t,r){var c=null==n.directed?it===!0:!(n.directed===!1),a=n.cost||rt,h=i(n.data,t,this),f=e(n.source,!0),o=e(n.target,!0),u;if(null==f||null==f.objectType)throw new TypeError("Unknown source node ["+n.source+"]");if(null==o||null==o.objectType)throw new TypeError("Unknown target node ["+n.target+"]");return r&&!r(f,o)?null:(u=new l({source:f,target:o,cost:a,directed:c,data:n.data||{},id:h,graph:this}),u.source.addEdge(u),u.source!==u.target&&u.target.addEdge(u),s[h]=u,y++,u)};this.addVertex=this.addNode=function(n,t){var i=new r(n,t||c,this);return h[i.id]?null:(this.vertices.push(i),h[i.id]=i,i._id=w++,d(i),i)};this.addVertices=this.addNodes=function(n,t){for(var i=0;i<n.length;i++)this.addVertex(n[i],t||c)};this.addGroup=function(n,t){var i=new a(n,t||c,this);return o[i.id]?o[i.id]:(this.groups.push(i),o[i.id]=i,i._id=tt++,d(i),i)};this.getGroupCount=function(){return this.groups.length};this.getGroupAt=function(n){return this.groups[n]};this.addVertexToGroup=function(n,t){t="string"==typeof t?o[t]:t;n=e(n);n&&t&&(t.addVertex(n),k(n))};this.addVerticesToGroup=function(n,t){for(var i=0;i<n.length;i++)this.addVertexToGroup(n[i],t)};this.deleteVertexFromGroup=function(n){n=e(n);n&&n.group&&(n.group.deleteVertex(n),d(n))};this.deleteVerticesFromGroup=function(n,t){for(var i=0;i<n.length;i++)this.deleteVertexFromGroup(n[i],t)};this.deleteGroup=function(n,t){if(n="string"==typeof n?o[n]:n){n.cleanup(t);delete o[n.id];for(var r=-1,i=0;i<this.groups.length;i++)if(this.groups[i].id===n.id){r=i;break}return r>-1&&this.groups.splice(r,1),k(n),n}};this.getGroup=function(n){return"string"==typeof n?o[n]:n};this.deleteVertex=this.deleteNode=function(n){var t=e(n),r,i,u,f,s,o;if(t){for(r=-1,i=0;i<this.vertices.length;i++)if(this.vertices[i].id===t.id){r=i;break}for(r>-1&&(this.vertices.splice(r,1),null!=t.group&&t.group.deleteVertex(t)),u=t.getEdges(),f=0;f<u.length;f++)this.deleteEdge(u[f]);if(y-=u.length,t.getPorts)for(s=t.getPorts(),o=0;o<s.length;o++)this.deleteVertex(s[o]);delete h[t.id];w--;k(t)}};this.deleteEdge=function(n){var t,i;(n=this.getEdge(n),null!=n)&&(t=e(n.source),t&&t.deleteEdge(n)&&y--,i=e(n.target),i&&i.deleteEdge(n),delete s[n.getId()])};this.getEdge=function(t){if(null!=t){if("string"!=typeof t){if(t.constructor==n.Edge)return t;var i=t;if(t=c(t),"string"!=typeof t)return i}return s[t]}};this.getEdges=function(n){var i,r;n=n||{};var t,u=n.source,f=n.target,c=n.filter||function(){return!0},l=function(n){return!(null!=u&&n.source==i!==u||null!=f&&n.target==i!==f)},o=[],h=function(n){c(n)&&l(n)&&o.push(n)};if(n.node)for(i=e(n.node),r=i.getAllEdges(),t=0;t<r.length;t++)h(r[t]);else for(t in s)h(s[t]);return o};this.getAllEdges=function(){var n=[];for(var t in s)n.push(s[t]);return n};this.findPath=function(n,t,i,r,f){return n=e(n),t=e(t),u.compute({graph:this,source:n,target:t,strict:!(i===!1),nodeFilter:r,edgeFilter:f})};this.getDistance=function(n,t,i){var r=this.findPath(n,t,i);return r.pathDistance};this.getVertex=this.getNode=e;this.setTarget=function(n,t){if(t=e(t),null==t)return{success:!1};var i=n.target;return n.target.deleteEdge(n),n.target=t,t.addEdge(n),{old:i,edge:n,"new":t,success:!0}};this.setSource=function(n,t){if(t=e(t),null==t)return{success:!1};var i=n.source;return n.source.deleteEdge(n),n.source=t,t.addEdge(n),{old:i,edge:n,"new":t,success:!0}};this.printPath=function(n,t){n=e(n);t=e(t);for(var r=this.findPath(n,t).path,u="["+n.id+" - "+t.id+"] : ",i=0;i<r.length;i++)u=u+"{ vertex:"+r[i].vertex.id+", cost:"+r[i].cost+", edge: "+(r[i].edge&&r[i].edge.getId())+" } ";return u};this.getDiameter=function(n){for(var i,f,r=0,t=0;t<this.vertices.length;t++)for(i=0;i<this.vertices.length;i++)if(i!=t)if(f=u.compute({graph:this,source:this.vertices[t],target:this.vertices[i]}),null==f.path||0==f.path.length){if(!n)return 1/0}else r=Math.max(r,f.pathDistance);return r};this.diameter=this.getDiameter;this.getCentrality=function(n){return n=e(n),(n.getIndegreeCentrality()+n.getOutdegreeCentrality())/(this.getVertexCount()-1)};this.getDegreeCentrality=this.getCentrality;this.getIndegreeCentrality=function(n){return n=e(n),n.getIndegreeCentrality()/(this.getVertexCount()-1)};this.getOutdegreeCentrality=function(n){return n=e(n),n.getOutdegreeCentrality()/(this.getVertexCount()-1)};this.getCloseness=function(n){return 1/this.getFarness(n)};this.getFarness=function(n){var t,i,r;n=e(n);t=u.compute({graph:this,source:n,target:n,processAll:!0});i=0;for(r in t.dist)i+=t.dist[r];return i/(this.getVertexCount()-1)};this.getBetweenness=function(n){var c=this.getVertexCount(),v=(c-1)*(c-2)/2,l=0,y=0,a=function(n,t,i,r,u){var o=i.parents[n][t],e,f;if(0==o.length)f=r.slice(),f.unshift(n),u.push(f);else for(e=0;e<o.length;e++)r.indexOf(o[e][0].id)==-1&&(f=r.slice(),f.unshift(o[e][0].id),a(n,o[e][0].id,i,f,u))},u,f,o,i,s,r,h;n=e(n);u=t.compute({graph:this,focus:n});for(f in u.paths)for(o in u.paths[f])if(f!=o){for(i=[],s=0,a(f,o,u,[o],i),r=0;r<i.length;r++)h=i[r].indexOf(n.id),h>0&&h<i[r].length-1&&s++;l+=s/i.length;y+=s}return l/v};this.inspect=function(){for(var t="",n=0;n<this.vertices.length;n++)t+=this.vertices[n].inspect()+"\n";return t};this.serialize=function(){for(var u,t,o,s,e,h,c,n,f,r={nodes:[],edges:[],ports:[],groups:[]},i=0;i<this.vertices.length;i++){for(u=this.vertices[i],r.nodes.push(u.data),t=u.getAllEdges(),o=u.getPorts(),n=0;n<t.length;n++)(t[n].source==u||"Port"===t[n].source.objectType&&t[n].source.getNode()==u)&&(f={source:t[n].source.getFullId(),target:t[n].target.getFullId()},t[n].data&&(f.data=t[n].data),r.edges.push(f));for(e=0;e<o.length;e++){h={};for(c in o[e].data)h[c]=o[e].data[c];h.id=o[e].getFullId();r.ports.push(h)}}for(i=0;i<this.groups.length;i++)for(s=this.groups[i],r.groups.push(s.data),t=s.getEdges(),n=0;n<t.length;n++)t[n].source===s&&(f={source:s.getFullId(),target:t[n].target.getFullId()},t[n].data&&(f.data=t[n].data),r.edges.push(f));return r};this.getClusters=function(){for(var i=[],r={},t=function(n,u){var e,f,o;if(null!=n&&!r[n.id])for(null==u?(u=new v(n),i.push(u)):u.addVertex(n),r[n.id]=!0,e=n.getAllEdges(),f=0;f<e.length;f++)o=e[f].source===n?e[f].target:e[f].source,t(o,u)},n=0;n<this.vertices.length;n++)t(this.vertices[n]);for(n=0;n<this.groups.length;n++)t(this.groups[n]);return i}},function(n,t,i,r,u){for(var e,o=-1,s=null,h=1/0,f=0;f<n.length;f++)t[f]||(e=u(n[f]),e<h&&(h=e,o=f,s=n[f]));return{node:s,index:o}}),o=function(n,t){var i=t.getFullId(),r=n[i];return null==r&&(i=t.getNode?t.getNode().id:t.id,r=n[i]),null==r?null:{p:r,id:i}},p=function(n,t,i,r){for(var e=[],u=r,f=o(t,u);null!=f;)e.splice(0,0,{vertex:u,cost:n[f.id],edge:i[f.id]}),u=f.p,f=o(t,u);return e.splice(0,0,{vertex:u,cost:0,edge:null}),e},t={getPath:function(n,i,r,u){if(n[r.id][u.id]==1/0)return null;var f=i[r.id][u.id];return null==f?" ":t.getPath(n,i,r,f)+" "+f.id+" "+t.getPath(n,i,f,u)},getPaths:function(n,i,r,u){if(n[r.id][u.id]==1/0)return null;var f=i[r.id][u.id];return 0==f.length?" ":t.getPaths(n,i,r,f[0])+" "+f[0].id+" "+t.getPaths(n,i,f[0],u)},compute:function(n){for(var f,i,c=n.graph,a=c.getVertexCount(),t={},o={},r,v,e,u=0;u<a;u++){for(r=c.getVertexAt(u),t[r.id]||(t[r.id]={}),o[r.id]||(o[r.id]={}),t[r.id][r.id]=0,f=0;f<a;f++)u!=f&&(v=c.getVertexAt(f),t[r.id][v.id]||(t[r.id][v.id]=1/0),o[r.id][v.id]||(o[r.id][v.id]=[]));for(e=r.getEdges(),i=0;i<e.length;i++)e[i].source==r?t[r.id][e[i].target.id]=e[i].getCost():(t[e[i].source.id]||(t[e[i].source.id]={},o[e[i].source.id]={}),t[r.id][e[i].source.id]=e[i].getCost())}for(i=0;i<a;i++)for(u=0;u<a;u++)for(f=0;f<a;f++)if(u!=f&&f!=i&&u!=i){var s=c.getVertexAt(u).id,h=c.getVertexAt(f).id,l=c.getVertexAt(i).id;t[s][l]+t[l][h]<=t[s][h]&&t[s][l]+t[l][h]!=1/0&&(t[s][h]=t[s][l]+t[l][h],o[s][h]||(o[s][h]=[]),o[s][h].unshift([c.getVertexAt(i),t[s][h]]))}return{paths:t,parents:o}}},u={compute:function(n){for(var f,l,ut,e,ft,et,t,ht,a=n.graph,u=n.source,i=n.target,tt=n.nodeFilter,it=n.edgeFilter,r={},v={},w={},o={dist:r,previous:v,edges:w,path:[]},ct=n.processAll,b={},rt={},s=!(n.strict===!1),h=function(n){return n.getFullId?n.getFullId():n.id},c=[],g=function(n){var t=rt[n.getFullId()];return b[t.v.id]},k=function(n,t){var u,i;if("Port"===n.objectType){for(r[n.getFullId()]=t,u=g(n),i=0;i<u.length;i++)u[i].p!=n&&(r[u[i].p.getFullId()]=t+n.getNode().getInternalEdge(n,u[i].p).cost);s||(r[n.getNode().id]=t)}else for(r[n.id]=t,u=b[n.id],i=0;i<u.length;i++)r[u[i].p.getFullId()]=t},d=function(n){return tt&&!tt(n)?1/0:r[h(n)]},lt=function(n,t,i){if("Port"===n.objectType){for(var u=g(n),r=0;r<u.length;r++)v[u[r].p.getFullId()]=i.node;s||(v[n.getNode().id]=i.node)}v[t]=i.node},at=function(n,t,i){if("Port"===n.objectType){for(var u=g(n),r=0;r<u.length;r++)w[u[r].p.getFullId()]=i;s||(w[n.getNode().id]=i)}w[t]=i},nt=0;nt<a.vertices.length;nt++)for(f=a.vertices[nt],l=f.getPorts(),c.push(f),ut={v:f,i:c.length-1},b[f.id]=[],k(f,1/0),e=0;e<l.length;e++)c.push(l[e]),rt[l[e].getFullId()]=ut,b[f.id].push({p:l[e],i:c.length-1}),k(l[e],1/0);if(null==u&&(u=a.getVertex(n.sourceId)),null==i&&(i=a.getVertex(n.targetId)),null==u||null==i)return o;ft=u;et=i;u.getNode&&(ft=u.getNode());i.getNode&&(et=i.getNode());k(u,0);for(var ot=new Array(a.vertices.length),st=0,vt=function(n,t,i,r){for(var u,e=0;e<t.length;e++)if(u=t[e],i(u)){var o=r(u),f=o.tp||o.tn,s=h(f),c=d(n.node)+u.getCost(),l=d(f);c<l&&(k(f,c),lt(f,s,n),at(f,s,u))}};st<c.length;){if(t=y(c,ot,r,h,d),ht=t.node?h(t.node):null,!t.node||d(t.node)==1/0)break;if(i&&(ht==h(i)||!s&&t.node.isChildOf&&t.node.isChildOf(i))&&(o.path=p(r,v,w,i,h),o.pathDistance=o.path[o.path.length-1].cost,!ct))break;ot[t.index]=!0;st+=1;vt(t,t.node.getAllEdges(),function(n){return!(it&&!it(n))&&(!n.isDirected()||t.node==n.source||!s&&n.source.isChildOf&&n.source.isChildOf(t.node))},function(n){var i=n.source.getNode?n.source.getNode():n.source,r=n.source.getNode?n.source:null,u=n.target.getNode?n.target.getNode():n.target,f=n.target.getNode?n.target:null;return n.source==t.node||!s&&n.source.isChildOf&&n.source.isChildOf(t.node)?{tn:u,tp:f}:{tn:i,tp:r}})}return o}}}.call("undefined"!=typeof window?window:this),function(){"use strict";var n=this,t=n.jsPlumbUtil,u=n.jsPlumb,i=n.jsPlumbToolkitUtil,r=n.jsPlumbGraph,f="type",e="default",s=function(n){return n.id},o;n.jsPlumbToolkitInstance=function(o){var c,ct,ui,lt,at,g,ut,fi,p,w,v,vt,nt,l,tt,yt,k,ei,b,oi;o=o||{};var a=o.idFunction||s,pt=o.typeProperty||f,wt=o.edgeTypeProperty||f,bt=o.portTypeProperty||f,ft=o.typeFunction||function(n){return n[pt]||e},it=o.edgeIdFunction||a,et=o.edgeTypeFunction||function(n){return n[wt]||e},d=o.portIdFunction||a,kt=o.portTypeFunction||function(n){return n[bt]||e},dt=o.portExtractor,gt=o.portUpdater,h=this,ni=!1,ti=!1,ot=o.model||{},rt=function(n,r,u){r=null!=r&&t.isObject(r)?r:{};r=t.clone(r);r.id=r.id||i.uuid();r.type=r.type||(null==n?null:n.type||n);u(r)},st=o.nodeFactory||rt,ii=o.edgeFactory||rt,ht=o.portFactory||rt,ri=o.groupFactory||rt,si=o.autoSave&&o.saveUrl,hi=o.saveUrl,ci=o.saveHeaders,li=o.onAutoSaveSuccess||function(){},ai=o.onAutoSaveError||function(){},y=o.doNotUpdateOriginalData===!0,vi=o.onBeforeAutoSave||function(){},yi=o.onAfterAutoSave||function(){},pi={portSeparator:o.portSeparator,defaultCost:o.defaultCost,defaultDirected:o.defaultDirected,enableSubgraphs:o.enableSubgraphs},wi=o.createMissingGroups===!0;t.EventGenerator.apply(this,arguments);c=new r.Graph(pi);si&&new i.AutoSaver(this,hi,ci,li,ai,vi,yi);new i.CatchAllEventHandler(this);this.getNodeFactory=function(){return st};this.getGroupFactory=function(){return ri};this.getEdgeFactory=function(){return ii};this.getPortFactory=function(){return ht};this.setNodeFactory=function(n){st=n};this.setGroupFactory=function(n){ri=n};this.setEdgeFactory=function(n){ii=n};this.setPortFactory=function(n){ht=n};this.setDebugEnabled=function(n){ti=n};this.isDebugEnabled=function(){return ti};this.getModel=function(){return ot||{}};ui=function(){return null==ct&&(ct=new n.jsPlumbToolkit.Model(ot||{})),ct};lt=function(n,t){if(null==ot)return!0;var f=this.getType(n),e=this.getType(t),i=ui(),o=n.getNode?n.getNode():n,s=t.getNode?t.getNode():t,r="Node"==n.objectType?i.getNodeDefinition(f):i.getPortDefinition(f),u="Node"==t.objectType?i.getNodeDefinition(e):i.getPortDefinition(e),l=this.getNodeType(o),a=this.getNodeType(s),h=i.getNodeDefinition(l),c=i.getNodeDefinition(a);return!(null!=r.maxConnections&&n.getEdges().length>=r.maxConnections)&&!(null!=u.maxConnections&&t.getEdges().length>=u.maxConnections)&&(n==t?!(h.allowLoopback===!1||r.allowLoopback===!1||u.allowLoopback===!1||c.allowLoopback===!1):o!=s||!(h.allowNodeLoopback===!1||r.allowNodeLoopback===!1||u.allowNodeLoopback===!1||c.allowNodeLoopback===!1))}.bind(this);this.beforeConnect=o.beforeConnect||lt;this.beforeMoveConnection=o.beforeMoveConnection||lt;this.beforeStartConnect=o.beforeStartConnect||function(){return{}};this.beforeDetach=o.beforeDetach||function(){return!0};this.beforeStartDetach=o.beforeStartDetach||function(){return!0};this.setSuspendGraph=function(n){ni=n};this.setDoNotUpdateOriginalData=function(n){y=n};this.getTypeFunction=function(){return ft};this.connect=function(n){var e,r,f,o;if(n=n||{},!ni){var t=c.getVertex(n.source),i=c.getVertex(n.target),s=n.cost,l=n.directed;if(!t){if(n.doNotCreateMissingNodes)return;t=c.addVertex(n.source);h.fire("nodeAdded",{data:{},node:t})}if(!i){if(n.doNotCreateMissingNodes)return;i=c.addVertex(n.target);h.fire("nodeAdded",{data:{},node:i})}r=this.beforeStartConnect(t,et(n.data||{}));r&&(f=n.data||{},"object"==typeof r&&u.extend(f,r),o=this.beforeConnect(t,i,f),o!==!1&&(e=c.addEdge({source:t,target:i,cost:s,directed:l,data:f}),h.fire("edgeAdded",{edge:e})))}return e};this.clear=function(){return this.fire("graphClearStart"),c.clear(),this.fire("graphCleared"),this};this.getGraph=function(){return c};this.getNodeCount=function(){return c.getVertexCount()};this.getNodeAt=function(n){return c.getVertexAt(n)};this.getNodes=function(){return c.getVertices()};this.eachNode=function(n){for(var i,t=0,r=c.getVertexCount();t<r;t++)i=c.getVertexAt(t),n(t,i)};this.eachGroup=function(n){for(var i,t=0,r=c.getGroupCount();t<r;t++)i=c.getGroupAt(t),n(t,i)};this.eachEdge=function(n){for(var i=c.getEdges(),t=0,r=i.length;t<r;t++)n(t,i[t])};this.getEdgeCount=function(){return c.getEdgeCount()};this.getGroupCount=function(){return c.getGroupCount()};this.getGroupAt=function(n){return c.getGroupAt(n)};this.getClusters=function(){return c.getClusters()};this.getNodeId=function(n){return t.isObject(n)?a(n):n};this.getNodeType=function(n){return ft(n)||"default"};this.getEdgeId=function(n){return t.isObject(n)?it(n):n};this.getEdgeType=function(n){return et(n)||"default"};this.getPortId=function(n){return t.isObject(n)?d(n):n};this.getPortType=function(n){return kt(n)||"default"};this.getType=function(n){var t="Node"===n.objectType?ft:"Port"===n.objectType?kt:et;return t(n.data)||"default"};this.setType=function(n,t){var i=this.getType(n),r,u;i!==t&&(r="Node"===n.objectType?pt:"Port"===n.objectType?bt:wt,u=n.objectType.charAt(0).toLowerCase()+n.objectType.substring(1)+"TypeChanged",n.data[r]=t,this.fire(u,{obj:n,previousType:i,newType:t}))};this.addNode=function(t,r,u){var l=a(t),f,o,s,e;if(null==l&&"string"!=typeof t&&(t.id=i.uuid()),f=c.addNode(t,a),null!=f){if(null!=dt&&(o=dt(f.data,f),null!=o))for(s=0;s<o.length;s++)f.addPort(o[s]);return"string"!=typeof t&&null!=t.group&&(e=this.getGroup(t.group),null==e&&wi&&(e=c.addGroup(t.group)),null!=e&&e.addVertex(f)),v||y||n.jsPlumbToolkitIO.manage("addNode",p,w,f,a||c.getIdFunction(),h),u||h.fire("nodeAdded",{data:t,node:f,eventInfo:r}),f}return c.getNode(l)};this.addFactoryNode=function(n,t,i){t=2!=arguments.length||null!=arguments[1]&&"object"!=typeof arguments[1]?{}:arguments[1];i=3==arguments.length?arguments[2]:"function"==typeof arguments[1]?arguments[1]:null;t.type=t.type||n;st(n,t,function(n){var t=this.addNode(n);i&&i(t)}.bind(this))};this.addNodes=function(n){for(var t=0;t<n.length;t++)h.addNode.apply(h,[n[t]]);return h};this.addGroup=function(t,r,u){var e=a(t),f;return null==e&&"string"!=typeof t&&(t.id=i.uuid()),f=c.addGroup(t,a),v||y||n.jsPlumbToolkitIO.manage("addGroup",p,w,f,a||c.getIdFunction(),h),u||h.fire("groupAdded",{data:t,group:f,eventInfo:r}),f};this.addToGroup=function(n,t){var i=!1;return n=h.getNode(n),t=h.getGroup(t),n&&t&&(i=t.addVertex(n),i&&(n.data.group=t.id,h.fire("group:addMember",{node:n,group:this.getGroup(t)}),h.fire("dataUpdated"))),i};this.removeFromGroup=function(n,t){n=h.getNode(n);var i;return n&&n.group&&(i=n.group,i.deleteVertex(n),delete n.data.group,t||h.fire("group:removeMember",{node:n,group:i}),h.fire("dataUpdated")),i};this.removeGroup=function(t,i,r){var u=c.deleteGroup(t,i);u&&(v||y||n.jsPlumbToolkitIO.manage("removeGroup",p,w,u,a||c.getIdFunction(),h),r||h.fire("groupRemoved",{group:u,removeChildNodes:i}))};this.getNode=function(n){return c.getVertex(n)};this.getEdge=function(n){return c.getEdge(n)};this.getGroup=function(n){return c.getGroup(n)};this.exists=function(){for(var n=0;n<arguments.length;n++)if(null==c.getVertex(arguments[n]))return!1;return!0};this.removeNode=function(t,i){t=t.constructor===r.Vertex||t.constructor===r.Port?t:c.getVertex(t);for(var u=t.getAllEdges()||[],f=0;f<u.length;f++)h.removeEdge(u[f]);return c.deleteVertex(t.id),v||y||n.jsPlumbToolkitIO.manage("removeNode",p,w,t,a||c.getIdFunction(),h),i||h.fire("nodeRemoved",{node:t,nodeId:t.id,edges:u}),h};this.addEdge=function(t,i,r){var u=c.addEdge(t,it,this.beforeConnect);return v||y||n.jsPlumbToolkitIO.manage("addEdge",p,w,u,it||c.getIdFunction(),h),r||h.fire("edgeAdded",{edge:u,source:i,geometry:t.geometry,addedByMouse:t.addedByMouse},null),u};this.removeEdge=function(t,i){return t=c.getEdge(t),null!=t&&(c.deleteEdge(t),v||y||n.jsPlumbToolkitIO.manage("removeEdge",p,w,t,it||c.getIdFunction(),h),h.fire("edgeRemoved",{edge:t,source:i},null)),h};this.edgeMoved=function(n,t,i){var r=(n[0===i?"source":"target"],0===i?"setSource":"setTarget");return this[r](n,t)};this.setTarget=function(n,t,i){var r=c.setTarget.apply(c,arguments);return r.success===!1||i||h.fire("edgeTarget",r),r};this.setSource=function(n,t,i){var r=c.setSource.apply(c,arguments);return r.success===!1||i||h.fire("edgeSource",r),r};this.addNewPort=function(t,i,r,u){t=c.getVertex(t);ht({node:t,type:i},r,function(i){var f=d(i),r=t.addPort(f);r.data=i;g(t);v||y||n.jsPlumbToolkitIO.manage("addPort",p,w,{node:t,port:r},d||c.getIdFunction(),h);u||h.fire("portAdded",{node:t,data:i,port:r},null)})};this.addPort=function(t,i,r){var u=t.addPort(i,d);return g(t),v||y||n.jsPlumbToolkitIO.manage("addPort",p,w,{node:t,port:u},d||c.getIdFunction(),h),r||h.fire("portAdded",{node:t,data:i,port:u},null),u};this.removePort=function(n,t,i){var o=!1,u,f,e;if(n=n.constructor===r.Vertex||n.constructor===r.Port?n:c.getVertex(n),u=n.getPort(t),u&&(f=u.getAllEdges(),o=n.removePort(u),o&&!i))for(g(n),h.fire("portRemoved",{node:n,port:u,edges:f},null),e=0;e<f.length;e++)h.removeEdge(f[e]);return o};this.remove=function(n){if(null!=n){var t=h.getObjectInfo(n);h.setSuspendRendering(!0);try{if(t.obj&&("Node"===t.type||"Edge"===t.type||"Group"===t.type))h["remove"+t.type](t.obj);else{for(;n.getNodeCount()>0;)h.removeNode(n.getNodeAt(0));for(;n.getEdgeCount()>0;)h.removeEdge(n.getEdgeAt(0));for(;n.getGroupCount()>0;)h.removeGroup(n.getGroupAt(0))}}finally{h.setSuspendRendering(!1,!0)}}};this.setSuspendRendering=function(n,t){for(var i in b)b[i].setSuspendRendering(n,t)};this.batch=function(n){h.setSuspendRendering(!0);try{n()}catch(n){jsPlumbUtil.log("Error in transaction "+n)}finally{h.setSuspendRendering(!1,!0)}};at=function(n,i,r,f){var e=c.getNode(n),s,o;if(e&&e.objectType){if(s=u.extend({},e.data),i){for(o in i)t.replace(e.data,o,i[o]);"Port"===e.objectType&&g(e.getNode())}h.fire(r,f(e,s),null)}}.bind(this);g=function(n){if(null!=gt){var t=gt(n.data,n,n.getPorts());null!=t&&(n.data=t)}};this.updateNode=function(n,t){at(n,t,"nodeUpdated",function(n,i){return{node:n,updates:t||{},originalData:i}})};this.updatePort=function(n,t){at(n,t,"portUpdated",function(n,i){return{port:n,node:n.getNode(),updates:t||{},originalData:i}})};this.updateEdge=function(n,i){var r=c.getEdge(n),e,f;if(r){if(e=u.extend({},r.data),i)for(f in i)null==r.data[f]?r.data[f]=i[f]:t.replace(r.data,f,i[f]);h.fire("edgeUpdated",{edge:r,updates:i||{},originalData:e},null)}};this.update=function(n,i){return t.isString(n)&&(n=this.getNode(n)),n&&n.objectType&&this["update"+n.objectType](n,i),n};this.getPath=function(t){return new n.jsPlumbToolkit.Path(this,t)};ut=this.findGraphObject=function(n){return null==n?null:"*"===n?c:n.constructor===r.Vertex||n.constructor===r.Port?n:t.isString(n)||t.isObject(n)?c.getVertex(n):null};fi=function(n,t,i){n=n||{};var f=[],e={},o=function(n){e[n.getId()]||(f.push(n),e[n.getId()]=!0)},u=function(u,f,e,s){var l,h,a,v;if(null!=u)for(l=u[t]({filter:n.filter}),h=0;h<l.length;h++)a=f&&u===c||l[h].source===u||i&&l[h].source.constructor===r.Port&&l[h].source.getNode()===u,v=e&&u===c||l[h].target===u||i&&l[h].target.constructor===r.Port&&l[h].target.getNode()===u,(f&&a||e&&v||s&&(a||v))&&o(l[h])};return u(ut(n.source),!0,!1,!1),u(ut(n.target),!1,!0,!1),u(ut(n.element),!1,!1,!0),f};this.getEdges=function(n){return fi(n,"getEdges",!1)};this.getAllEdges=function(){return c.getAllEdges()};this.getAllEdgesFor=function(n,t){return n.getAllEdges({filter:t})};this.selectAllEdges=function(){return this.filter(function(n){return"Edge"===n.objectType})};this.addAllEdgesToSelection=function(){this.addToSelection(this.getAllEdges())};vt=function(t,r,u){var s,l,a,y;t=t||{};var e=t.type||"json",o=t.data,f=t.url,b=t.jsonp,c=t.onload,k=t.parameters||{},d=t.error||function(){};if(null==o&&null==f)throw new TypeError("You must supply either data or url to load.");return s=function(t){p=t;w=e;v=!0;h.fire(r);n.jsPlumbToolkitIO.parse(e,t,h,k);ei(u);c&&c(h,t);h.fire("graphChanged")},o?s(o):f&&(b&&(l=f.indexOf("?")===-1?"?":"&",f=f+l+"callback=?"),a="json"===e?e:t.dataType,y=t.headers||{Accept:"application/json"},i.ajax({url:f,success:s,dataType:a,error:d,headers:y})),h};this.load=function(n){return vt(n,"dataLoadStart","dataLoadEnd")};this.append=function(n){return vt(n,"dataAppendStart","dataAppendEnd")};this.save=function(n){n=n||{};var r=this.exportData(n),t={"Content-Type":"application/json"};return u.extend(t,n.headers||{}),i.ajax({url:n.url,type:"POST",data:r,success:n.success||function(){},error:n.error||function(){},headers:t}),h};this.exportData=function(t){return t=t||{},n.jsPlumbToolkitIO.exportData(t.type||"json",h,t.parameters)};nt=function(n){return new i.Selection({toolkit:h,onClear:n||function(){}})};l=nt(function(n){h.fire("selectionCleared",{selection:n})});o.maxSelectedNodes&&l.setMaxNodes(o.maxSelectedNodes);o.maxSelectedEdges&&l.setMaxEdges(o.maxSelectedEdges);o.selectionCapacityPolicy&&l.setCapacityPolicy(o.selectionCapacityPolicy);tt=function(n,t,i,r){return t||i.clear(!0),i.append(n,function(n){r&&h.fire("select",{append:t,obj:n,selection:i})})};this.setSelection=function(n){tt(n,!1,l,!0)};this.select=function(n,t){var f=nt(),o=tt(n,!0,f),i,r,e,u;if(t)for(i=0;i<o[0].length;i++)if(r=o[0][i],"Node"===r.objectType||"Port"===r.objectType)for(e=r.getAllEdges(),u=0;u<e.length;u++)f.append(e[u]);return f};yt=function(n,t,i,r){for(var e,o,f=n.getAllEdges(),u=0,s=f.length;u<s;u++)(f[u].source===n||f[u].getNode&&f[u].getNode()===n)&&(e=f[u].target,o=e.getFullId(),r[o]||(t.append(e),i&&t.append(f[u]),r[o]=!0,yt(e,t,i,r)))};this.selectDescendants=function(n,t,i){var r=h.getObjectInfo(n),u=nt(),f;return r.obj&&"Node"===r.obj.objectType&&(t&&tt(r.obj,!0,u),f={},f[r.obj.getFullId()]=!0,yt(r.obj,u,i,f)),u};this.filter=function(n,t){var r="function"==typeof n?n:function(i){var e=i.data,r=!1,u,f;for(u in n){if(f=n[u]===e[u],!f&&!t)return!1;r=r||f}return r},i=nt();return this.eachNode(function(n,t){r(t)&&i.append(t);for(var f=t.getPorts(),u=0;u<f.length;u++)r(f[u])&&i.append(f[u])}),this.eachEdge(function(n,t){r(t)&&i.append(t)}),this.eachGroup(function(n,t){r(t)&&i.append(t)}),i};this.addToSelection=function(n){var i=this.getObjectInfo(n),t;i&&(t=tt(i.obj,!0,l,!0),k("deselect",t[1]),k("select",t[0]))};k=function(n,t){for(var i=0;i<t.length;i++)h.fire(n,{obj:t[i],selection:l})};this.toggleSelection=function(n){var r=this.getObjectInfo(n),t,i;r&&(t=[],i=l.toggle(r.obj,function(n,i){i||t.push(n)}),k("deselect",i[1]),k("deselect",t),k("select",i[0]))};this.removeFromSelection=function(n){var t=this.getObjectInfo(n);t&&l.remove(t.obj,function(n){h.fire("deselect",{obj:n,selection:l})})};this.addPathToSelection=function(n){this.addToSelection(this.getPath(n))};this.selectAll=function(){throw new TypeError("not implemented");};this.clearSelection=l.clear;this.getSelection=function(){return l};this.setMaxSelectedNodes=function(n){l.setMaxNodes(n)};this.setMaxSelectedEdges=function(n){l.setMaxEdges(n)};this.setSelectionCapacityPolicy=function(n){l.setCapacityPolicy(n)};ei=function(n){h.setSuspendGraph(!0);h.fire(n);h.setSuspendGraph(!1);v=!1};b={};(this.render=function(r,f){var e=u.extend({},f||{});u.extend(e,r);e.toolkit=h;null!=r.selection&&(e.toolkit=r.selection.constructor===i.Selection?r.selection:new i.Selection({generator:r.selection,toolkit:h}));var c=e.type||n.jsPlumbToolkit.DefaultRendererType,o=new n.jsPlumbToolkit.Renderers[c](e),s=e.id||t.uuid();return b[s]=o,o.id=s,o},this.getRenderer=function(n){return b[n]},this.getRenderers=function(){return b},this.getObjectInfo=function(n,i){var r={els:{},obj:null,type:null,id:null,el:null},o=function(n){if(null!=n)return n.jtk?n:o(n.parentNode)},s=function(n){var i={};for(var t in b)i[t]=[b[t],b[t].getRenderedElement(n)];return i},f,e;if(null!=n){if(n.eachNode&&n.eachEdge)return{obj:n};if(t.isArray(n))return{obj:n};if(f=u.getElement(n),null!=f&&f.jtk)r.el=f,r.obj=f.jtk.port||f.jtk.node;else if(null!=n.tagName)e=o(f),null!=e&&(r.el=e,r.obj=e.jtk.port||e.jtk.node||e.jtk.group);else{if("string"==typeof n?n=this.getNode(n):"object"==typeof n&&"undefined"==typeof n.objectType&&(n=this.getNode(a(n))),null==n)return r;r.obj=n;null!=i&&(r.el=i(n))}null==i&&(r.els=s(r.obj));null!=r.obj&&(r.id=r.obj.id,r.type=r.obj.objectType)}return r},o.data)&&(oi=o.dataType||"json",h.load({data:o.data,type:oi}))};t.extend(n.jsPlumbToolkitInstance,t.EventGenerator);n.jsPlumbToolkit=new n.jsPlumbToolkitInstance({});n.jsPlumbToolkit.DefaultRendererType=null;n.jsPlumbToolkit.ready=u.ready;n.jsPlumbToolkit.Renderers={};n.jsPlumbToolkit.Widgets={};o=function(t){return new n.jsPlumbToolkitInstance(t)};n.jsPlumbToolkit.newInstance=o;"undefined"!=typeof exports&&(exports.jsPlumbToolkit=n.jsPlumbToolkit,exports.newInstance=o)}.call("undefined"!=typeof window?window:this),function(){var t=this,i=t.jsPlumbToolkit,n=t.jsPlumbToolkitUtil,r=t.jsPlumbUtil;i.Model=function(t,u){var s,h,o;t=t||{};t.nodes=t.nodes||{};t.edges=t.edges||{};t.ports=t.ports||{};t.groups=t.groups||{};var f,e,c={},v=function(i){var r=n.mergeWithParents([i,"default"],t.nodes);return delete r.parent,r},l=function(i){var r=n.mergeWithParents([i,"default"],t.edges);return delete r.parent,r},a=function(i,r){var u=r&&r.ports?n.mergeWithParents([i,"default"],r.ports):n.mergeWithParents([i,"default"],t.ports);return delete u.parent,u},y=function(i){var r=n.mergeWithParents([i,"default"],t.groups);return delete r.parent,r};if("undefined"!=typeof u){for(s in t.edges){if(f=l(s),f.overlays)for(e=0;e<f.overlays.length;e++)if(r.isArray(f.overlays[e])&&f.overlays[e][1].events)for(h in f.overlays[e][1].events)f.overlays[e][1].events[h]=function(n,t){return function(i,r){n.call(t,{overlay:i,e:r,component:i.component,edge:i.component.edge})}}(f.overlays[e][1].events[h],f.overlays[e]);u.registerConnectionType(s,f)}for(e in t.ports)f=a(e),u.registerEndpointType(e,f);if(t.states)for(o in t.states)c[o]=new i.UIState(o,t.states[o],u)}return{getNodeDefinition:v,getEdgeDefinition:l,getPortDefinition:a,getGroupDefinition:y,getState:function(n){return c[n]}}}}.call("undefined"!=typeof window?window:this),function(){var n=jsPlumbToolkit.ready,u=function(n){var t=0,r=function(){t--;t<=0&&i()};this.add=function(i){t++;jsPlumbToolkitUtil.ajax({url:i,success:function(t){var i=n.innerHTML;i+=t;n.innerHTML=i;r()},error:function(){r()}})};this.ensureNotEmpty=function(){t<=0&&i()}},t=[],r=!1,i=function(){r=!0;for(var i=0;i<t.length;i++)n.call(n,t[i])};jsPlumbToolkit.ready=function(i){r?n.call(n,i):t.push(i)};jsPlumb.ready(function(){var n=document.getElementById("jsPlumbToolkitTemplates"),e,o;if(n)i();else{n=document.createElement("div");n.style.display="none";n.id="jsPlumbToolkitTemplates";document.body.appendChild(n);for(var f=new u(n),r=document.getElementsByTagName("script"),t=0;t<r.length;t++)e=r[t].getAttribute("type"),o=r[t].getAttribute("src"),"text/x-jtk-templates"==e&&f.add(o);f.ensureNotEmpty()}})}.call("undefined"!=typeof window?window:this),function(){"use strict";this.jsPlumbToolkit.Classes={LASSO:"jtk-lasso",LASSO_SELECT_DEFEAT:"jtk-lasso-select-defeat",MINIVIEW:"jtk-miniview",MINIVIEW_CANVAS:"jtk-miniview-canvas",MINIVIEW_PANNER:"jtk-miniview-panner",MINIVIEW_ELEMENT:"jtk-miniview-element",MINIVIEW_GROUP_ELEMENT:"jtk-miniview-group-element",MINIVIEW_PANNING:"jtk-miniview-panning",MINIVIEW_COLLAPSE:"jtk-miniview-collapse",MINIVIEW_COLLAPSED:"jtk-miniview-collapsed",NODE:"jtk-node",PORT:"jtk-port",GROUP:"jtk-group",SELECT_DEFEAT:"jtk-drag-select-defeat",SURFACE:"jtk-surface",SURFACE_NO_PAN:"jtk-surface-nopan",SURFACE_CANVAS:"jtk-surface-canvas",SURFACE_PAN:"jtk-surface-pan",SURFACE_PAN_LEFT:"jtk-surface-pan-left",SURFACE_PAN_TOP:"jtk-surface-pan-top",SURFACE_PAN_RIGHT:"jtk-surface-pan-right",SURFACE_PAN_BOTTOM:"jtk-surface-pan-bottom",SURFACE_PAN_ACTIVE:"jtk-surface-pan-active",SURFACE_SELECTED_ELEMENT:"jtk-surface-selected-element",SURFACE_SELECTED_CONNECTION:"jtk-surface-selected-connection",SURFACE_PANNING:"jtk-surface-panning",SURFACE_ELEMENT_DRAGGING:"jtk-surface-element-dragging",SURFACE_DROPPABLE_NODE:"jtk-surface-droppable-node",TOOLBAR:"jtk-toolbar",TOOLBAR_TOOL:"jtk-tool",TOOLBAR_TOOL_SELECTED:"jtk-tool-selected",TOOLBAR_TOOL_ICON:"jtk-tool-icon"};this.jsPlumbToolkit.Constants={click:"click",start:"start",stop:"stop",drop:"drop",disabled:"disabled",pan:"pan",select:"select",drag:"drag",left:"left",right:"right",top:"top",bottom:"bottom",width:"width",height:"height",leftmin:"leftmin",leftmax:"leftmax",topmin:"topmin",topmax:"topmax",min:"min",max:"max",nominalSize:"50px",px:"px",onepx:"1px",nopx:"0px",em:"em",absolute:"absolute",relative:"relative",none:"none",block:"block",hidden:"hidden",div:"div",id:"id",plusEquals:"+=",minusEquals:"-=",dot:".",transform:"transform",transformOrigin:"transform-origin",nodeType:"Node",portType:"Port",edgeType:"Edge",groupType:"Group",surfaceNodeDragScope:"surfaceNodeDrag",mistletoeLayoutType:"Mistletoe",surfaceType:"Surface",jtkStatePrefix:"jtk-state-",msgCannotSaveState:"Cannot save state",msgCannotRestoreState:"Cannot restore state"};this.jsPlumbToolkit.Attributes={jtkNodeId:"jtk-node-id",relatedNodeId:"related-node-id"};this.jsPlumbToolkit.Methods={addClass:"addClass",removeClass:"removeClass"};this.jsPlumbToolkit.Events={beforeDrop:"beforeDrop",beforeDetach:"beforeDetach",click:"click",canvasClick:"canvasClick",canvasDblClick:"canvasDblClick",connection:"connection",connectionAborted:"connectionAborted",connectionDetached:"connectionDetached",connectionMoved:"connectionMoved",connectionDragStop:"connectionDragStop",contentDimensions:"contentDimensions",contextmenu:"contextmenu",dataLoadStart:"dataLoadStart",dataAppendStart:"dataAppendStart",dataLoadEnd:"dataLoadEnd",dataAppendEnd:"dataAppendEnd",dblclick:"dblclick",drag:"drag",drop:"drop",dragover:"dragover",dragend:"dragend",edgeAdded:"edgeAdded",edgeRemoved:"edgeRemoved",edgeTypeChanged:"edgeTypeChanged",elementDragged:"elementDragged",elementAdded:"elementAdded",elementRemoved:"elementRemoved",endOverlayAnimation:"endOverlayAnimation",graphClearStart:"graphClearStart",graphCleared:"graphCleared",groupAdded:"groupAdded",groupDragStop:"groupDragStop",groupExpand:"group:expand",groupCollapse:"group:collapse",groupRemoved:"groupRemoved",groupMemberAdded:"group:addMember",groupMemberRemoved:"group:removeMember",groupMoveEnd:"groupMoveEnd",groupUpdated:"groupUpdated",lassoEnd:"lasso:end",modeChanged:"modeChanged",mousedown:"mousedown",mousemove:"mousemove",mouseout:"mouseout",mouseup:"mouseup",mouseenter:"mouseenter",mouseleave:"mouseleave",mouseover:"mouseover",nodeAdded:"nodeAdded",nodeDropped:"nodeDropped",nodeMoveStart:"nodeMoveStart",nodeMoveEnd:"nodeMoveEnd",nodeRemoved:"nodeRemoved",edgeTarget:"edgeTarget",nodeTypeChanged:"nodeTypeChanged",edgeSource:"edgeSource",objectRepainted:"objectRepainted",pan:"pan",portAdded:"portAdded",portRemoved:"portRemoved",portTypeChanged:"portTypeChanged",redraw:"redraw",start:"start",startOverlayAnimation:"startOverlayAnimation",stateRestored:"stateRestored",stop:"stop",tap:"tap",touchend:"touchend",touchmove:"touchmove",touchstart:"touchstart",unload:"unload",portRefreshed:"portRefreshed",nodeRefreshed:"nodeRefreshed",edgeRefreshed:"edgeRefreshed",nodeRendered:"nodeRendered",nodeUpdated:"nodeUpdated",portUpdated:"portUpdated",edgeUpdated:"edgeUpdated",zoom:"zoom",relayout:"relayout",deselect:"deselect",selectionCleared:"selectionCleared",resize:"resize",anchorChanged:"anchorChanged"}}.call("undefined"!=typeof window?window:this),function(){"use strict";var n=this;n.jsPlumbToolkit.util={Cookies:{get:function(n){return document.cookie.match(new RegExp(n+"=[a-zA-Z0-9.()=|%/_]+($|;)","g")),val&&0!=val.length?unescape(val[0].substring(n.length+1,val[0].length).replace(";",""))||null:null},set:function(n,t,i,r){var u=[n+"="+escape(t),"/","domain="+!domain?window.location.host:domain],f=function(){if("NaN"==parseInt(r))return"";var n=new Date;return n.setTime(n.getTime()+36e5*parseInt(r)),n.toGMTString()};return r&&u.push(f(r)),document.cookie=u.join("; ")},unset:function(t,i,r){i=i&&"string"==typeof i?i:"";r=r&&"string"==typeof r?r:"";n.jsPlumbToolkit.util.Cookies.get(t)&&n.jsPlumbToolkit.util.Cookies.set(t,"","Thu, 01-Jan-70 00:00:01 GMT",i,r)}},Storage:{set:function(t,i){"undefined"==typeof localStorage?n.jsPlumbToolkit.util.Cookies.set(t,i):localStorage.setItem(t,i)},get:function(t){return"undefined"==typeof localStorage?n.jsPlumbToolkit.util.Cookies.read(t):localStorage.getItem(t)},clear:function(t){"undefined"==typeof localStorage?n.jsPlumbToolkit.util.Cookies.unset(t):localStorage.removeItem(t)},clearAll:function(){if("undefined"!=typeof localStorage)for(;localStorage.length>0;){var n=localStorage.key(0);localStorage.removeItem(n)}},setJSON:function(t,i){if("undefined"==typeof JSON)throw new TypeError("JSON undefined. Cannot store value.");n.jsPlumbToolkit.util.Storage.set(t,JSON.stringify(i))},getJSON:function(t){if("undefined"==typeof JSON)throw new TypeError("JSON undefined. Cannot retrieve value.");return JSON.parse(n.jsPlumbToolkit.util.Storage.get(t))}}}}.call("undefined"!=typeof window?window:this),function(){"use strict";var n=this,t=n.jsPlumbToolkit,i=t,r=n.jsPlumbUtil;i.Path=function(n,t){var f;this.bind=n.bind;this.getModel=n.getModel;this.setSuspendGraph=n.setSuspendGraph;this.getNodeId=n.getNodeId;this.getEdgeId=n.getEdgeId;this.getPortId=n.getPortId;this.getNodeType=n.getNodeType;this.getEdgeType=n.getEdgeType;this.getPortType=n.getPortType;for(var i=n.getGraph().findPath(t.source,t.target,t.strict,t.nodeFilter,t.edgeFilter),h=function(){for(var t=0;t<i.path.length;t++)i.path[t].edge&&n.removeEdge(i.path[t].edge);return this}.bind(this),o=function(){for(var t=0;t<i.path.length;t++)n.removeNode(i.path[t].vertex);return this}.bind(this),c=function(t,r){var f=n.findGraphObject(t),e=!1,u;if(f)for(u=0;u<i.path.length;u++)if(i.path[u].vertex==f||i.path[u].edge==f||!r&&"Port"==i.path[u].vertex.objectType&&i.path[u].vertex.isChildOf(f)){e=!0;break}return e},s=[],e={},u=0;u<i.path.length;u++)s.push(i.path[u].vertex),e[n.getNodeId(i.path[u].vertex)]=[i.path[u].vertex,u];this.getNodes=function(){return s};this.getNode=function(n){return e["string"==typeof n?n:n.id][0]};this.getAllEdgesFor=function(n){var t=e[n.id][1];return t<i.path.length-1?[i.path[t+1].edge]:[]};f=function(n,t){for(var u=t||0;u<i.path.length;u++)try{n(u,i.path[u])}catch(n){r.log("Path iterator function failed",n)}};this.each=function(n){f(function(t,i){n(t,i)})};this.eachNode=function(n){f(function(t,i){n(t,i.vertex)})};this.eachEdge=function(n){f(function(t,i){n(t,i.edge)},1)};this.getNodeCount=function(){return i.path.length};this.getNodeAt=function(n){return i.path[n].vertex};this.getEdgeCount=function(){return 0==i.path.length?0:i.path.length-1};this.getEdgeAt=function(n){return n<0&&(n=i.path.length-1+n),i.path.length>n+1?i.path[n+1].edge:null};this.path=i;this.deleteEdges=h;this.deleteNodes=o;this.deleteAll=o;this.isEmpty=function(){return 0==i.path.length};this.getCost=function(){return i.pathDistance};this.contains=c;this.exists=function(){return null!=i.pathDistance};this.selectEdges=function(n){return _selectEdges(n,"getEdges",!1)};this.selectAllEdges=function(n){return _selectEdges(n,"getAllEdges",!0)}}}.call("undefined"!=typeof window?window:this),function(){"use strict";var t=this,n=t.jsPlumbToolkitIO={},i=t.jsPlumbUtil,r=t.jsPlumb,u=function(n,t){for(var e,u,s,i,h,c=n.nodes||[],r=n.edges||[],f=n.ports||[],l=n.groups||[],o=0;o<l.length;o++)t.addGroup(l[o]);for(e=0;e<c.length;e++)t.addNode(c[e]);for(u=0;u<f.length;u++)if(f[u].nodeId){if(s=t.getNode(f[u].nodeId),null==s)throw new TypeError("Unknown node ["+f[u].nodeId+"]");s.addPort(f[u])}for(i=0;i<r.length;i++)h={source:r[i].source,target:r[i].target,cost:r[i].cost||1,directed:r[i].directed,data:r[i].data},r[i].geometry&&(h.geometry=r[i].geometry),t.addEdge(h)},f=function(n){return n.getGraph().serialize()},e=function(n,t){var i=function(n){var f=t.addNode(n),r,u;if(n.children)for(r=0;r<n.children.length;r++)u=t.addNode(n.children[r]),t.addEdge({source:f,target:u}),i(n.children[r])};i(n)};n.exporters={json:f};n.parsers={json:u,"hierarchical-json":e};n.managers={json:{removeNode:function(n,t,r){var u=r(t.data);i.removeWithFunction(n.nodes,function(n){return n.id===u})},removeEdge:function(n,t,r){var u=r(t.data);i.removeWithFunction(n.edges,function(n){return n.data&&n.data.id===u})},addNode:function(n,t){n.nodes=n.nodes||[];n.nodes.push(t.data)},addEdge:function(n,t){var i={source:t.source.getFullId(),target:t.target.getFullId(),data:t.data||{}};n.edges=n.edges||[];n.edges.push(i)},addPort:function(n,t){n.ports=n.ports||[];var i=r.extend({},t.port.data||{});i.id=t.port.getFullId();n.ports.push(i)},removePort:function(n,t){var r=t.port.getFullId();i.removeWithFunction(n.ports,function(n){return n.id===r})}}};n.parse=function(t,i,r,u){var f=n.parsers[t];if(null==f)throw new Error("jsPlumb Toolkit - parse - ["+t+"] is an unsupported type");return f(i,r,u)};n.exportData=function(t,i,r){var u=n.exporters[t];if(null===u)throw new Error("jsPlumb Toolkit - exportData - ["+t+"]  is an unsupported type");return u(i,r)};n.manage=function(t,i,r,u,f){n.managers[r]&&n.managers[r][t]&&n.managers[r][t](i,u,f)};"undefined"!=typeof exports&&(exports.jsPlumbToolkitIO=n)}.call("undefined"!=typeof window?window:this),function(){var n=this,t=n.jsPlumbToolkit,i=t;i.Support={ingest:function(i){var r=i.jsPlumb||n.jsPlumb,o,u,a,f,h,c;if(!r.getContainer())throw new TypeError("No Container set on jsPlumb instance. Cannot continue.");var s=t.newInstance(),p=r.select(),e={},v=function(){return"default"},y=i.idFunction||function(n){return r.getId(n)},w=i.typeFunction||v,b=i.idFunction||function(n){return n.id},k=i.edgeTypeFunction||v,d=i.render!==!1,l=function(n){var i=y(n),u=w(n),t=r.getId(n);null==e[t]&&(e[t]=s.addNode({id:i,type:u},null,!0),n.jtk={node:e[t]})},g=function(n){var t=e[n.sourceId],i=e[n.targetId],r=b(n),u=k(n);n.edge=s.addEdge({source:t,target:i,data:{id:r,type:u}},null,!0)};if(i.nodeSelector)for(o=r.getContainer().querySelectorAll(i.nodeSelector),u=0;u<o.length;u++)f=r.getId(o[u]),l(o[u],f),r.manage(f,o[u]);a=r.getManagedElements();for(f in a)l(a[f].el,f);return(p.each(function(n){g(n)}),d)?(h=n.jsPlumb.extend({},i.renderParams||{}),h.jsPlumbInstance=r,h.container=r.getContainer(),c=s.render(h),c.ingest=function(n){l(n);c.importNode(n,y(n))},c):s}}}.call("undefined"!=typeof window?window:this),function(){"use strict";var t=this,f=t.jsPlumbToolkit,n=f.Layouts={Decorators:{}},i=t.jsPlumbUtil,e=function(n){var t=1/0,i=1/0,r=-(1/0),u=-(1/0);for(var f in n)t=Math.min(t,n[f][0]),r=Math.max(r,n[f][0]),i=Math.min(i,n[f][1]),u=Math.max(u,n[f][1]);return[[t,i],[r,u],Math.abs(t-r),Math.abs(i-u)]},o=function(t,r,u){var e;if(null==t)return[];for(var o=[],s=function(t){var f="string"==typeof t?t:t[0],e=n.Decorators[f],o="string"==typeof t?{}:t[1];return e?new e(o,r,u):(i.log("Decorator ["+f+"] nor registered on jsPlumbToolkit.Layouts.Decorators. Not fatal."),null)},f=0;f<t.length;f++)e=s(t[f]),e&&o.push(e);return o},r,u;n.AbstractLayout=function(n){function lt(){for(var i,t,e,o=function(n){return[n.data.left,n.data.top]},s=function(t){return(n.locationFunction||o)(t)},h=f.getGroupCount(),u,r=0;r<h;r++)for(e=f.getGroupAt(r),i=e.getVertices(),t=0;t<i.length;t++)u=s(i[t]),p(i[t].id,u[0],u[1])}var it;n=n||{};var i=this,at=function(){return{padding:[0,0]}},vt=function(){var n=t.jsPlumb.extend(at(),i.defaultParameters||{});t.jsPlumb.extend(n,h||{});h=n},rt=n.adapter,h=n.parameters||{},d=n.getElementForNode,u=t.Farahey.getInstance({getPosition:function(n){var t=r[n.id];return{left:t[0],top:t[1]}},getSize:function(n){return s[n.id]},getId:function(n){return n.id},setPosition:function(n,t){p(n.id,t.left,t.top)},padding:h.padding,filter:function(n){return(!w[n]||!w[n].group)&&(!i.canMagnetize||i.canMagnetize(n))}}),yt=n.magnetized!==!1&&(i.defaultMagnetized||n.magnetize===!0);this.decorators=o(n.decorators,n.adapter,n.container);this.adapter=n.adapter;var c=n.jsPlumb||t.jsPlumb,f=n.jsPlumbToolkit,r={},ut=[],l=1/0,a=1/0,v=-(1/0),y=-(1/0),w={},g={},s={},pt=n.container,ft=c.getSize(pt),et=n.width||ft[0],ot=n.height||ft[1],k=!1,nt=function(){k=!1;l=1/0;v=-(1/0);a=1/0;y=-(1/0);for(var n=0;n<i.decorators.length;n++)i.decorators[n].reset({remove:c.remove});r={};ut.splice(0);s={};u.reset();i.reset&&i.reset()};this.getMagnetizedElements=function(){return u.getElements()};this.magnetize=function(n){n=n||{};var t=n.event?"executeAtEvent":n.origin?"execute":"executeAtCenter",i=n.event?[n.event,n.options]:n.origin?[n.origin,n.options]:[n.options];n.force&&this.forceMagnetize&&this.forceMagnetize();u[t].apply(u,i);tt(c.repaintEverything)};this.nodeAdded=function(n,t){var r=t&&t.position?t.position:n.node.data&&n.node.data.left&&n.node.data.top?n.node.data:i.adapter.getOffset(n.el),f;this._nodeAdded&&(f=this._nodeAdded(n,t),f&&(r.left=f[0],r.top=f[1]));w[n.node.id]=n.node;p(n.node.id,r.left,r.top);b(n.node.id,n.el);u.addElement(n.node)};this.nodeRemoved=function(t){delete r[t];delete s[t];delete w[t];this._nodeRemoved&&this._nodeRemoved(t);u.removeElement(n.node)};this.groupAdded=function(n,t){var r=t&&t.position?t.position:n.group.data&&n.group.data.left&&n.group.data.top?n.group.data:i.adapter.getOffset(n.el),f;this._groupAdded&&(f=this._groupAdded(n,t),f&&(r.left=f[0],r.top=f[1]));g[n.group.id]=n.group;p(n.group.id,r.left,r.top);b(n.group.id,n.el);u.addElement(n.group)};this.groupRemoved=function(t){delete r[t];delete s[t];delete g[t];this._groupRemoved&&this._groupRemoved(t);u.removeElement(n.group)};var b=function(n,t){var i=s[n];return i||(t=t||d(n),null!=t?(i=c.getSize(t),s[n]=i):i=[0,0]),i},wt=function(n,t,i,u){var f=r[n];if(!f){if(null!=t&&null!=i)f=[t,i];else{if(u)return null;f=[Math.floor(Math.random()*(et+1)),Math.floor(Math.random()*(ot+1))]}p(n,f[0],f[1])}return f},st=function(n){l=Math.min(l,n[0]);a=Math.min(a,n[1]);v=Math.max(v,n[0]);y=Math.max(y,n[1])},ht=function(n,t,i){var u=r[n];u?(u[0]=parseFloat(t),u[1]=parseFloat(i)):(u=r[n]=[parseFloat(t),parseFloat(i)],ut.push([u,n]));st(u)},ct=function(n,t,r){w[n]&&i._nodeMoved?i._nodeMoved(n,t,r):g[n]&&i._groupMoved&&i._groupMoved(n,t,r)},p=(this.setMagnetizedPosition=function(n,t,i,r){ht(n,t,i);this.magnetize({options:{filter:function(t){return t===n},padding:[5,5],exclude:function(n,t){return null!=t.group},excludeFocus:!0}});var u=this.getPosition(n);return r&&ct(n,u[0],u[1]),u},this.setPosition=function(n,t,i,r){ht(n,t,i);r&&ct(n,t,i)}),bt=function(n,t,i){t=t||10;i=i||10;var u=r[n];return u||(u=r[n]=[]),u[0]=Math.floor(Math.random()*t),u[1]=Math.floor(Math.random()*i),st(u),u},kt=function(){for(var n in r)console.log(n,r[n][0],r[n][1])},dt=function(n,t){var f=d(n),u;return null!=f?(u=r[n],i.adapter.setPosition(f,u[0],u[1],t),ti[n]=[u[0],u[1]],u.concat(b(n))):null}.bind(this),tt=this.draw=function(n){var e,t,u;for(e in r)t=dt(e),null!=t&&(l=Math.min(t[0],l),a=Math.min(t[1],a),v=Math.max(t[0]+t[2],v),y=Math.max(t[1]+t[3],y));for(u=0;u<i.decorators.length;u++)i.decorators[u].decorate({adapter:i.adapter,layout:i,append:function(n,t,r){i.adapter.append(n,t,r,!0)},setAbsolutePosition:i.adapter.setAbsolutePosition,toolkit:f,jsPlumb:c,bounds:[l,a,v,y],floatElement:i.adapter.floatElement,fixElement:i.adapter.fixElement});n&&n()},gt=function(n){console.log(n);var t=e(r,b,d);kt();console.log(t[0],t[1],t[2],t[3])};this.bb=gt;var ni=this.getPositions=function(){return r},ti=(this.getPosition=function(n){return r[n]},{}),ii=(this.getSize=function(n){return s[n]},this.setSize=function(n,t){s[n]=t});return this.begin=function(){},this.end=function(){},it=function(n){if(null!=f){vt();u.setElements(rt.getNodes()).addElements(rt.getGroups(),!0);this.begin&&this.begin(f,h);for(var t=function(){tt(function(){yt&&i.magnetize();i.end&&i.end(f,h);n&&n()})};!k;)this.step(f,h);t()}}.bind(this),this.relayout=function(n,t){nt();null!=n&&(h=n);it(t)},this.layout=function(n){k=!1;it(n)},this.clear=function(){nt()},{adapter:n.adapter,jsPlumb:c,toolkit:f,getPosition:wt,setPosition:p,getRandomPosition:bt,getSize:b,setSize:ii,getPositions:ni,setPositions:function(n){r=n},width:et,height:ot,reset:nt,draw:tt,setDone:function(n){k=n;lt()}}};n.EmptyLayout=function(n){var t={};this.refresh=this.relayout=this.layout=function(){var r,i,u;for(this.clear(),r=n.getNodeCount(),i=0;i<r;i++)u=n.getNodeAt(i),t[u.getFullId()]=[0,0];for(r=n.getGroupCount(),i=0;i<r;i++)u=n.getGroupAt(i),t[u.id]=[0,0]};this.nodeRemoved=this.groupRemoved=function(n){delete t[n.id]};this.nodeAdded=this.groupAdded=function(n){t[n.id]=!1};this.getPositions=function(){return t};this.getPosition=function(n){return t[n]};this.setPosition=function(n,i,r){t[n]=[i,r]};this.clear=function(){};this.getMagnetizedElements=function(){return[]}};n.Mistletoe=function(r){var f,o,s;if(!r.parameters.layout)throw"No layout specified for MistletoeLayout";f={};o=t.jsPlumb.extend({},r);o.getElementForNode=function(n){return f[n]};var h,c,l,e=n.AbstractLayout.apply(this,[o]),u=r.parameters.layout,a=function(){e.setPositions(u.getPositions());e.draw();this.fire("redraw")}.bind(this);i.EventGenerator.apply(this,arguments);this.map=function(n,t){f[n]=t};s=function(){f={};h=u.layout;c=u.relayout;l=u.clear;u.layout=function(){h.apply(u,arguments);a()};u.relayout=function(){e.reset();c.apply(u,arguments);a()};u.clear=function(){l.apply(u,arguments);e.reset()}};s();this.setHostLayout=function(n){u=n;s()}};r=n.AbsoluteBackedLayout=function(t){t=t||{};var i=n.AbstractLayout.apply(this,arguments),f=function(n){return[n.data.left,n.data.top]},r=function(n){return(t.locationFunction||f)(n)},u=function(n,t,u,f){for(var s=i.adapter[n](),e=0;e<s;e++){var h=i.adapter[t](e),c=h.getFullId(),o=i.getPosition(c,null,null,!0);null==o&&(o=r(h,f));this.setPosition(c,o[0],o[1],!0)}}.bind(this);return this.begin=function(n,t){u("getNodeCount","getNodeAt",n,t);u("getGroupCount","getGroupAt",n,t)},this._nodeAdded=function(n){return r(n.node,t.parameters||{})},this._groupAdded=function(n){return r(n.group,t.parameters||{})},this.getAbsolutePosition=function(n,t){return r(n,t)},this.step=function(){i.setDone(!0)},i};i.extend(r,n.AbstractLayout);n.Absolute=function(){n.AbsoluteBackedLayout.apply(this,arguments)};i.extend(n.Absolute,n.AbsoluteBackedLayout);u=n.AbstractHierarchicalLayout=function(t){var r=this,i=n.AbstractLayout.apply(this,arguments);return r.begin=function(n,r){r.ignoreLoops=!(t.ignoreLoops===!1);r.getRootNode=r.getRootNode||function(n){return t.multipleRoots!==!1?n.filter(function(n){return"Node"===n.objectType&&0==n.getTargetEdges().length&&null==n.group||"Group"===n.objectType&&0==n.getTargetEdges().length}).getAll():i.adapter.getNodeCount()>0?i.adapter.getNodeAt(0):null};r.getChildEdges=r.getChildEdges||function(n){return i.toolkit.getAllEdgesFor(n,function(i){return i.source===n||t.ignorePorts!==!0&&i.source.getNode&&i.source.getNode()===n})};r.rootNode=r.getRootNode(n);r.rootNode||i.setDone(!0)},i};i.extend(u,n.AbstractLayout)}.call("undefined"!=typeof window?window:this),function(){"use strict";var n=this,i=n.jsPlumbToolkit,t=i.Layouts,r=n.Farahey;t.Circular=function(n){function f(n){for(var i=[],r=u?1:0,t=r;t<n.length;t++)n[t].group||i.push(n[t]);return i}n=n||{};var i=t.AbstractLayout.apply(this,arguments),u=!!n.parameters&&n.parameters.centerRootNode===!0;this.defaultParameters={padding:30,locationFunction:n.locationFunction};this.step=function(n,t){var o=[],p=i.adapter.getNodes(),b;if(0===p.length)return void i.setDone(!0);Array.prototype.push.apply(o,f(p));Array.prototype.push.apply(o,i.adapter.getGroups());var e,c,k=0,d=0,s=10,w=2*Math.PI/o.length,h=-Math.PI/2;for(u&&(b=i.getSize(p[0].id),s=Math.max(b[0],b[1])+80),e=0;e<o.length;e++)if(c=o[e],i.setPosition(c.id,k+Math.sin(h)*s,d+Math.cos(h)*s,!0),h+=w,e>0){var g=o[e-1],l=i.getSize(g.id),a=i.getPosition(g.id),ut={x:a[0]-t.padding,y:a[1]-t.padding,w:l[0]+2*t.padding,h:l[1]+2*t.padding},nt=o[e],v=i.getSize(nt.id),y=i.getPosition(nt.id),ft={x:y[0]-t.padding,y:y[1]-t.padding,w:v[0]+2*t.padding,h:v[1]+2*t.padding},tt=r.calculateSpacingAdjustment(ut,ft),it=[a[0]+l[0]/2,a[1]+l[1]/2],rt=[y[0]+tt.left+v[0]/2,y[1]+tt.top+ +(v[1]/2)],et=Math.sqrt(Math.pow(it[0]-rt[0],2)+Math.pow(it[1]-rt[1],2));s=Math.max(s,et/2/Math.sin(w/2))}for(e=0;e<o.length;e++)c=o[e],i.setPosition(c.id,k+Math.sin(h)*s,d+Math.cos(h)*s,!0),h+=w;i.setDone(!0)}}}.call("undefined"!=typeof window?window:this),function(){"use strict";var t=this,r=t.jsPlumbToolkit,n=r.Layouts,i=t.jsPlumbUtil;n.Hierarchical=function(t){var c,l,u,k,f,a,v,e=n.AbstractHierarchicalLayout.apply(this,arguments),o=[],d=null!=t.parameters&&t.parameters.compress,r=[],s=[],h=e.toolkit.getNodeId,g=function(n){var t=r[n];return t||(t={nodes:[],pointer:0},r[n]=t),t},y=function(n,t,i,r,e){var s=g(i),h={node:n,parent:r,childGroup:e,loc:s.pointer,index:s.nodes.length,dimensions:t,size:t[u]},c=t[0==u?1:0];return o[i]=null==o[i]?c:Math.max(o[i],c),s.pointer+=t[u]+f[u],s.nodes.push(h),h},nt=function(n,t){var i=s[t];i||(i=[],s[t]=i);n.index=i.length;i.push(n)},tt=function(n){var h,c,e,t;if(n.size>0){var o=n.parent.loc+n.parent.size/2-(n.size-f[u])/2,i=s[n.depth],r=-(1/0),l=0;for(null!=i&&i.length>0&&(h=i[i.length-1],c=h.nodes[h.nodes.length-1],r=c.loc+c.size+f[u]),o>=r?n.loc=o:(l=r-o,n.loc=r),e=n.loc,t=0;t<n.nodes.length;t++)n.nodes[t].loc=e,e+=n.nodes[t].size,e+=f[u];l>0&&rt(n);nt(n,n.depth)}},it=function(n){var u=n.nodes[0].loc,f=n.nodes[n.nodes.length-1].loc+n.nodes[n.nodes.length-1].size,e=(u+f)/2,r=e-n.parent.size/2,o=r-n.parent.loc,i,t;if(n.parent.loc=r,!n.parent.root)for(i=n.parent.childGroup,t=n.parent.childGroupIndex+1;t<i.nodes.length;t++)i.nodes[t].loc+=o},rt=function(n){for(var t=n;null!=t;)it(t),t=t.parent.childGroup},ut=function(n,t){return t.source===n||t.source.getNode&&t.source.getNode()===n},p=function(n,t){var i,w,c;if(!a[n.node.id]){a[n.node.id]=!0;for(var s=v(n.node,e.toolkit),o={nodes:[],loc:0,size:0,parent:n,depth:t+1},l=[],b={},r=0;r<s.length;r++)i=ut(n.node,s[r])?s[r].target:s[r].source,(i.getNode&&(i=i.getNode()),i=e.toolkit.getNode(i),null==i||i===n.node||b[i.id])||(w=e.getSize(h(i)),c=y(i,w,t+1,n,o),c.childGroupIndex=o.nodes.length,o.nodes.push(c),o.size+=w[u]+f[u],l.push(c),b[i.id]=!0);for(tt(o),r=0;r<l.length;r++)p(l[r],t+1)}},w,b;this.defaultParameters={padding:[60,60],orientation:"horizontal",border:0,locationFunction:t.locationFunction};w=this.begin;this.begin=function(n,t){w.apply(this,arguments);c=t.orientation;l="horizontal"===c;u=l?0:1;k=l?"width":"height";f=t.padding;r.length=0;s.length=0;a={};v=t.getChildEdges};this.step=function(n,t){for(var v,s,c,g,b,nt,tt,l,k,w=i.isArray(t.rootNode)?t.rootNode:[t.rootNode],a=0;a<w.length;a++)for(v=w[a],g=e.getSize(v.id),b=y(v,g,0,null,null),b.root=!0,p(b,0,null),l=0,k=function(n,t){var i=0==u?1:0;return d&&n.parent?e.getPosition(h(n.parent.node))[i]+n.parent.dimensions[i]+f[i]:t},s=0;s<r.length;s++){for(r[s].otherAxis=l,c=0;c<r[s].nodes.length;c++)nt=0==u?r[s].nodes[c].loc:k(r[s].nodes[c],l),r[s].nodes[c].parent&&e.getPosition(h(r[s].nodes[c].parent.node)),tt=1==u?r[s].nodes[c].loc:k(r[s].nodes[c],l),e.setPosition(h(r[s].nodes[c].node),nt,tt,!0);r[s].otherAxisSize=o[s]+f[0==u?1:0];l+=r[s].otherAxisSize}e.setDone(!0)};this.getHierarchy=function(){return r};this.getOrientation=function(){return c};b=this.nodeRemoved;this.nodeRemoved=function(){r=[];b.apply(this,arguments)};this.getPadding=function(){return f}};i.extend(n.Hierarchical,n.AbstractHierarchicalLayout)}.call("undefined"!=typeof window?window:this),function(){var n=this,t=n.jsPlumbToolkit;t.Layouts.Decorators.Hierarchy=function(){var i,n,t=[];this.reset=function(n){for(var r=0;r<t.length;r++)n.remove(t[r]);i&&n.remove(i);t.length=0};this.decorate=function(t){var u,r,o;if(t.bounds[0]!=1/0){u=t.layout.getHierarchy();n=(t.layout.getPadding()||[60,60])["horizontal"===f?0:1];for(var f=t.layout.getOrientation(),e="horizontal"===f?["width","height",t.bounds[2]-t.bounds[0]]:["height","width",t.bounds[3]-t.bounds[1]],i=0;i<u.length;i++)r=document.createElement("div"),t.append(r),r.className="level "+(i%2?"odd":"even"),r.style[e[0]]=e[2]+2*n+"px",r.style[e[1]]=u[i].otherAxisSize+"px",o="horizontal"===f?[t.bounds[0]-n,u[i].otherAxis-n/2]:[u[i].otherAxis-n/2,t.bounds[1]-n],t.setAbsolutePosition(r,o)}}}}.call("undefined"!=typeof window?window:this),function(){"use strict";var t=this,i=t.jsPlumbToolkit,n=i.Layouts,r=t.jsPlumbUtil;n.Spring=function(t){var i;this.defaultMagnetized=!0;i=n.AbsoluteBackedLayout.apply(this,arguments);this.defaultParameters={padding:[50,50],iterations:500,maxRepulsiveForceDistance:6,k:2,c:.01,maxVertexMovement:.5,locationFunction:t.locationFunction};var f,u=this.defaultParameters,r={},w=t.absoluteBacked!==!1,h=0,e=1/0,c=-(1/0),o=1/0,l=-(1/0),a=1,v=1,s=0,y=function(n){var t,u;return n.getNode&&(n=n.getNode()),t=r[n.id],t||(u=i.getRandomPosition(n.id,.5,.5),t=r[n.id]={id:n.id,n:n,sp:u,p:[u[0],u[1]],f:[0,0]}),t},p=function(n,t,i){e=Math.min(e,t);o=Math.min(o,i);c=Math.max(c,t);l=Math.max(l,i);n.p[0]=t;n.p[1]=i},b=function(n,t){var f;if(!n.locked||!t.locked){var i=t.p[0]-n.p[0],r=t.p[1]-n.p[1],e=i*i+r*r;if(e<.01&&(i=.1*Math.random()+.1,r=.1*Math.random()+.1,e=i*i+r*r),f=Math.sqrt(e),f<u.maxRepulsiveForceDistance){s++;var o=u.k*u.k/f,h=o*i/f,c=o*r/f;t.f[0]+=t.locked?0:(n.locked?2:1)*h;t.f[1]+=t.locked?0:(n.locked?2:1)*c;n.f[0]-=n.locked?0:(t.locked?2:1)*h;n.f[1]-=n.locked?0:(t.locked?2:1)*c}}},k=function(n,t){var i=y(t.target),r,h,c,l;if(!n.locked||!i.locked){s++;var f=i.p[0]-n.p[0],e=i.p[1]-n.p[1],o=f*f+e*e;o<.01&&(f=.1*Math.random()+.1,e=.1*Math.random()+.1,o=f*f+e*e);r=Math.sqrt(o);r>u.maxRepulsiveForceDistance&&(r=u.maxRepulsiveForceDistance,o=r*r);h=(o-u.k*u.k)/u.k;(void 0==t.weight||t.weight<1)&&(t.weight=1);h*=.5*Math.log(t.weight)+1;c=h*f/r;l=h*e/r;i.f[0]-=i.locked?0:(n.locked?2:1)*c;i.f[1]-=i.locked?0:(n.locked?2:1)*l;n.f[0]+=n.locked?0:(i.locked?2:1)*c;n.f[1]+=n.locked?0:(i.locked?2:1)*l}},d=function(){var t,n;a=i.width/(c-e)*.62;v=i.height/(l-o)*.62;for(t in r)n=r[t],n.locked||(n.sp=nt(n.p),i.setPosition(n.id,n.sp[0],n.sp[1],!0))},g=function(n){return[e+(n[0]-.19*i.width)/a,o+(n[1]-.19*i.height)/v]},nt=function(n){return[.19*i.width+(n[0]-e)*a,.19*i.height+(n[1]-o)*v]};this._nodeMoved=this._groupMoved=function(n,t,i){var u=r[n];u&&(u.sp=[t,i],u.p=g(u.sp))};this.forceMagnetize=function(){for(var n in r)r[n].locked=!1};this.canMagnetize=function(n){return r[n]&&r[n].locked!==!0};this.reset=function(){r={};h=0;e=o=1/0;c=l=-(1/0)};this._nodeRemoved=this._groupRemoved=function(n){delete r[n]};this._nodeAdded=this._groupAdded=function(n,t){if(t&&t.position){var r=y(n.node||n.group);r&&(r.locked=!0,i.setPosition(r.id,t.position.left,t.position.top,!0))}};this.begin=function(){h=0;f=[];Array.prototype.push.apply(f,i.adapter.getNodes());Array.prototype.push.apply(f,i.adapter.getGroups())};this.step=function(n,t){var e,g=[],it=function(n){return g[n]?g[n]:function(){return g[n]=y(f[n]),g[n]}()},r,o,nt,ut,rt,tt,c;for(s=0,e=0;e<f.length;e++)if(r=it(e),!r.group){if(w&&!r.locked&&(o=this.getAbsolutePosition(r.n,t),null!=o&&2==o.length&&!isNaN(o[0])&&!isNaN(o[1]))){p(r,o[0],o[1]);r.sp=r.p;i.setPosition(r.id,o[0],o[1],!0);r.locked=!0;continue}for(nt=e+1;nt<f.length;nt++)ut=it(nt),b(r,ut);for(rt=i.toolkit.getAllEdgesFor(r.n),tt=0;tt<rt.length;tt++)k(r,rt[tt])}if(0!=s)for(e=0;e<f.length;e++)if(c=it(e),!c.group){var a=u.c*c.f[0],v=u.c*c.f[1],l=u.maxVertexMovement;a>l&&(a=l);a<-l&&(a=-l);v>l&&(v=l);v<-l&&(v=-l);p(c,c.p[0]+a,c.p[1]+v);c.f[0]=0;c.f[1]=0}h++;(0==s||h>=u.iterations)&&(d(),i.setDone(!0))};this.end=function(){for(var n in r)r[n].locked=!0}};r.extend(n.Spring,n.AbsoluteBackedLayout)}.call("undefined"!=typeof window?window:this),function(){"use strict";var t=this,n=(t.jsPlumb,t.jsPlumbToolkit),i;n.UI=n.UI||{};i=n.UI;i.ActiveDragFilter=function(n,t,i){var r={};t.bind("connectionDrag",function(t){function s(t,u){v=i.beforeConnect(t,u);c=u.getFullId();v===!1&&null==r[c]&&(r[c]=n.setTargetEnabled(u,!1))}var v,f,u,o,c,e=t.source.jtk.port,h=e?e.getNode():t.source.jtk.node,y=i.getNodeCount(),p=i.getGroupCount(),l,a;if(e)for(s(e,h),f=h.getPorts(),u=0;u<f.length;u++)s(e,f[u]);for(u=0;u<y;u++)for(l=i.getNodeAt(u),s(e||h,l),f=l.getPorts(),o=0;o<f.length;o++)s(e||h,f[o]);for(u=0;u<p;u++)for(a=i.getGroupAt(u),s(e||h,a),f=a.getPorts(),o=0;o<f.length;o++)s(e||h,f[o])});t.bind("connectionDragStop",function(){function e(t){r[t.getFullId()]===!0&&n.setTargetEnabled(t,!0)}for(var f,u,c=i.getNodeCount(),o,h,s,t=0;t<c;t++)for(o=i.getNodeAt(t),e(o),f=o.getPorts(),u=0;u<f.length;u++)e(f[u]);for(h=i.getGroupCount(),t=0;t<h;t++)for(s=i.getGroupAt(t),e(s),f=s.getPorts(),u=0;u<f.length;u++)e(f[u]);r={}})}}.call("undefined"!=typeof window?window:this),function(){"use strict";var e=this,u=e.jsPlumbToolkit.Renderers,r=e.jsPlumbToolkit,o=e.jsPlumbToolkitUtil,i=e.jsPlumbUtil,t=e.jsPlumb,f=e.Rotors,a,v;r.UIState=function(n,t,i){var r,f,e,u;for(r in t)t.hasOwnProperty(r)&&(f="*"===r?"e-state-"+n:"e-state-"+n+"-"+r,e="*"===r?"c-state-"+n:"c-state-"+n+"-"+r,i.registerEndpointType(f,t[r]),i.registerConnectionType(e,t[r]));this.activate=function(r,f,e){r.eachEdge(function(i,r){var o=f.getRenderedConnection(r.getId()),s=e.getEdgeType(r.data),h=s?"c-state-"+n+"-"+s:null;h&&o.addType(h,r.data);t["*"]&&o.addType("c-state-"+n,r.data);u(r,o,r.source,0,"addType",e);u(r,o,r.target,1,"addType",e)});r.eachNode(function(n,r){var o=e.getNodeType(r.data),u=o?t[o]:null,s=f.getRenderedNode(r.id);u&&u.cssClass&&i.addClass(s,u.cssClass);t["*"]&&i.addClass(s,t["*"].cssClass)})};u=function(t,i,r,u,f,e){var o=i.endpoints[u],s=e.getPortType(r.data);o[f]("e-state-"+n+"-"+s);o[f]("e-state-"+n)};this.deactivate=function(r,f,e){r.eachEdge(function(i,r){var o=f.getRenderedConnection(r.getId()),s=e.getEdgeType(r.data),h=s?"c-state-"+n+"-"+s:null;h&&o.removeType(h,r.data);t["*"]&&o.removeType("c-state-"+n);u(r,o,r.source,0,"removeType",e);u(r,o,r.target,1,"removeType",e)});r.eachNode(function(n,r){var o=e.getNodeType(r.data),u=o?t[o]:null,s=f.getRenderedNode(r.id);u&&u.cssClass&&i.removeClass(s,u.cssClass);t["*"]&&i.removeClass(s,t["*"].cssClass)})}};var c=u.atts={NODE:"data-jtk-node-id",PORT:"data-jtk-port-id",GROUP:"data-jtk-group-id"},l=u.els={SOURCE:"JTK-SOURCE",PORT:"JTK-PORT",TARGET:"JTK-TARGET"},s=r.Classes,h=r.Constants,n=r.Events;u.mouseEvents=["click","dblclick","contextmenu","mousedown","mouseup","mousemove","mouseenter","mouseleave","mouseover"];u.createElement=function(n,i){var r={width:n.width,height:n.height,position:n.position||h.absolute},f={},u;return n.display&&(r.display=n.display),n.id&&(f.id=n.id),n.top&&(r.top=n.top+"px"),n.left&&(r.left=n.left+"px"),n.right&&(r.right=n.right+"px"),n.bottom&&(r.bottom=n.bottom+"px"),u=t.createElement(n.type||h.div,r,n.clazz,f),null!=i&&t.appendElement(u,i),u};a=u.DOMElementAdapter=function(n){var i=this.getJsPlumb(),r=i.getElement(n.container);this.getWidth=function(){return i.getSize(r)[0]};this.getHeight=function(){return i.getSize(r)[1]};this.append=function(n){var t=i.getElement(n);i.appendElement(t,r)};this.remove=function(n){var t=i.getElement(n);i.removeElement(t)};this.setAbsolutePosition=t.setAbsolutePosition;this.getOffset=function(n,t){return i.getOffset(n,t)}};v=u.AbstractRenderer=function(u){function hi(n){it=!0;try{n()}catch(n){jsPlumbUtil.log("An error occurred while ignoring Toolkit events",n)}finally{it=!1}}function ci(n,t,i){var r,u,f;null==n.value("jtk-processed")&&(n.setValue("jtk-processed",!0),r=lt(n,t,i),u=a.addEndpoint(n.element,r),pt[t.id+"."+r.portId]=u,f=n.port||t.addPort({id:r.portId}),u.graph={node:t,port:f},nt.onUpdate(n.element,function(){}))}function ir(n,i,r){var u,o,s,h,f,c,l;null==n.value("jtk-processed")&&(n.setValue("jtk-processed",!0),u=lt(n,i,r),null!=u.portId&&(g[i.id+"."+u.portId]=n.element,n.element.jtk=n.element.jtk||{},n.element.jtk.port=e.addPort(i,{id:u.portId,type:u.portType||"default"},!0)),o=n.value("filter"),o&&(s=n.value("filter-exclude"),h="true"===s,u.filter=o,u.filterExclude=h),"true"===n.value("is-source")&&(u.isSource=!0),delete u.uniqueEndpoint,u.extract={},n.findDataValues(u.extract),c=n.element._katavorioDrop?n.element._katavorioDrop.length:0,a.makeSource(n.element,u),l=n.element._katavorioDrop?n.element._katavorioDrop.length:0,l>c&&(f=n.element._katavorioDrop[n.element._katavorioDrop.length-1]),nt.onUpdate(n.element,function(n){var u=t.getSelector(n,"jtk-source"),r;1===u.length&&(r=lt(u[0],i),r.scope&&(a.setSourceScope(n,r.scope,r.edgeType),f&&f.k.setDropScope(f,r.scope)))}))}function rr(n,i,r){var u,f;if(null==n.value("jtk-processed")){n.setValue("jtk-processed",!0);u=lt(n,i,r);null!=u.portId&&(g[i.id+"."+u.portId]=n.element,n.element.jtk=n.element.jtk||{},n.element.jtk.port=e.addPort(i,{id:u.portId,type:u.portType||"default"},!0));"true"===n.value("is-target")&&(u.isTarget=!0);a.makeTarget(n.element,u);f=n.element._katavorioDrop[n.element._katavorioDrop.length-1];nt.onUpdate(n.element,function(n){var u=t.getSelector(n,"jtk-target"),r;1===u.length&&(r=lt(u[0],i),r.scope&&(f.targetDef.def.scope=r.scope,f.k.setDropScope(f,r.scope)))})}}var kt,dt,it,ti,di,ii,ct,ri,gi,yt,nr,b,ot,ui,tr,si,d,ft;u=u||{};var bt=function(n){var i=t.createElement("div",{border:"1px solid #456",position:"absolute"},s.NODE);return i.innerHTML=n.name||n.id,i},ur='<div data-jtk-node-id="${id}" class="'+s.NODE+'"><\/div>',li={rotors:{render:function(n,t){return nt.template(n,t).childNodes[0]}}},nt=f.newInstance({defaultTemplate:ur,templateResolver:u.templateResolver,templates:u.templates}),v=this,e=u.toolkit,p=new r.Layouts.EmptyLayout(v),at=t.getElement(u.container),fr=!(u.elementsDraggable===!1),er=u.elementsDroppable===!0,et=!1,ai=u.refreshAutomatically!==!1,or=u.templateRenderer?i.isString(u.templateRenderer)?li[u.templateRenderer]:{render:u.templateRenderer}:li["rotors"],sr=u.enhancedView!==!1,vi=u.assignPosse||function(){return null},yi=u.modelLeftAttribute||"left",pi=u.modelTopAttribute||"top",hr=u.storePositionsInModel!==!1,cr=i.merge(u.jsPlumb||{}),a=u.jsPlumbInstance||t.getInstance(cr,u.overrideFns),wi=a.getId(at);a.bind("beforeDrop",function(n){var t=n.connection,i=t.endpoints[0].graph||t.source.jtk,r=t.endpoints[1].graph||t.target.jtk,u=i.port||i.node||i.group,f=r.port||r.node||r.group,o=n.connection.edge;return null==o?e.beforeConnect(u,f,n.connection.getData()):e.beforeMoveConnection(u,f,o)});a.bind("beforeDrag",function(n){var t=n.endpoint.graph||n.source.jtk,r=t.port||t.node,u=n.endpoint.connectionType,i=e.beforeStartConnect(r,u);return i===!1&&n.endpoint.isTemporarySource&&n.endpoint._deleteOnDetach&&a.deleteEndpoint(n.endpoint),i});a.bind("beforeDetach",function(n,t){var i=n.endpoints[0].graph||n.source.jtk,r=n.endpoints[1].graph||n.target.jtk,u=i.port||i.node,f=r.port||r.node,o=n.edge;return e.beforeDetach(u,f,o,t)});a.bind("beforeStartDetach",function(n){var t=n.endpoint.graph||n.source.jtk,i=t.port||t.node,r=n.connection.edge;return e.beforeStartDetach(i,r)});a.bind("connectionEdit",function(n){n.edge&&(n.edge.geometry=n.getConnector().getGeometry())});i.EventGenerator.apply(this,arguments);u.activeFiltering&&new r.UI.ActiveDragFilter(v,a,e);this.getJsPlumb=function(){return a};this.getToolkit=function(){return e};var lr=[n.canvasClick,n.canvasDblClick,n.nodeAdded,n.nodeDropped,n.nodeRemoved,n.nodeRendered,n.groupAdded,n.groupRemoved,n.groupMoveEnd,n.groupMemberAdded,n.groupMemberRemoved,n.groupCollapse,n.groupExpand,n.nodeMoveStart,n.nodeMoveEnd,n.portAdded,n.portRemoved,n.edgeAdded,n.edgeRemoved,n.edgeTypeChanged,n.nodeTypeChanged,n.portTypeChanged,n.dataLoadEnd,n.anchorChanged,n.objectRepainted,n.modeChanged,n.lassoEnd,n.pan,n.zoom,n.relayout,n.click,n.tap,n.stateRestored,n.startOverlayAnimation,n.endOverlayAnimation],ar=v.bind,tt=a.bind;if(this.setHoverSuspended=a.setHoverSuspended,this.isHoverSuspended=a.isHoverSuspended,this.setJsPlumbDefaults=function(n){delete n.Container;a.restoreDefaults();a.importDefaults(n)},this.bind=function(n,t){lr.indexOf(n)==-1?tt(n,t):ar(n,t)},u.events)for(kt in u.events)this.bind(kt,u.events[kt]);if(u.interceptors)for(dt in u.interceptors)this.bind(dt,u.interceptors[dt]);it=!1;tt(n.connection,function(t){if(null==t.connection.edge){t.sourceEndpoint.getParameter("nodeId")||t.sourceEndpoint.setParameter("nodeId",rt[t.sourceEndpoint.elementId].id);t.targetEndpoint.getParameter("nodeId")||t.targetEndpoint.setParameter("nodeId",rt[t.targetEndpoint.elementId].id);var y=t.sourceEndpoint.getParameter("portType"),r=b.getPortDefinition(y),u=null!=r&&r.edgeType?r.edgeType:t.sourceEndpoint.getParameter("edgeType")||"default",c=t.sourceEndpoint.getParameter("nodeId"),f=t.sourceEndpoint.getParameter("portId"),l=t.targetEndpoint.getParameter("nodeId"),o=t.targetEndpoint.getParameter("portId"),s=c+(f?"."+f:""),h=l+(o?"."+o:""),i={sourceNodeId:c,sourcePortId:f,targetNodeId:l,targetPortId:o,type:u,source:e.getNode(s),target:e.getNode(h),sourceId:s,targetId:h},p=e.getEdgeFactory()(u,t.connection.getData()||{},function(r){i.edge=e.addEdge({source:s,target:h,cost:t.connection.getCost(),directed:t.connection.isDirected(),data:r,addedByMouse:!0},v);k[i.edge.getId()]=t.connection;t.connection.edge=i.edge;gt(u,i.edge,t.connection);i.addedByMouse=!0;v.fire(n.edgeAdded,i)});p===!1&&a.deleteConnection(t.connection)}});tt(n.connectionMoved,function(n){var i=0===n.index?n.newSourceEndpoint:n.newTargetEndpoint,t=i.graph||i.element.jtk;hi(function(){e.edgeMoved(n.connection.edge,t.port||t.node||t.group,n.index)})});tt(n.connectionDetached,function(t){hi(function(){e.removeEdge(t.connection.edge)});var i=t.sourceEndpoint.getParameters(),r=t.targetEndpoint.getParameters(),u=i.nodeId+(i.portId?"."+i.portId:""),f=r.nodeId+(r.portId?"."+r.portId:"");v.fire(n.edgeRemoved,{sourceNodeId:i.nodeId,targetNodeId:r.nodeId,sourcePortId:i.portId,targetPortId:r.portId,sourceId:u,targetId:f,source:e.getNode(u),target:e.getNode(f),edge:t.connection.edge})});tt(n.groupDragStop,function(i){v.getLayout().setPosition(i.group.id,i.pos[0],i.pos[1],!0);i.uigroup=i.group;v.fire(n.groupMoveEnd,t.extend(i,{group:e.getGroup(i.uigroup.id)}))});tt(n.groupMemberAdded,function(t){if(!et&&t.el.jtk.node){var i=e.addToGroup(t.el.jtk.node,t.group.id);i&&v.fire(n.groupMemberAdded,{node:t.el.jtk.node,group:i,uigroup:t.group});ct()}});tt(n.groupMemberRemoved,function(t){if(!et&&t.el.jtk.node){var i=e.removeFromGroup(t.el.jtk.node);i&&(v.nodeRemovedFromGroup(t.el),v.fire(n.groupMemberRemoved,{node:t.el.jtk.node,ugroup:i,igroup:t.group}));ct()}});tt(n.groupCollapse,function(t){var i=e.getGroup(t.group.id);i&&v.fire(n.groupCollapse,{group:i,uigroup:t.group})});tt(n.groupExpand,function(t){var i=e.getGroup(t.group.id);i&&v.fire(n.groupExpand,{group:i,uigroup:t.group})});var y={},rt={},g={},w={},st=[],ht={},ut=[],vr=function(n){var t=ut.indexOf(n);t!==-1&&ut.splice(t,1)};this.getNodeCount=function(){return ut.length};this.getNodeAt=function(n){return ut[n]};this.getNodes=function(){return ut};this.getNode=function(n){return y[n]};this.getGroupCount=function(){return st.length};this.getGroupAt=function(n){return st[n]};this.getGroups=function(){return st};var k={},bi=function(n){return k[n.getId()]},yr=function(n){for(var i=[],t=0;t<n.length;t++)i.push(k[n[t].getId()]);return i},pr=function(n,t,i,r){r.bind(n,function(n,u){t.apply(t,[{edge:i,e:u,connection:r,toolkit:e,renderer:v}])})},gt=function(n,t,i){var r,u;if(!i.getParameter("edge")&&(r=b.getEdgeDefinition(n),r&&r.events))for(u in r.events)pr(u,r.events[u],t,i)},wr=function(t){v.fire(n.edgeRemoved,{sourceNodeId:t.source.getNode?t.source.getNode().getId:t.source.getFullId(),targetNodeId:t.target.getNode?t.target.getNode().getId:t.target.getFullId(),sourcePortId:"Port"===t.source.objectType?t.source.id:null,targetPortId:"Port"===t.target.objectType?t.target.id:null,sourceId:t.source.getFullId(),targetId:t.target.getFullId(),source:t.source,target:t.target,edge:t})};this.setSuspendRendering=function(n,t){et=n;a.setSuspendDrawing(n);t&&this.refresh()};this.batch=function(n){this.setSuspendEvents(!0);e.batch(n);this.setSuspendEvents(!1)};var ni=function(n,t){var r,u;et?vt.push([n,t]):(r=vi(t),null!=r&&(u=i.isArray(r)?r:[r],u.unshift(n),a.addToPosse.apply(a,u)))},ki=function(){for(var n=0;n<vt.length;n++)ni.apply(this,vt[n])},vt=[];this.bindToolkitEvents!==!1&&(ti=function(){vt.length=0;a.setSuspendDrawing(!0);this.setSuspendRendering(!0)}.bind(this),e.bind(n.dataLoadStart,ti),e.bind(n.dataAppendStart,ti),e.bind(n.dataLoadEnd,function(){this.setSuspendRendering(!1);ki();a.getGroupManager().refreshAllGroups();yt();v.relayout();a.setSuspendDrawing(!1,!0);p&&v.fire(n.dataLoadEnd)}.bind(this)),e.bind(n.dataAppendEnd,function(){this.setSuspendRendering(!1);ki();v.refresh();a.setSuspendDrawing(!1,!0);p&&v.fire(n.dataAppendEnd)}.bind(this)),di=function(n,t,i){var r=w[i.id],u;r&&(u=r.querySelector("[jtk-group-content]")||r,u.appendChild(n),a.addToGroup(i.id,n,!0),v.nodeAppendedToGroup(n,r,i))},ii=function(t,i){var r=y[t.id],o,u,f;if(null==r){if(o=b.getNodeDefinition(e.getNodeType(t.data)),o.ignore===!0)return!1;if(r=br(t,t.data,t),!r)throw new Error("Cannot render node");u=a.getId(r);y[t.id]=r;rt[u]=t;ut.push(t);r.jtk={node:t};null==t.group?v.append(r,u,i?i.position:null):di(r,t,t.group);ni(r,t);wt(r,t);f={node:t,el:r,id:t.id};v.getLayout().nodeAdded(f,i);v.fire(n.nodeAdded,f)}return r},e.bind(n.nodeAdded,function(n){var t,r=n.node,f=ii(r,n.eventInfo),i,u;if(null!=f){for(i=a.getSelector(f,"[data-port-id]"),t=0;t<i.length;t++)u=i[t].getAttribute("data-port-id"),g[r.id+"."+u]=i[t],i[t].jtk=i[t].jtk||{node:r,port:r.getPort(u)};v.refresh(!0)}}),e.bind(n.nodeRemoved,function(t){var i,r;v.getLayout().nodeRemoved(t.nodeId);i=y[t.nodeId];v.fire(n.nodeRemoved,{node:t.nodeId,el:i});r=a.getId(i);nt.remove(i);a.remove(i);delete y[t.nodeId];delete rt[r];vr(t.node);delete i.jtk;v.refresh(!0)}),ct=function(){u.relayoutOnGroupUpdate&&v.relayout()},e.bind("group:addMember",ct),e.bind("group:removeMember",ct),ri=function(r,f){var o=w[r.id],c,l,y,s;if(null==o){if(c=b.getGroupDefinition(e.getNodeType(r.data)),c.ignore===!0)return!1;if(o=dr(r,r.data,r),!o)throw new Error("Cannot render Group");l=a.getId(o);w[r.id]=o;st.push(r);ht[l]=r;o.jtk={group:r};v.append(o,l,f?f.position:null);ni(o,r);wt(o,r);y={node:r,el:o};s={el:o,id:r.id};t.extend(s,{dragOptions:u.dragOptions||{}});s.dragOptions[t.dragEvents[h.stop]]=i.wrap(s.dragOptions[t.dragEvents[h.stop]],function(t){t.el.jtk&&t.el.jtk.group&&(s.dragOptions.magnetize?t.pos=v.getLayout().setMagnetizedPosition(t.el.jtk.group.id,t.pos[0],t.pos[1],!0):v.getLayout().setPosition(t.el.jtk.group.id,t.pos[0],t.pos[1],!0),hr!==!1&&(v.storePositionInModel({id:t.el.jtk.group.id,group:!0,leftAttribute:yi,topAttribute:pi}),e.fire(n.groupUpdated,{group:t.el.jtk.group},null)),v.fire(n.groupMoveEnd,{el:t.el,group:t.el.jtk.group,pos:t.pos,e:t.e,eventPosition:t.pos}))});a.addGroup(t.extend(s,c));v.getLayout().groupAdded({group:r,el:o,id:r.id},f);v.fire(n.groupAdded,y)}return o},e.bind(n.groupAdded,function(n){var t=n.group,i=ri(t,n.eventInfo);null!=i&&v.refresh(!0)}),e.bind(n.groupRemoved,function(n){var t=n.group,i,r;v.getLayout().groupRemoved(t.id);i=w[t.id];r=a.getId(i);a.removeGroup(t.id,n.removeChildNodes,!0,!1);delete w[t.id];delete ht[r];delete i.jtk;v.refresh(!0)}),this.expandGroup=function(n){a.expandGroup("string "==typeof n?n:n.id)},this.collapseGroup=function(n){a.collapseGroup("string "==typeof n?n:n.id)},this.toggleGroup=function(n){a.toggleGroup("string "==typeof n?n:n.id)},gi=function(n,t){for(var u,e,o=n.getNodes(),i=0,r=0,s=v.getLayout(),c=a.getGroup(n.id),h=c.getDragArea(),f=0;f<o.length;f++)u=s.getPosition(o[f].id),isNaN(u[0])||isNaN(u[1])||(e=s.getSize(o[f].id),i=Math.max(i,u[0]+e[0]),r=Math.max(r,u[1]+e[1]));i=t.maxSize?Math.min(t.maxSize[0],i):i;r=t.maxSize?Math.min(t.maxSize[1],r):r;h.style.width=i+"px";h.style.height=r+"px";s.setSize(n.id,[i,r])},yt=function(){var i,n,t;for(i in w)n=e.getGroup(i),n&&(t=b.getGroupDefinition(e.getNodeType(n.data)),t.autoSize&&gi(n,t))},v.autoSizeGroups=yt,nr=function(t,i){return function(){var r=fi(t),u;r.doNotFireConnectionEvent=!0;i&&(r.geometry=i);e.isDebugEnabled()&&console.log("Renderer","adding edge with params",r);u=a.connect(r);u.edge=t;k[t.getId()]=u;gt(r.type,t,u);v.fire(n.edgeAdded,{source:t.source,target:t.target,connection:u,edge:t,geometry:i});v.refresh(!0)}},e.bind(n.edgeAdded,function(n){var t,i,r;if(!it&&n.source!==v){if(t=n.edge,i=b.getEdgeDefinition(e.getEdgeType(t.data||{})),i&&i.ignore===!0)return;r=nr(t,n.geometry);u.connectionHandler?u.connectionHandler(t,r):r()}}),e.bind(n.edgeRemoved,function(n){if(!it&&n.source!==v){var t=n.edge,i=k[t.getId()];i&&(e.isDebugEnabled()&&console.log("Renderer","removing edge",t),wr(t),delete k[t.getId()],null!=i._jsPlumb&&a.deleteConnection(i,{fireEvent:!1}))}}),e.bind(n.edgeTypeChanged,function(n){var r,i,t;if(!it&&n.source!==v&&(r=n.obj,i=k[r.getId()],i)){if(t=b.getEdgeDefinition(n.newType),t&&t.ignore===!0)return;i.setType(n.newType);t.connector&&i.setConnector(t.connector)}}),e.bind(n.edgeTarget,function(n){if(!it){var t=n.edge,r=k[t.getId()],u=y[t.target.getFullId()];r?a.silently(function(){null!=u?(e.isDebugEnabled()&&console.log("target change",r),a.setTarget(r,u)):(delete k[t.getId()],a.detach({connection:r,forceDetach:!0,fireEvent:!1}))}):null!=u&&e.isDebugEnabled()&&i.log("Target for Edge "+t.getId()+" changed to Node "+u.id+"; we have no valid connection.")}}),e.bind(n.edgeSource,function(n){if(!it){var t=n.edge,u=k[t.getId()],r=y[t.source.getFullId()];u?a.silently(function(){null!=r?a.setSource(u,r):(delete k[t.getId()],a.detach({connection:u,forceDetach:!0,fireEvent:!1}))}):null!=r&&e.isDebugEnabled()&&i.log("Source for Edge "+t.getId()+" changed to Node "+r.id+"; we have no valid connection.")}}),e.bind("graphClearStart",function(){var n,t;for(n in w)"undefined"!=typeof w[n]._rotors&&nt.remove(w[n]),a.silently(function(){a.getGroupManager().removeGroup(n)}),delete w[n].jtk;for(t in y)"undefined"!=typeof y[t]._rotors&&nt.remove(y[t]),a.remove(y[t],!0),delete y[t].jtk;p&&p.clear();a.setSuspendEvents(!0);a.batch(a.deleteEveryEndpoint,!0);a.setSuspendEvents(!1);ut.length=0;st.length=0;k={};y={};w={};rt={};ht={};g={};pt={}}),e.bind(n.portAdded,function(t){var r=y[t.node.id]||w[t.node.id],u=b.getPortDefinition(e.getPortType(t.data)),i;u.isEndpoint?ci(new gr(t.data,r,t.port),t.node):(i=kr(t.port,t.data,t.node),g[t.node.id+e.getGraph().getPortSeparator()+t.port.id]=i,wt(a.getElement(i),t.node),v.fire(n.portAdded,{node:t.node,nodeEl:r,port:t.port,portEl:i}));a.recalculateOffsets(r);v.refresh(!0)}),e.bind(n.portRemoved,function(t){var i=y[t.node.id]||w[t.node.id],r=t.node.id+"."+t.port.id,u=g[r];a.setSuspendEvents(!0);a.remove(u);a.setSuspendEvents(!1);delete g[r];v.fire(n.portRemoved,{node:t.node,port:t.port,portEl:u,nodeEl:i});a.recalculateOffsets(i);v.refresh(!0)}),e.bind(n.edgeUpdated,function(n){var i=k[n.edge.getId()],t;i&&(t=fi(n.edge),i.setType(t.type,t.data))}),e.bind(n.portUpdated,function(n){var t=g[n.port.getFullId()];t&&(nt.update(t,n.port.data),v.repaint(y[n.node.id]))}),e.bind(n.nodeUpdated,function(n){var t=y[n.node.getFullId()],r,u;t&&(nt.update(t,n.node.data),wt(t,n.node),r=vi(n.node),null!=r?(u=i.isArray(r)?r:[r],u.unshift(t),a.setPosse.apply(a,u)):a.removeFromAllPosses(t),v.repaint(t))}));this.setView=function(n){var t=i.merge(e.getModel(),n||{});b=new r.Model(t,a)};this.setView(u.view);this.getView=function(){return b};ot=[];ui=function(n){return null==n?e:"string"==typeof n?e.select(n,!0):n.jtk?e.select(n.jtk.port||n.jtk.node,!0):n};this.activateState=function(n,t){var i=b.getState(n);i&&(t=ui(t),i.activate(t,v,e),ot.push(i))};this.deactivateState=function(n,t){var r=b.getState(n);r&&(t=ui(t),r.deactivate(t,v,e),i.removeWithFunction(ot,function(n){return n==r}))};this.resetState=function(){for(var n=0;n<ot.length;n++)ot[n].deactivate(e,v,e);ot.length=0};var fi=function(n){var i=e.getEdgeType(n.data),t={type:i,connectionType:i,data:n.data,cost:n.getCost(),directed:n.isDirected()},r=b.getEdgeDefinition(i),u,f;return!function(n){if(r)for(var i=0;i<n.length;i++)r[n[i]]&&(t[n[i]]=r[n[i]])}(["connector","endpoints","endpoint","endpointStyles","endpointStyle"]),t.anchor&&!t.anchors&&(t.anchors=[t.anchor,t.anchor],delete t.anchor),t.endpoint&&!t.endpoints&&(t.endpoints=[t.endpoint,t.endpoint],delete t.endpoint),u=function(n,t,i,r,u){if(r&&r[i]){var f=n[t]||[r[i],r[i]];f[u]=r[i];n[t]=f}},f=function(i,r){var o,s;if(n[i].getNode){var c=n[i].getNode(),f=n[i].getFullId(),h=pt[f]||g[f];t[i]=null!=h?h:g[f];null==t[i]&&(t[i]=y[e.getNodeId(c.data)]);o=b.getPortDefinition(n[i].getType());u(t,"anchors","anchor",o,r);u(t,"endpoints","endpoint",o,r)}else s=e.getNodeId(n[i].data),t[i]=y[s]||w[s]},f("source",0),f("target",1),t},ei=function(n,i,r,u,f,o,s,h){return function(c,l,y){var d,tt=i(l),p=null,it=r(l),w=b[u](it),k=l,g,nt,rt;if(sr){k=t.extend({},w?w.parameters||{}:{});t.extend(k,l);g={};for(d in k)k.hasOwnProperty(d)&&null!=k[d]&&(g[d]=k[d].constructor==Function?k[d](l):k[d]);k=g}if(w?(nt=w.template||"jtk-template-"+it,p=w.templateRenderer?w.templateRenderer(nt,k,e,n):or.render(nt,k,e,n)):p=f(k,tt),p=a.getElement(p),p.setAttribute(h,tt),t.addClass(p,s),p.jtk=p.jtk||{},p.jtk[n]=c,p.jtk.node=y,o&&fr&&ft.makeDraggable&&ft.makeDraggable(p,w.dragOptions),er&&ft.makeDroppable&&ft.makeDroppable(p,w.dropOptions),rt=function(n){a.on(p,n,function(t){w.events[n]({node:y,el:p,e:t,toolkit:e,renderer:v})})},w&&w.events)for(d in w.events)rt(d);return p}},br=ei("node",e.getNodeId,e.getNodeType,"getNodeDefinition",bt,!0,s.NODE,c.NODE),kr=ei("port",e.getPortId,e.getPortType,"getPortDefinition",bt,!1,s.PORT,c.PORT),dr=ei("group",e.getNodeId,e.getNodeType,"getGroupDefinition",bt,!1,s.GROUP,c.GROUP);this.initialize=function(){var n,i,f,l,t,v,p,o,r,c,h,s;if(e.setSuspendGraph(!0),a.setSuspendDrawing(!0),u.jsPlumbInstance){v=u.jsPlumbInstance.select();v.each(function(n){k[n.edge.getId()]=n});i=u.jsPlumbInstance.getManagedElements();for(p in i)o=i[p].el,y[o.jtk.node.id]=o,rt[u.jsPlumbInstance.getId(o)]=o.jtk.node;ft.doImport&&ft.doImport(y,k)}else{for(n=0,f=e.getGroupCount();n<f;n++)l=e.getGroupAt(n),ri(l);for(n=0,f=e.getNodeCount();n<f;n++)i=e.getNodeAt(n),ii(i);for(n=0,f=e.getNodeCount();n<f;n++)if(i=e.getNodeAt(n),y[i.id])for(r=e.getAllEdgesFor(i),t=0;t<r.length;t++)if(r[t].source==i||r[t].source.getNode&&r[t].source.getNode()==i){if(c=b.getEdgeDefinition(e.getNodeType(r[t].data)),c&&c.ignore===!0)continue;h=fi(r[t]);h.doNotFireConnectionEvent=!0;s=a.connect(h);null!=s&&(s.edge=r[t],k[r[t].getId()]=s,gt(h.type,r[t],s))}}yt();this.relayout();a.setSuspendDrawing(!1,!0);e.setSuspendGraph(!1)};this.getContainer=function(){return at};this.getContainerId=function(){return wi};this.getRenderedElement=function(n){if(null==n)return null;var t=n.getFullId();return"Port"===n.objectType?g[t]:"Group"===n.objectType?w[t]:y[t]};this.getRenderedNode=function(n){return y[n]};this.getRenderedGroup=function(n){return w[n]};this.getRenderedPort=function(n){return g[n]};this.getRenderedConnection=function(n){return k[n]};this.getRenderedEndpoint=function(n){var t=d(n),i=null;return t&&t.obj&&"Port"===t.obj.objectType&&a.selectEndpoints({element:t.el}).each(function(n){n.graph&&n.graph.port&&n.graph.port===t.obj&&(i=n)}),i};tr=function(n){var t=a.extend({container:at,getElementForNode:function(n){return y[n]||w[n]}},n);if(t.jsPlumbToolkit=e,t.adapter=v,!r.Layouts[t.type])throw"no such layout ["+t.type+"]";return t.locationFunction||(t.locationFunction=function(n){return[f.data(n.data,yi),f.data(n.data,pi)]}),new r.Layouts[t.type](t)};this.adHocLayout=function(n){if(n){var t=p;this.setLayout(n);p=t}};this.setLayout=function(n,i){if(n){var r=t.extend({jsPlumb:this.getJsPlumb()},n);p=tr(r);i||v.refresh()}};this.getLayout=function(){return p};this.getMagnetizedElements=function(){return null!=p?p.getMagnetizedElements():[]};this.magnetize=function(n){null!=p&&p.magnetize(n)};this.refresh=function(n){et||n&&!ai||(p?p.layout(function(){"undefined"!=typeof window?window.setTimeout(a.repaintEverything,0):a.repaintEverything()}):a.repaintEverything())};this.setRefreshAutomatically=function(n){ai=n};this.relayout=function(n){et||(p?p.relayout(n,function(){a.repaintEverything();this.fire("relayout",this.getBoundsInfo())}.bind(this)):a.repaintEverything())};this.getPath=function(n){var t=e.getPath(n);return t&&(t.setVisible=function(n){v.setVisible(t,n)},t.addNodeClass=function(n){t.eachNode(function(t,i){a.addClass(y[i.id],n)})},t.removeNodeClass=function(n){t.eachNode(function(t,i){a.removeClass(y[i.id],n)})},t.addEdgeClass=function(n){t.eachEdge(function(t,i){k[i.getId()].addClass(n)})},t.removeEdgeClass=function(n){t.eachEdge(function(t,i){k[i.getId()].removeClass(n)})},t.addClass=function(n){this.addNodeClass(n);this.addEdgeClass(n)},t.removeClass=function(n){this.removeNodeClass(n);this.removeEdgeClass(n)}),t};this.getPosition=function(n){var t=this.getLayout(),i;if(t)return i=d(n).id,t.getPosition(i)};this.getSize=function(n){return a.getSize(d(n).el)};this.getCoordinates=function(n){var t=this.getLayout();if(t){var i=d(n),r=t.getPosition(i.id),u=a.getSize(i.el);return{x:r[0],y:r[1],w:u[0],h:u[1]}}};var pt={},lt=function(n,r,u){var c=n.value("port-id"),l=n.value("port-type")||"default",k=n.value("scope")||a.getDefaultScope(),it=e.getNodeType(r),g=b.getNodeDefinition(it),rt=b.getPortDefinition(c,g),ut=b.getPortDefinition(l,g),h=i.merge(ut,rt),f=null==h?{}:o.populate(h,r.data),ft=function(n){return function(t){var i=r.getPort(c),u=[{portId:c,nodeId:r.id,port:i,node:r,portType:l,endpoint:t.endpoint,anchor:t.anchor}];n.apply(n,u)}},et=function(n){return function(t){var i=[{connection:t.connection||t,source:d(t.source),target:d(t.target),scope:t.scope}];return n.apply(n,i)}},y=f.edgeType||n.value("edge-type")||"default",ot={paintStyle:"connectorStyle",hoverPaintStyle:"connectorHoverStyle",overlays:"connectorOverlays",endpointStyle:"paintStyle"},p=b.getEdgeDefinition(y),s,w;if(p)for(s in p)w=ot[s]||s,null==f[w]&&(f[w]=p[s]);if(f.connectionType=y,f.portId=c,f.portType=l,f.scope=k,f.parameters=f.parameters||{},f.parameters.portId=c,f.parameters.portType=l,f.parameters.edgeType=y,f.parameters.scope=k,f.parameters.nodeId=r.id,f.events={},h.events)for(s in h.events)f.events[s]=ft(h.events[s]);if(h.interceptors)for(s in h.interceptors)f[s]=et(h.interceptors[s]);var nt=n.value("anchor-x"),tt=n.value("anchor-y"),st=n.value("orientation-x"),ht=n.value("orientation-y"),ct=n.value("offset-x"),lt=n.value("offset-y");return null!=nt&&null!=tt&&(f.anchor=[parseFloat(nt),parseFloat(tt),parseInt(st||"0",10),parseInt(ht||"0",10),parseFloat(ct||"0"),parseFloat(lt||"0")]),t.extend(f,u||{}),f.events.anchorChanged=function(n){v.fire("anchorChanged",{portId:c,nodeId:r.id,portType:l,node:r,port:r.getPort(c),endpoint:n.endpoint,anchor:n.anchor})},f},oi=function(n){this.element=n.parentNode;this.value=function(t,i){var r=n.getAttribute(t);return null==r?i:r};this.setValue=function(t,i){n.setAttribute(t,i)};this.findDataValues=function(t){for(var r,i=0;i<n.attributes.length;i++)r=n.attributes[i],0===r.name.indexOf("data-")&&(t[r.value]=r.name.split("-")[1])}},gr=function(n,t,i){this.element=t;this.port=i;this.value=function(t,i){var r=n[t.replace(/(\-\w)/g,function(n){return n[1].toUpperCase()})];return null==r?i:r};this.findDataValues=function(t){for(var i in n)0===i.indexOf("data-")&&(t[n[i]]=i.split("-")[1])};this.setValue=function(n,i){t.setAttribute(n,i)}},wt=function(n,i){for(var u,f=t.getSelector(n,l.PORT),e=t.getSelector(n,l.SOURCE),o=t.getSelector(n,l.TARGET),r=0;r<e.length;r++)u=new oi(e[r]),ir(u,i);for(r=0;r<o.length;r++)u=new oi(o[r]),rr(u,i);for(r=0;r<f.length;r++)u=new oi(f[r]),ci(u,i)};return this.setLayout(u.layout,!0),this.storePositionsInModel=function(n){var t,i;n=n||{};var u=n.leftAttribute||"left",o=n.topAttribute||"top",r=p.getPositions();for(t in r)i=e.getNode(t)||e.getGroup(t),i&&(f.data(i.data,u,r[t][0]),f.data(i.data,o,r[t][1]))},this.storePositionInModel=function(n){var r="string"==typeof n?n:n.id,u="string"==typeof n?"left":n.leftAttribute||"left",o="string"==typeof n?"top":n.topAttribute||"top",t=p.getPosition(r),i=e[n.group?"getGroup":"getNode"](r);return i&&(f.data(i.data,u,t[0]),f.data(i.data,o,t[1])),t},si=function(n,t,i,r,u,f,e){return n=n||d(t),n&&(p.setPosition(n.id,i,r),u||(a.setAbsolutePosition(n.el,[i,r],f,e),a.revalidate(n.el))),n},this.setPosition=function(n,t,i,r){return si(null,n,t,i,r)},this.animateToPosition=function(n,t,i,r){var u=d(n),f;u&&(f=p.getPosition(u.id),si(u,n,t,i,!1,[f[0],f[1]],r))},this.setVisible=function(n,t,i){function s(n){return n.endpoints[0].element._jtkVisible!==!1&&n.endpoints[1].element._jtkVisible!==!1}function f(n,t,i){if(1===t.connections.length)t.setVisible(i,!0);else if(i)t.setVisible(!0,!0);else{for(var r=0;r<t.connections.length;r++)if(t.connections[r]!==n&&t.connections[r].isVisible())return;t.setVisible(!1,!0)}}var u;if(null!=n){var o=function(n){var r=bi(n),u;r&&(u=!t||s(r),u&&(r.setVisible(t),i||(f(r,r.endpoints[0],t),f(r,r.endpoints[1],t))))},h=function(n,r){if(r&&(r.style.display=t?"block":"none",r._jtkVisible=t,!i))for(var f=e.getAllEdgesFor(n),u=0;u<f.length;u++)o(f[u])},c=function(n){var i=n.getFullId(),r=pt[i];r.setVisible(t)},r=function(n){var t=d(n);switch(t.type){case"Edge":o(t.obj);break;case"Node":h(t.obj,t.el);break;case"Port":c(t.obj)}};if(n.eachNode&&n.eachEdge)n.eachNode(function(n,t){r(t)}),n.eachEdge(function(n,t){r(t)});else if(n.length&&"string"!=typeof n)for(u=0;u<n.length;u++)r(n[u]);else r(n)}},d=function(n){return n instanceof a.getDefaultConnectionType()&&(n=n.edge),e.getObjectInfo(n,function(n){return n.getNode?g[n.getFullId()]||y[n.getNode().id]:y[n.id]||w[n.id]})},this.addToPosse=function(n,t,i){o.each(n,function(n){var r=d(n);r.el&&a.addToPosse(r.el,{id:t,active:i!==!1})})},this.setPosse=function(n,t){o.each(n,function(n){var i=d(n);i.el&&a.setPosse(i.el,t)})},this.removeFromPosse=function(n,t){o.each(n,function(n){var i=d(n);i.el&&a.removeFromPosse(i.el,t)})},this.removeFromAllPosses=function(n){o.each(n,function(n){var t=d(n);t.el&&a.removeFromAllPosses(t.el)})},this.setPosseState=function(n,t,i){o.each(n,function(n){var r=d(n);r.el&&a.setPosseState(r.el,t,i)})},ft={jsPlumb:a,toolkit:e,container:at,containerId:wi,getConnectionsForEdges:yr,getConnectionForEdge:bi,getElement:function(n){return y[n]||w[n]},getNodeForElementId:function(n){return rt[n]},getGroupForElementId:function(n){return ht[n]},getObjectInfo:d,nodeMap:function(){return y},portMap:function(){return g},groupMap:function(){return w},reverseGroupMap:function(){return ht},reverseNodeMap:function(){return rt}}};u.DOM=function(){v.apply(this,arguments);a.apply(this,arguments)}}.call("undefined"!=typeof window?window:this),function(){"use strict";var i=this,n={webkit:{mac:function(n){return n.deltaY/120},win:function(n){return n.deltaY/100}},safari:function(n){return-(n.wheelDeltaY/120)},firefox:{mac:function(n){return n.deltaY*(1==n.deltaMode?25:1)/-120},win:function(n){return n.deltaY/-3}},ie:function(n){return n.wheelDelta/120},"default":function(n){return n.deltaY||n.wheelDelta}},r=/Mac/.test(navigator.userAgent)?"mac":"win",t=navigator.userAgent.indexOf("Firefox")!=-1?"firefox":/Chrome/.test(navigator.userAgent)?"webkit":/Safari/.test(navigator.userAgent)?"safari":/WebKit/.test(navigator.userAgent)?"webkit":/Trident/.test(navigator.userAgent)?"ie":"default",u="function"==typeof n[t]?n[t]:n[t][r],f=function(n){return u(n||event)},e=function(n,t,i){return function(r){t&&null!=r.mozInputSource&&1!==r.mozInputSource||(r.normalizedWheelDelta=f(r),(!i||r.metaKey||r.ctrlKey)&&n(r))}},o="onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll";i.addWheelListener=function(n,t,i,r){var u=e(t,i,r);n.addEventListener?n.addEventListener(o,u,!1):n.attachEvent&&n.attachEvent("onmousewheel",u)}}.call("undefined"!=typeof window?window:this),function(){var n=this;n.PinchListener=function(n){var a="onpointerdown"in document.documentElement,v="ontouchstart"in document.documentElement,i=[0,0],t=0,r=0,u=function(u){n[u](i,r,t,t/r)},f=function(){n.onPinchEnd()},e="onPinchStart",o="onPinch",y="pointerdown",p="pointermove",w="pointerup",b="touchstart",s="touchmove",h="touchend",c=function(n,t,i,r){return Math.sqrt(Math.pow(i-n,2)+Math.pow(r-t,2))},l={pointer:function(){var l={},s=[],h=0,a=!1,v=function(){2==h&&(i=[(s[1].p[0]+s[0].p[0])/2,(s[1].p[1]+s[0].p[1])/2],t=c(s[1].p[0],s[1].p[1],s[0].p[0],s[0].p[1]))},b=function(n){h>=2||a||(s[h]={e:n,p:[n.pageX,n.pageY]},l[""+n.pointerId]=h,h++,v(),2==h&&(r=t,u(e)))},k=function(n){var t=l[""+n.pointerId];null!=t&&(delete l[""+n.pointerId],h--,a=0!==h,f())},d=function(n){if(!a&&2==h){var t=l[n.pointerId];null!=t&&(s[t].p=[n.pageX,n.pageY],v(),u(o))}};n.bind(n.el,y,b);n.bind(document,w,k);n.bind(document,p,d)},touch:function(n){var v=function(n){return n.touches||[]},l=function(n,t){return n.item?n.item(t):n[t]},y=function(n){var t=l(n,0),i=l(n,1);return c(t.pageX,t.pageY,i.pageX,i.pageY)},p=function(n){var t=l(n,0),i=l(n,1);return[(t.pageX+i.pageX)/2,(t.pageY+i.pageY)/2]},a=!1,d=function(f){var o=v(f);2==o.length&&n.enableWheelZoom!==!1&&(i=p(o),t=r=y(o),a=!0,n.bind(document,s,k),n.bind(document,h,w),u(e))},w=function(){a=!1;n.unbind(document,s,k);n.unbind(document,h,w);f()},k=function(n){if(a){var r=v(n);2==r.length&&(t=y(r),i=p(r),u(o))}};n.bind(n.el,b,d)}};a?l.pointer(n):v&&l.touch(n)}}.call("undefined"!=typeof window?window:this),function(){"use strict";var i=this,n=i.jsPlumb;this.ZoomWidget=function(t){function b(n,r){if(kr())return{w:0,h:0,x:0,y:0,vw:t.width(s),vh:t.height(s),padding:n,z:1,zoom:1};n=n||0;r=r||.9;var u=Math.abs(c.maxx[0][0][0]+c.maxx[0][1]-c.minx[0][0][0]),f=Math.abs(c.maxy[0][0][1]+c.maxy[0][2]-c.miny[0][0][1]),e=t.width(s),o=t.height(s),h=e/((u+2*n)/r),l=o/((f+2*n)/r),a=Math.min(h,l);return{w:u,h:f,x:c.minx[0][0][0],y:c.miny[0][0][1],vw:e,vh:o,padding:n,z:a,zoom:i}}function kr(){for(var n in l)return!1;return!0}function ki(n){var t,r,i;for(t in c)if(c.hasOwnProperty(t)){for(r=-1,i=0;i<c[t].length;i++)if(c[t][i][3]===n){r=i;break}r!=-1&&c[t].splice(r,1)}}var bi,wr;t.events=t.events||{};var e,a,it,dr,gr,nt,d=this,rt=function(){},tt=t.canvas,ct=t.domElement||function(n){return n},o=ct(tt),ut=t.viewport,s=ct(ut),nu=t.events.zoom||rt,lt=(t.events.maybeZoom||function(){return!0},t.events.pan||rt),tu=t.events.mousedown||rt,iu=t.events.mouseup||rt,ru=t.events.mousemove||rt,di=t.events.transformOrigin||rt,ii=!(t.clamp===!1),uu=t.clampZoom!==!1,gi=t.panDistance||50,fu=t.enablePan!==!1,eu=t.enableWheelZoom!==!1,ou=t.enableAnimation!==!1,nr=t.wheelFilter||function(){return!0},su=t.wheelZoomMetaKey===!0,hu=t.wheelReverse===!0?-1:1,cu=hu*(t.wheelSensitivity||10),lu=t.enablePanButtons!==!1,ft=t.padding||[0,0],au=t.consumeRightClick!==!1,vu=t.smartMinimumZoom,tr=!1,ir="mousedown",ri="mouseup",at="mousemove",rr=["webkit","Moz","ms"],g=t.bind,wt=t.unbind,ui=!(t.enabled===!1),ur=t.clampToBackground,fi=t.clampToBackgroundExtents,ei=t.filter||function(){return!1},bt=t.width,kt=t.height,yu=0,pu=0,i=t.zoom||1,p=[0,0],oi=!1,vt=!1,si=!1,et=!1,w=t.zoomRange||[.05,3],ot=150,wu=-1,bu=-1,c={minx:[],maxx:[],miny:[],maxy:[]},l={},yt={},st={},hi=!1,fr=function(){c.minx.sort(function(n,t){return n[0][0]<t[0][0]?-1:1});c.miny.sort(function(n,t){return n[0][1]<t[0][1]?-1:1});c.maxx.sort(function(n,t){return n[0][0]+n[1]>t[0][0]+t[1]?-1:1});c.maxy.sort(function(n,t){return n[0][1]+n[2]>t[0][1]+t[2]?-1:1})},er=function(n,t,i,r){null==l[n]&&(l[n]=[],c.minx.push(l[n]),c.miny.push(l[n]),c.maxx.push(l[n]),c.maxy.push(l[n]));l[n][0]=t;l[n][1]=i;l[n][2]=r;l[n][3]=n;tr?hi=!0:fr()};this.setBoundsFor=er;this.setSuspendRendering=function(n){tr=n;!n&&hi&&fr();hi=!1};var ku=function(n,t){return function(r){ni(o,n*gi,t*gi,null,!0,function(n){lt(n[0],n[1],i,i,r);e&&e.pan();v.pan()})}},du=150,gu=60,or=10,sr=null,hr=null,pt=null,nf=function(n,i,r){return function(){pt=r;t.addClass(pt,"jtk-surface-pan-active");t.bind(document,"mouseup",tf);sr=window.setTimeout(function(){t.bind(document,ri,uf);hr=window.setInterval(rf(n,i),gu)},du)}},tf=function(){window.clearTimeout(sr);pt&&t.removeClass(pt,"jtk-surface-pan-active");pt=null},rf=function(n,t){return function(r){var u=ni(o,n*or,t*or,null);lt(u[0],u[1],i,i,r);e&&e.pan();v.pan()}},uf=function(){window.clearTimeout(hr)},dt=function(n,i,r,u,f){var e=document.createElement("div"),o;e.innerHTML=f||"";e.style.position="absolute";for(o in i)e.style[o]=i[o];return e.className="jtk-surface-pan jtk-surface-pan-"+n,s.appendChild(e),t.bind(e,"click",ku(r,u)),t.bind(e,"mousedown",nf(r,u,e)),e};lu&&(dt("top",{left:"0px",top:"0px"},0,-1,"&#8593;"),dt("bottom",{left:"0px",bottom:"0px"},0,1,"&#8595;"),dt("left",{left:"0px",top:"0px"},-1,0,"&#8592;"),dt("right",{right:"0px",top:"0px"},1,0,"&#8594;"));var gt=function(n,t,i){var r,u;for(i=i||o,r=0;r<rr.length;r++)u=n.replace(/([a-z]){1}/,function(n){return rr[r]+n.toUpperCase()}),i.style[u]=t;i.style[n]=t},ci=function(n){gt("transformOrigin",p[0]+"% "+p[1]+"%",n)},ff=function(n,r){var c=k(),l=t.offset(s,!0),a=h(o),f=t.width(tt),e=t.height(tt),u=[(n-(l.left+a[0])-c[0])/i,(r-(l.top+a[1])-c[1])/i];return{w:f,h:e,xy:u,xScale:u[0]/f,yScale:u[1]/e,o:[u[0]/f*100,u[1]/e*100]}},cr=function(n,t,r,u){var s,h,c,l,f=p[0]/100*t,e=p[1]/100*r,a;s=-(f*(1-i));h=-(e*(1-i));p=n;ci();f=p[0]/100*t;e=p[1]/100*r;c=-(f*(1-i));l=-(e*(1-i));a=ni(o,c-s,l-h,u);di&&di(p,a)},li=function(n,t,i){var r=ff(n,t);cr(r.o,r.w,r.h,i)},ai=function(n){var t=ht(n);li(t[0],t[1],n)},lr=function(n,i){var r=t.width(tt),u=t.height(tt);cr([n/r*100,i/u*100],r,u)},ht=this.pageLocation=function(n){if(null!=n.pageX)return[n.pageX,n.pageY];var t=ef(vi(n),0);return t?[t.pageX,t.pageY]:[0,0]},ef=function(n,t){return n.item?n.item(t):n[t]},vi=function(n){return n.touches||[]},y=function(n,t,r,u,f){var s,p,k,nt,c,l;if(!(null==n||isNaN(n)||n<0)){if(s=w[0],vu?(s=.5,p=b().z,k=n/p,k<s&&(n=p*s)):n<s&&(n=s),n>w[1]&&(n=w[1]),u){var tt=n>i?.05:-.05,a=i,d=n<i,g=window.setInterval(function(){a=y(a+tt);d&&a<=n&&window.clearInterval(g);!d&&a>=n&&window.clearInterval(g)});return i}return gt("transform","scale("+n+")"),nt=i,(i=n,f||nu(yu,pu,i,nt,t,r),null!=e&&e.setZoom(n),v&&v.pan(),uu)&&(c=h(o),l=ar(c[0],c[1]),l[0]==c[0]&&l[1]==c[1]||h(o,l[0],l[1],null,!u)),i}},yi=function(n,t,i,r){t<-ot&&(t=-ot);t>ot&&(t=ot);of(it,t,-ot,ot,i,r)},of=function(n,t,i,r,u,f){var e=t/(t>=0?r:i),o=t>=0?1:0,s=n+e*(w[o]-n);y(s,u,f)},ar=function(n,r,u){var a,v,o;if(ii||ur||fi){var h=k(),c=n,l=r,f=ii?b():{x:0,y:0,w:0,h:0,vw:t.width(s),vh:t.height(s),padding:u,z:1};if(u=(u||20)*i,(ur||fi)&&null!=e){var g=e.getWidth(),nt=e.getHeight(),tt=Math.max(f.x+f.w,g),it=Math.max(f.y+f.h,nt);f.w=tt-f.w;f.h=it-f.h;a=f.vw/f.w;v=f.vh/f.h;f.z=Math.min(a,v);fi&&(u=Math.max(f.vw,f.vh))}o=[f.x+f.w,f.y+f.h];e&&(o[0]=Math.max(o[0],e.getWidth()),o[1]=Math.max(o[1],e.getHeight()));var y=n+h[0]+o[0]*i-u,p=r+h[1]+o[1]*i-u,w=n+h[0]+f.x*i+u,d=r+h[1]+f.y*i+u;return y<0&&(c-=y),w>f.vw&&(c-=w-f.vw),p<0&&(l-=p),d>f.vh&&(l-=d-f.vh),[c,l]}return[n,r]},h=function(n,i,r,u,f,e,o){if(1==arguments.length)return[parseInt(n.style.left,10)||0,parseInt(n.style.top,10)||0];var s=ar(i,r);return ou&&!f&&t.animate?t.animate(n,{left:s[0],top:s[1]},{step:o,complete:function(){e&&e(s)}}):(n.style.left=s[0]+"px",n.style.top=s[1]+"px",e&&e(s)),s};o.style.left="0px";o.style.top="0px";var ni=function(n,t,i,r,u,f){var e=h(n);return h(n,e[0]+t,e[1]+i,r,!u,f)},k=function(){var n=t.width(tt),r=t.height(tt),u=p[0]/100*n,f=p[1]/100*r;return[u*(1-i),f*(1-i)]},vr={start:function(n,r){if(!vt){var u=n.srcElement||n.target;ui&&(u==o||u==s||u._jtkDecoration||e&&e.owns(u)||ei(u,n)===!0)&&(et=!1,wu=-1,bu=-1,3!==n.which||t.enableWheelZoom===!1||null!=n.mozInputSource&&1!==n.mozInputSource?r.length<=1&&(oi=!0,a=ht(n),nt=h(o)):(si=!0,a=ht(n),ai(n),nt=h(o),it=i));tu(n,d)}},move:function(n){var r,u,t,f;(et=!1,vt)||(si?(t=ht(n),r=t[0]-a[0],u=t[1]-a[1],yi(r,u,n)):oi&&fu&&null!=a&&(t=ht(n),r=t[0]-a[0],u=t[1]-a[1],f=h(o,nt[0]+r,nt[1]+u,n,!0),lt(f[0],f[1],i,i,n),e&&e.pan(),v&&v.pan()),ru(n,d))},end:function(n){vt||(si=!1,a=null,oi=!1,et=!1,wt(document,at,yr),wt(document,ri,pr),g(document,at,wi),iu(n,d))},contextmenu:function(){}},pi=function(n,t){"contextmenu"==n&&au&&t.preventDefault&&t.preventDefault();var i=vi(t);vr[n](t,i)},yr=function(n){pi("move",n)},pr=function(n){pi("end",n)},wi=function(){et=!1};g(document,at,wi);bi=this.start=function(n){ui&&null!=n&&(wt(document,at,wi),g(document,at,yr),g(document,ri,pr),vr.start(n,vi(n)))};(g(ut,ir,bi),g(ut,"contextmenu",function(n){pi("contextmenu",n)}),eu)&&(wr=function(n){nr(n)&&(n.preventDefault&&n.preventDefault(),n.stopPropagation&&n.stopPropagation(),it=i,et||(ai(n),et=!0),yi(0,n.normalizedWheelDelta*cu,n,!0))},addWheelListener(s,wr,!0,su));new PinchListener({el:ut,bind:g,unbind:wt,enableWheelZoom:t.enableWheelZoom,onPinch:function(n,t,i,r){y(r*it);var u=n[0]-a[0],f=n[1]-a[1];h(o,nt[0]+u,nt[1]+f,null,!0)},onPinchStart:function(n,t){vt=!0;a=n;dr=gr=t;it=i;li(a[0],a[1]);nt=h(o)},onPinchEnd:function(){vt=!1;a=null}});y(i,null,!1,!1,!0);ci();this.positionChanged=function(n,i,r){r=r||t.id(n);var u=i||h(n),f=t.width(n),e=t.height(n);yt[r]=n;er(r,u,f,e)};this.add=function(n,t,i,r){this.positionChanged(n,i,t);r&&(g(n,ir,bi),n._jtkDecoration=!0)};this.suspend=function(n){var i="string"==typeof n?n:t.id(n);st[i]=!0;ki(i)};this.isSuspended=function(n){var i="string"==typeof n?n:t.id(n);return st[i]===!0};this.restore=function(n){var i="string"==typeof n?n:t.id(n);delete st[i];this.positionChanged(n,null,i)};this.remove=function(n){n=ct(n);var i=t.id(n);delete l[i];delete yt[i];delete st[i];ki(i)};this.reset=function(){c.minx.length=0;c.miny.length=0;c.maxx.length=0;c.maxy.length=0;l={};yt={};st={};h(o,0,0,null,!0)};this.getBoundsInfo=b;this.zoomToFit=function(n){n=n||{};var t=b(n.padding,n.fill);n.doNotZoomIfVisible&&t.z>i||y(t.z);d.centerContent({bounds:t,doNotAnimate:n.doNotAnimate!==!1,onComplete:n.onComplete,onStep:n.onStep,doNotFirePanEvent:n.doNotFirePanEvent})};this.zoomToFitIfNecessary=function(t){var i=n.extend(t||{});i.doNotZoomIfVisible=!0;this.zoomToFit(i)};this.zoomToElements=function(n){for(var o,r={x:1/0,y:1/0,xMax:-(1/0),yMax:-(1/0),z:1,vw:t.width(s),vh:t.height(s)},u=0;u<n.elements.length;u++){var e=n.elements[u],f=t.offset(e),h=t.width(e),c=t.height(e);r.x=Math.min(r.x,f.left);r.y=Math.min(r.y,f.top);r.xMax=Math.max(r.xMax,f.left+h);r.yMax=Math.max(r.yMax,f.top+c)}o=t.fill||.9;r.w=o*(r.xMax-r.x);r.h=o*(r.yMax-r.y);r.z=Math.min(r.vw/r.w,r.vh/r.h);n.doNotZoomIfVisible&&r.z>i||y(r.z);d.centerContent({bounds:r,doNotAnimate:n.doNotAnimate!==!1,onComplete:n.onComplete,onStep:n.onStep,doNotFirePanEvent:n.doNotFirePanEvent})};this.zoomToBackground=function(n){if(n=n||{},null!=e){var t=e.getWidth(),i=e.getHeight(),r=bt(s),u=kt(s),o=r/t,h=u/i,c=Math.min(o,h),f={w:t,h:i,x:0,y:0,vw:r,vh:u,padding:0,z:c};y(f.z);d.centerContent({bounds:f,doNotAnimate:n.doNotAnimate,onComplete:n.onComplete,onStep:n.onStep})}};this.setFilter=function(n){ei=n||function(){return!1}};this.centerBackground=function(){if(null!=e){var i=n.extend({},b());i.x=e.getWidth()/2;i.y=e.getHeight()/2;i.w=1;i.h=1;d.centerContent({bounds:i,doNotAnimate:t.doNotAnimate,onComplete:t.onComplete,onStep:t.onStep,vertical:!0,horizontal:!0})}};this.alignBackground=function(n){if(null!=e){var t=n.split(" "),f=t[0]||"left",s=t[1]||"top",r=b(),c="left"===f?0:r.vw-e.getWidth()*i,l="top"===s?0:r.vh-e.getHeight()*i,u=k();h(o,c-u[0],l-u[1]);e.pan();v&&v.pan()}};this.positionElementAt=function(n,r,u,f,e,s){f=f||0;e=e||0;var v=k(),y=h(o),c=ct(n),b=c.parentNode,p=t.offset(b),w=t.offset(ut),l=w.left-p.left+(y[0]+v[0])+r*i+f,a=w.top-p.top+(y[1]+v[1])+u*i+e;s&&l<0&&(l=0);s&&a<0&&(a=0);c.style.left=l+"px";c.style.top=a+"px"};this.positionElementAtPageLocation=function(n,t,i,r,u){var f=this.mapLocation(t,i);this.positionElementAt(n,f.left,f.top,r,u)};this.positionElementAtEventLocation=function(n,t,i,r){var u=this.mapEventLocation(t);this.positionElementAt(n,u.left,u.top,i,r)};this.zoomToEvent=function(n,t){ai(n);y(i+t,n)};this.relayout=function(n,i){var r,u,f,e;t.enablePan===!1&&(h(o,-n.x+ft[0],-n.y+ft[1],null,i),r=n.w+(n.x<0?n.x:0)+ft[0],u=n.h+(n.y<0?n.y:0)+ft[1],o.style.width=r+"px",o.style.height=u+"px",f=0==r?0:(n.x-ft[0])/r*100,e=0==u?0:(n.y-ft[1])/u*100,this.setTransformOrigin(f,e))};this.nudgeZoom=function(n,r){var u=t.offset(s,!0),f=u.left+t.width(s)/2,e=u.top+t.height(s)/2;return li(f,e),y(i+n,r)};this.nudgeWheelZoom=function(n,t){it=i;yi(0,n,t,!0)};this.centerContent=function(n){n=n||{};var t=n.bounds||b(),u=k(),c=t.x*i+t.w*i/2,l=t.y*i+t.h*i/2,f=t.vw/2-c,s=t.vh/2-l,r=h(o);h(o,n.horizontal!==!1?f-u[0]:r[0],n.vertical!==!1?s-u[1]:r[1],null,n.doNotAnimate,function(){n.doNotFirePanEvent||lt(n.horizontal!==!1?f-r[0]:0,n.vertical!==!1?s-r[1]:0,i,i);e&&e.pan();v&&v.pan();n.onComplete&&n.onComplete()},n.onStep)};this.centerContentHorizontally=function(t){this.centerContent(n.extend({horizontal:!0,vertical:!1},t))};this.centerContentVertically=function(t){this.centerContent(n.extend({vertical:!0,horizontal:!1},t))};this.centerOn=function(t,i){var o;i=i||{};var r=n.extend({},b()),u=h(t),f=bt(t),e=kt(t);r.x=u[0];r.y=u[1];r.w=f;r.h=e;o=function(){lr(u[0]+f/2,u[1]+e/2);i.onComplete&&i.onComplete()};this.centerContent({bounds:r,doNotAnimate:i.doNotAnimate,onComplete:o,onStep:i.onStep,vertical:i.vertical!==!1,horizontal:i.horizontal!==!1})};this.centerOnHorizontally=function(n){this.centerOn(n,{vertical:!1})};this.centerOnVertically=function(n){this.centerOn(n,{horizontal:!1})};this.centerOnAndZoom=function(n,t){var s,c;t=t||.6;var f={w:bt(n),h:kt(n)},e=h(n),u=b(),o=u.vw<u.vh?[u.vw,"w"]:[u.vh,"h"],l=t*o[0],r=l/f[o[1]];r<w[0]&&(r=w[0]);r>w[1]&&(r=w[1]);s=i;c=r-i;lr(e[0]+f.w/2,e[1]+f.h/2);this.centerOn(n,{onStep:function(n,t){y(s+n/t*c)},onComplete:function(){y(r)}})};this.getViewportCenter=function(){var t=n.extend({},b()),r=k(),u=h(o),f=[t.vw/2,t.vh/2];return[(f[0]-(u[0]+r[0]))/i,(f[1]-(u[1]+r[1]))/i]};this.setViewportCenter=function(t){var r=n.extend({},b()),u=k(),f=[r.vw/2,r.vh/2],e=[u[0]+(i*t[0]+f[0]),u[1]+(i*t[1]+f[1])];h(o,e[0],e[1])};this.setClamping=function(n){ii=n};this.setZoom=function(n,t,i){return y(n,null,null,t,i)};this.setZoomRange=function(n,t){return null!=n&&2==n.length&&n[0]<n[1]&&null!=n[0]&&null!=n[1]&&n[0]>0&&n[1]>0&&(w=n,t||(i<w[0]||i>w[1])&&y(i)),this};this.getZoomRange=function(){return w};this.getZoom=function(){return i};this.getPan=function(){return h(o)};this.pan=function(n,t,r){ni(o,n,t,null,r,function(n){lt(n[0],n[1],i,i);e&&e.pan();v&&v.pan()})};this.setPan=function(n,t,i,r,u){return h(o,n,t,null,!i,r,u)};this.setTransformOrigin=function(n,t){p=[n,t];ci()};this.mapLocation=function(n,r,u){var f=k(),e=h(o),l=s.scrollLeft,a=s.scrollTop,c=u?{left:0,top:0}:t.offset(s);return{left:(n-(e[0]+f[0])-c.left+l)/i,top:(r-(e[1]+f[1])-c.top+a)/i}};this.mapEventLocation=function(n,t){var i=ht(n);return this.mapLocation(i[0],i[1],t)};this.setEnabled=function(n){ui=n};this.showElementAt=function(n,i,r){var o=ct(n),s=o.parentNode,u=t.offset(s),f=t.offset(ut),e=k(),h=u.left-f.left+e[0]+i,c=u.top-f.top+e[1]+r;t.offset(n,{left:h,top:c})};this.getApparentCanvasLocation=function(){var n=k(),t=h(o);return[t[0]+n[0],t[1]+n[1]]};this.setApparentCanvasLocation=function(n,t){var i=k(),r=h(o,n-i[0],t-i[1],null,!0);return e&&e.pan(),v&&v.pan(),r};this.applyZoomToElement=function(n,t){t=t||i;gt("transform","scale("+t+")",n)};this.setTransformOriginForElement=function(n,t){gt("transformOrigin",t[0]+" "+t[1],n)};this.getTransformOrigin=function(){return p};this.floatElement=function(n,t){null!=n&&(n.style.position="absolute",n.style.left=t[0]+"px",n.style.top=t[1]+"px",s.appendChild(n))};var ti={},br=function(n){var f=d.getApparentCanvasLocation(),r,t,u;for(r in ti)if(ti.hasOwnProperty(r)){if(null!=n&&n!=r)continue;t=ti[r];u=function(n,r){t[n]&&(t.el.style[n]=f[r]/i+t.pos[r]<0?-(f[r]/i)+"px":t.pos[r]+"px")};u("left",0);u("top",1)}},v={pan:br};this.fixElement=function(n,i,r){if(null!=n){i=i||{};var u=t.id(n);ti[u]={el:n,left:i.left,top:i.top,pos:r};n.style.position="absolute";n.style.left=r[0]+"px";n.style.top=r[1]+"px";o.appendChild(n);br(u)}};this.findIntersectingNodes=function(n,r,u,f,e){var o,v=this.getApparentCanvasLocation(),y=t.offset(s),b=s.scrollLeft,k=s.scrollTop,p=[],d={x:n[0],y:n[1],w:r[0],h:r[1]},g=u?Biltong.encloses:Biltong.intersects,w=[y.left+v[0]-b,y.top+v[1]-k],a,h,c;if(e=e||l,Array.isArray(e)){for(a={},o=0;o<e.length;o++)a[jsPlumbUtil.isString(e[o])?e[o]:jsPlumb.getId(e[o])]=e[o];e=a}for(o in e)st[o]||(h=l[o],h&&(c={x:w[0]+h[0][0]*i,y:w[1]+h[0][1]*i,w:h[1]*i,h:h[2]*i},g(d,c)&&(null==f||f(o,yt[o],c))&&p.push({id:o,el:yt[o],r:c})));return p};this.findNearbyNodes=function(n,t,i,r){var u=[],f;return(!i||this.isInViewport(n[0],n[1]))&&(u=this.findIntersectingNodes([n[0]-t,n[1]-t],[2*t,2*t],!1,r),f=this.mapLocation(n[0],n[1]),u.sort(function(n,t){var u=[n.x+n.w/2,n.y+n.h/2],e=[t.x+t.w/2,t.y+t.h/2],i=Biltong.lineLength(f,u),r=Biltong.lineLength(f,e);return i<r?-1:i>r?1:0})),u};this.isInViewport=function(n,i){var r=t.offset(s),u=t.width(s),f=t.height(s);return r.left<=n&&n<=r.left+u&&r.top<=i&&i<=r.top+f};this.getElementPositions=function(){return l};this.setFilter=function(n){ei=n||function(){return!1}};this.setWheelFilter=function(n){nr=n||function(){return!0}};this.setBackground=function(n){var t=n.type||"simple",i={simple:r,tiled:"absolute"==n.tiling?f:u};e=new i[t]({canvas:o,viewport:s,getWidth:bt,getHeight:kt,url:n.url,zoomWidget:d,onBackgroundReady:n.onBackgroundReady,options:n,img:n.img,resolver:n.resolver})};t.background&&this.setBackground(t.background);this.getBackground=function(){return e}};var r=function(n){var i=n.canvas,r=n.onBackgroundReady||function(){},t=new Image;t.onload=function(){i.style.backgroundImage="url('"+t.src+"')";i.style.backgroundRepeat="no-repeat";i.style.width=t.width+"px";i.style.height=t.height+"px";r(this)};t.src=n.img?n.img.src:n.url;this.owns=function(n){return n==i};this.getWidth=function(){return t.width||0};this.getHeight=function(){return t.height||0};this.setZoom=this.pan=function(){}},t=function(n){var c=this,u=n.canvas,e=n.viewport;if(null==n.options.maxZoom)throw new TypeError("Parameter `maxZoom` not set; cannot initialize TiledBackground");if(!n.options.tileSize)throw new TypeError("Parameter `tileSize not set; cannot initialize TiledBackground. It should be an array of [x,y] values.");if(!n.options.width||!n.options.height)throw new TypeError("Parameters `width` and `height` must be set");for(var l=function(t){var u=document.createElement("div"),f,o,r,s,h,l;u.style.position="relative";u.style.height="100%";u.style.width="100%";u.style.display="none";n.canvas.appendChild(u);this.zoom=t;var e=c.getTileSpecs(t),i=[],a=function(t,i,r){return n.url.replace("{z}",t).replace("{x}",i).replace("{y}",r)},v=function(t,i,r){return null==n.resolver?a(t,i,r):n.resolver(t,i,r)};for(this.apparentZoom=Math.min(e[2],e[3]),this.setActive=function(n){u.style.display=n?"block":"none"},this.xTiles=e[0],this.yTiles=e[1],f=0;f<this.xTiles;f++)for(i[f]=i[f]||[],o=0;o<this.yTiles;o++)r=document.createElement("img"),r._tiledBg=!0,r.className="jtk-surface-tile",r.ondragstart=function(){return!1},u.appendChild(r),r.style.position="absolute",r.style.opacity=0,i[f][o]=[r,new Image,!1];s=Math.pow(2,n.options.maxZoom-t)*n.options.tileSize[0];h=Math.pow(2,n.options.maxZoom-t)*n.options.tileSize[1];this.scaledImageSize=s;this.scaledImageSizeH=h;l=function(n,i,r,u){n.style.left=r*s+"px";n.style.top=u*h+"px";n.style.width=s+"px";n.style.height=h+"px";i.onload=function(){n.setAttribute("src",i.src);n.style.opacity=1};i.src=v(t,r,u)};this.ensureLoaded=function(n,t,r,u){for(var e,f=n;f<=r;f++)for(e=t;e<=u;e++)null!=i[f]&&null!=i[f][e]&&(i[f][e][2]||(l(i[f][e][0],i[f][e][1],f,e),i[f][e][2]=!0))}}.bind(this),i=[],t=null,f=0;f<=n.options.maxZoom;f++)i.push(new l(f));u.style.width=n.options.width+"px";u.style.height=n.options.height+"px";var r,a=function(){if(r<=i[0].apparentZoom)return 0;if(r>=i[i.length-1].apparentZoom)return i.length-1;for(var n=i.length-1;n>0;n--)if(i[n].apparentZoom>=r&&r>=i[n-1].apparentZoom)return n},v=function(n){var r=i[n];null!=t&&t!=r&&t.setActive(!1);r.setActive(!0);t=r},o=function(){var i=n.zoomWidget.getApparentCanvasLocation(),u=n.getWidth(e),f=n.getHeight(e),o=t.scaledImageSize*r,s=t.scaledImageSizeH*r,h=i[0]<0?Math.floor(-i[0]/o):i[0]<u?0:null,c=i[1]<0?Math.floor(-i[1]/s):i[1]<f?0:null,l=Math.min(t.xTiles,Math.floor((u-i[0])/o)),a=Math.min(t.yTiles,Math.floor((f-i[1])/s));null!=h&&null!=c&&t.ensureLoaded(h,c,l,a)};this.getCurrentLayer=function(){return t};this.getWidth=function(){return n.options.width};this.getHeight=function(){return n.options.height};var y=n.options.panDebounceTimeout||50,p=n.options.zoomDebounceTimeout||120,s=function(n,t){t=t||150;var i=null;return function(){window.clearTimeout(i);i=window.setTimeout(n,t)}},h=function(){v(a());o()},w=s(h,p),b=s(o,y);this.setZoom=function(n,t){r=n;t?h():w()};this.pan=b;this.owns=function(n){return n==u||1==n._tiledBg};this.setZoom(n.zoomWidget.getZoom(),!0);null!=n.onBackgroundReady&&setTimeout(n.onBackgroundReady,0)},u=function(n){var i=n.options.width,r=n.options.height,u=n.options.tileSize;this.getTileSpecs=function(n){var e=i>r?1:i/r,o=r>i?1:r/i,t=Math.pow(2,n+1)*u[0]*e,f=Math.pow(2,n+1)*u[1]*o,s=Math.ceil(t/u[0]),h=Math.ceil(f/u[1]);return[s,h,t/i,f/r]};t.apply(this,arguments)},f=function(n){var f=n.options.maxZoom,r=n.options.width,u=n.options.height,i=n.options.tileSize;this.getTileSpecs=function(n){var t=Math.pow(2,f-n),e=Math.ceil(r/t/i[0]),o=Math.ceil(u/t/i[1]);return[e,o,e*i[0]/r,o*i[1]/u]};t.apply(this,arguments)}}.call("undefined"!=typeof window?window:this),function(){"use strict";var o=this,u=o.jsPlumbToolkit,e=u.Renderers,n=o.jsPlumb,f=o.jsPlumbUtil,s=n.getSelector,r=u.Classes,t=u.Constants,i=u.Events;e.Surface=function(o){function g(t){return null==t?null:"string"==typeof t?this.getRenderedConnection(t):t.constructor==n.Connection?t:l.getRenderedConnection(t.getId())}function nt(){if(!h.jsPlumb.startEditing)throw new TypeError("Connection editors not available.");}var l=this,h,tt,et,ot,ht,ct,d,lt,it,at,rt;e.Surface.SELECT=t.select;e.Surface.PAN=t.pan;e.Surface.DISABLED=t.disabled;h=e.AbstractRenderer.apply(this,arguments);e.DOMElementAdapter.apply(this,arguments);this.getObjectInfo=h.getObjectInfo;o=o||{};var a,v=n.getElement(o.container),y=e.createElement({position:t.relative,width:t.nominalSize,height:t.nominalSize,left:0,top:0,clazz:r.SURFACE_CANVAS},v),ut=!(o.elementsDraggable===!1),vt=o.elementsDroppable===!0,yt=o.dragOptions||{},pt=o.dropOptions||{},p=o.stateHandle,wt=o.storePositionsInModel!==!1,bt=o.modelLeftAttribute,kt=o.modelTopAttribute,c=new ZoomWidget({viewport:v,canvas:y,domElement:h.jsPlumb.getElement,addClass:h.jsPlumb.addClass,removeClass:h.jsPlumb.removeClass,offset:this.getOffset,consumeRightClick:o.consumeRightClick,bind:function(){h.jsPlumb.on.apply(h.jsPlumb,arguments)},unbind:function(){h.jsPlumb.off.apply(h.jsPlumb,arguments)},width:function(n){return h.jsPlumb.getWidth(h.jsPlumb.getElement(n))},height:function(n){return h.jsPlumb.getHeight(h.jsPlumb.getElement(n))},id:h.jsPlumb.getId,animate:function(){h.jsPlumb.animate.apply(h.jsPlumb,arguments)},dragEvents:{stop:n.dragEvents[t.stop],start:n.dragEvents[t.start],drag:n.dragEvents[t.drag]},background:o.background,padding:o.padding,panDistance:o.panDistance,enablePan:o.enablePan,enableWheelZoom:o.enableWheelZoom,wheelSensitivity:o.wheelSensitivity,wheelReverse:o.wheelReverse,wheelZoomMetaKey:o.wheelZoomMetaKey,enablePanButtons:o.enablePanButtons,enableAnimation:o.enableAnimation,clamp:o.clamp,clampZoom:o.clampZoom,clampToBackground:o.clampToBackground,clampToBackgroundExtents:o.clampToBackgroundExtents,zoom:o.zoom,zoomRange:o.zoomRange,extend:h.jsPlumb.extend,events:{pan:function(n,t,r,u,f){l.fire(i.pan,{x:n,y:t,zoom:r,oldZoom:u,event:f})},zoom:function(n,t,r,u,f){h.jsPlumb.setZoom(r);l.fire(i.zoom,{x:n,y:t,zoom:r,oldZoom:u,event:f})},mousedown:function(){n.addClass(v,r.SURFACE_PANNING);n.addClass(document.body,r.SELECT_DEFEAT)},mouseup:function(){n.removeClass(v,r.SURFACE_PANNING);n.removeClass(document.body,r.SELECT_DEFEAT)}}}),w=[],b=o.lassoSelectionFilter,dt=o.autoExitSelectMode!==!1,k=new u.Widgets.Lasso({on:function(){h.jsPlumb.on.apply(h.jsPlumb,arguments)},off:function(){h.jsPlumb.off.apply(h.jsPlumb,arguments)},invert:o.lassoInvert,pageLocation:c.pageLocation,canvas:v,onStart:function(){l.setHoverSuspended(!0);w.length=0},onSelect:function(n,t,i,r){function o(n){return n.el.jtk.node||n.el.jtk.group}var e=[],f=c.findIntersectingNodes(n,t,!i[0]),u;for(h.jsPlumb.clearDragSelection&&h.jsPlumb.clearDragSelection(),h.toolkit.clearSelection(),r&&w.length>0&&h.toolkit.removeFromSelection(w),u=0;u<f.length;u++)null!=b&&b(o(f[u]))===!1||(e.push(o(f[u])),h.jsPlumb.addToDragSelection&&h.jsPlumb.addToDragSelection(f[u].el));w=e;h.toolkit.addToSelection(e,r)},onEnd:function(){l.setHoverSuspended(!1);dt&&l.setMode(t.pan);l.fire("lasso:end")},filter:o.lassoFilter}),ft={pan:function(){k.setEnabled(!1);c.setEnabled(!0)},select:function(){h.jsPlumb.clearDragSelection&&h.jsPlumb.clearDragSelection();k.setEnabled(!0);c.setEnabled(!1)},disabled:function(){h.jsPlumb.clearDragSelection&&h.jsPlumb.clearDragSelection();k.setEnabled(!0);c.setEnabled(!1)}},gt=o.mode||t.pan;l.bind(i.relayout,function(n){c.relayout(n,!0)});l.bind(i.nodeRemoved,function(n){c.remove(n.el)});h.toolkit.bind(i.graphClearStart,function(){c.reset()});h.toolkit.bind(i.dataLoadStart,function(){c.setSuspendRendering(!0)});h.toolkit.bind(i.dataLoadEnd,function(){c.setSuspendRendering(!1);a&&a.setVisible(!0);o.zoomToFit&&l.zoomToFit()});h.toolkit.bind(i.groupMemberAdded,function(n){var t=h.nodeMap()[n.node.id],f,e;if(t){var o=l.getJsPlumb().getGroup(n.group.id),r=l.getSize(o.getDragArea()),u=l.getSize(t);c.suspend(t);l.fire(i.groupMemberAdded,n);h.jsPlumb.addToGroup(n.group.id,t,!0);f=null==n.node.data.left?(r[0]-u[0])/2:n.node.data.left;e=null==n.node.data.top?(r[1]-u[1])/2:n.node.data.top;l.setPosition(n.node.id,f,e)}});h.toolkit.bind(i.groupMemberRemoved,function(n){var t=h.nodeMap()[n.node.id],r;t&&(c.restore(t),l.fire(i.groupMemberRemoved,n),h.jsPlumb.removeFromGroup(n.group.id,t,!0),r=h.jsPlumb.getOffset(t),l.getLayout().setPosition(n.node.id,r.left,r.top))});h.jsPlumb.setContainer(y);n.addClass(v,r.SURFACE);o.enablePan===!1&&n.addClass(v,r.SURFACE_NO_PAN);tt=function(n,t){var i=function(n){var i=n.srcElement||n.target;i!=v&&i!=y||l.fire(t,n)};h.jsPlumb.on(y,n,i);h.jsPlumb.on(v,n,i)};tt(i.tap,i.canvasClick);tt(i.dblclick,i.canvasDblClick);et=null;h.makeDraggable=function(u,e){if(ut){var s=n.getElement(u),p=h.jsPlumb.getId(s),o=h.jsPlumb.extend({},yt),a=n.dragEvents[t.stop],y=n.dragEvents[t.start],w=function(t){var i=n.getDragObject(t),r=n.getElement(i);return{node:r.jtk.node,el:i}};null!=e&&h.jsPlumb.extend(o,e);o[y]=f.wrap(o[y],function(){et=c.getBoundsInfo();var t=w(arguments);t.elementId=p;t.pos=n.getAbsolutePosition(s);t.domEl=s;n.addClass(v,r.SURFACE_ELEMENT_DRAGGING);l.fire(i.nodeMoveStart,t)});o[a]=f.wrap(o[a],function(t){for(var f=function(u){n.removeClass(v,r.SURFACE_ELEMENT_DRAGGING);var f={el:u[0],node:u[0].jtk.node||u[0].jtk.group,pos:[u[1].left,u[1].top],e:t.e,eventPosition:t.pos};o.magnetize&&!f.node.group?f.pos=l.getLayout().setMagnetizedPosition(f.node.id,f.pos[0],f.pos[1],!0):l.getLayout().setPosition(f.node.id,f.pos[0],f.pos[1],!0);c.positionChanged(u[0]);wt!==!1&&(l.storePositionInModel({id:f.node.id,leftAttribute:bt,topAttribute:kt}),h.toolkit.fire(i.nodeUpdated,{node:f.node},null));l.fire(i.nodeMoveEnd,f)},u=0;u<t.selection.length;u++)f(t.selection[u])});o.canDrag=function(){return!k.isActive()};o.force=!0;h.jsPlumb.draggable(s,o,!1,h.jsPlumb)}};h.makeDroppable=function(r,u){if(vt){var o=n.getElement(r),e=h.jsPlumb.extend({},pt);null!=u&&h.jsPlumb.extend(e,u);e[t.drop]=f.wrap(e[t.drop],function(n){var t={source:n.drag.el.jtk.node,sourceElement:n.drag.el,target:n.drop.el.jtk.node,targetElement:n.drop.el,e:n.e};l.fire(i.nodeDropped,t)});h.jsPlumb.droppable(o,e)}};h.doImport=function(){var n,t,i;o.jsPlumbInstance.setContainer(y);n=o.jsPlumbInstance.getManagedElements();for(t in n)i=n[t].el,ot(i,t)};ot=this.importNode=function(i,u){var f=o.jsPlumbInstance.getOffset(i),e=o.jsPlumbInstance.getId(i);i.style.left=f.left+t.px;i.style.top=f.top+t.px;n.addClass(i,r.NODE);c.add(i,e,[f.left,f.top],!1);this.getLayout().setPosition(u,f.left,f.top);n.isAlreadyDraggable(i)&&h.makeDraggable(i);h.nodeMap()[u]=i;h.reverseNodeMap()[e]=i.jtk.node;null!=a&&a.registerNode({el:i,node:i.jtk.node,pos:n.getAbsolutePosition(i)})}.bind(this);this.zoomToFit=c.zoomToFit;this.zoomToFitIfNecessary=c.zoomToFitIfNecessary;this.zoomToSelection=function(n){n=n||{};var i=n.selection||h.toolkit.getSelection(),t=[];i.eachNode(function(n,i){t.push(h.getElement(i.id))});t.length>0&&c.zoomToElements({elements:t,fill:n.fill})};this.zoomToBackground=c.zoomToBackground;this.centerOn=function(n,t){var i=this.getObjectInfo(n);i&&i.el&&c.centerOn(i.el,t)};this.centerOnHorizontally=function(n){this.centerOn(n,{vertical:!1})};this.centerOnVertically=function(n){this.centerOn(n,{horizontal:!1})};this.centerOnAndZoom=function(n,t){var i=this.getObjectInfo(n);i&&i.el&&c.centerOnAndZoom(i.el,t)};this.centerContent=c.centerContent;this.centerContentHorizontally=c.centerContentHorizontally;this.centerContentVertically=c.centerContentVertically;this.getViewportCenter=c.getViewportCenter;this.setViewportCenter=c.setViewportCenter;this.setStateHandle=function(n){p=n};this.getStateHandle=function(){return p};this.setLassoSelectionFilter=function(n){b=n};this.getApparentCanvasLocation=c.getApparentCanvasLocation;this.setApparentCanvasLocation=c.setApparentCanvasLocation;this.getBoundsInfo=c.getBoundsInfo;this.setZoom=c.setZoom;this.setZoomRange=c.setZoomRange;this.getZoomRange=c.getZoomRange;this.getZoom=c.getZoom;this.nudgeZoom=c.nudgeZoom;this.nudgeWheelZoom=c.nudgeWheelZoom;this.pageLocation=c.pageLocation;this.getPan=c.getPan;this.pan=c.pan;this.setPan=c.setPan;this.startEditing=function(n,t){nt();var i=g(n);null!=i&&h.jsPlumb.startEditing(i,t)};this.stopEditing=function(n){nt();var t=g(n);null!=t&&h.jsPlumb.stopEditing(t)};this.clearEdits=function(n){nt();var t=g(n);null!=t&&h.jsPlumb.clearEdits(t)};this.setPanAndZoom=function(n,t,i,r){this.setPan(n,t,!r);this.setZoom(i,!r)};this.setPanFilter=function(n){c.setFilter(n?function(t,i){return"function"==typeof n?n.apply(n,[i]):f.matchesSelector(t,n)}:null)};this.setWheelFilter=function(n){c.setWheelFilter(function(t){if(n){var i=t.srcElement||t.target;return!f.matchesSelector(i,n)}return!0})};this.setWheelFilter(o.wheelFilter);this.setPanFilter(o.panFilter);this.mapLocation=c.mapLocation;this.mapEventLocation=c.mapEventLocation;this.findNearbyNodes=c.findNearbyNodes;this.findIntersectingNodes=c.findIntersectingNodes;this.findIntersectingGroups=function(n,t,i,r){return c.findIntersectingNodes(n,t,i,r,h.reverseGroupMap())};this.isInViewport=c.isInViewport;this.getViewportCenter=c.getViewportCenter;this.positionElementAt=c.positionElementAt;this.positionElementAtEventLocation=c.positionElementAtEventLocation;this.positionElementAtPageLocation=c.positionElementAtPageLocation;this.setFilter=c.setFilter;this.floatElement=c.floatElement;this.fixElement=c.fixElement;var ni=this.setPosition,ti=this.animateToPosition,st=function(n,t,r){n&&(c.positionChanged(n.el,[t,r]),l.fire(i.nodeMoveEnd,{el:n.el,id:n.id,pos:[t,r],node:n.obj||(n.el.jtk?n.el.jtk.node||n.el.jtk.group:{}),bounds:c.getBoundsInfo()}))};for(this.setPosition=function(n,t,i){var r=ni.apply(this,arguments);st(r,t,i)},this.animateToPosition=function(n,t,i){var r=ti.apply(this,arguments);st(r,t,i)},this.tracePath=function(t){var r=t.path||function(){var n=h.getObjectInfo(t.source),i=h.getObjectInfo(t.target);return h.toolkit.getPath({source:n,target:i})}();if(r.exists()){for(var o=function(n,i){this.fire(n,{edge:i.edge,connection:i,options:t.options})}.bind(this),i=[],f=null,e=null,s=r.path.path.length,u=1;u<s;u++){var v=r.path.path[u].vertex.id,c=r.path.previous[v],l=!0,a=r.path.path[u].edge;null!=c&&(l=c===a.source);f=h.getConnectionForEdge(a);e=f.animateOverlay(t.overlay,n.extend(t.options||{},{previous:e,isFinal:u===s-1,forwards:l}));i.push({handler:e,connection:f})}return i.length>0&&(i[0].handler.bind(jsPlumbToolkit.Events.startOverlayAnimation,function(){o(jsPlumbToolkit.Events.startOverlayAnimation,i[0].connection)}),i[i.length-1].handler.bind(jsPlumbToolkit.Events.endOverlayAnimation,function(){o(jsPlumbToolkit.Events.endOverlayAnimation,i[i.length-1].connection)})),!0}return h.toolkit.isDebugEnabled()&&jsPlumbUtil.log("Cannot trace non existent path"),!1},this.getNodePositions=function(){var r={},t=c.getElementPositions(),n,i;for(n in t)i=h.getNodeForElementId(n)||h.getGroupForElementId(n),i&&(r[i.id]=[t[n][0][0],t[n][0][1]]);return r},this.append=function(n,t,i,r){y.appendChild(n);i&&(i=[i.left,i.top]);c.add(n,t,i,r)},this.nodeAppendedToGroup=function(n){c.suspend(n)},this.nodeRemovedFromGroup=function(n){c.restore(n)},ht=this.setLayout,this.setLayout=function(n,t){ht.apply(this,[n,t]);a&&a.setHostLayout(this.getLayout())},ct=function(t){h.jsPlumb.on(y,t,".jtk-node, .jtk-node *",function(i){var r=i.srcElement||i.target,u;(null==r&&(i=n.getOriginalEvent(i),r=i.srcElement||i.target),null!=r&&r.jtk)&&(u=n.extend({e:i,el:r},r.jtk),l.fire(t,u,i))})},d=0;d<e.mouseEvents.length;d++)ct(e.mouseEvents[d]);h.toolkit.bind(t.select,function(i){var u,f;i.obj.objectType==t.nodeType||i.obj.objectType==t.groupType?(u=h.getElement(i.obj.id),u&&(n.addClass(u,r.SURFACE_SELECTED_ELEMENT),h.jsPlumb.addToDragSelection&&h.jsPlumb.addToDragSelection(u))):i.obj.objectType==t.edgeType&&(f=h.getConnectionForEdge(i.obj),f&&f.addClass(r.SURFACE_SELECTED_CONNECTION))});h.toolkit.bind(i.selectionCleared,function(){h.jsPlumb.clearDragSelection&&h.jsPlumb.clearDragSelection();n.removeClass(s("."+r.SURFACE_SELECTED_CONNECTION),r.SURFACE_SELECTED_CONNECTION);n.removeClass(s("."+r.SURFACE_SELECTED_ELEMENT),r.SURFACE_SELECTED_ELEMENT)});h.toolkit.bind(i.deselect,function(i){var u,f;i.obj.objectType==t.nodeType||i.obj.objectType==t.groupType?(u=h.getElement(i.obj.id),u&&(n.removeClass(u,r.SURFACE_SELECTED_ELEMENT),h.jsPlumb.removeFromDragSelection&&h.jsPlumb.removeFromDragSelection(u))):i.obj.objectType==t.edgeType&&(f=h.getConnectionForEdge(i.obj),f&&f.removeClass(r.SURFACE_SELECTED_CONNECTION))});lt=this.setOffset;this.setOffset=function(n,t){lt.apply(this,arguments);c.positionChanged(n,[t.left,t.top])};this.setMode=function(n,r,u){if(!ft[n])throw new TypeError("Surface: unknown mode '"+n+"'");gt=n;ft[n]();n!==t.select||r||h.toolkit.clearSelection();u&&n===t.select&&u.lassoSelectionFilter&&(b=u.lassoSelectionFilter);l.fire(i.modeChanged,n)};it=function(t,i){var r=n.extend({},t),u,f;return r.source=h.getObjectInfo(t.source).obj,r.target=h.getObjectInfo(t.target).obj,r.element=h.getObjectInfo(t.element).obj,u=h.toolkit[i](r),f=h.getConnectionsForEdges(u),h.jsPlumb.select({connections:f})};this.selectEdges=function(n){return it(n,"getEdges")};this.selectAllEdges=function(n){return it(n,"getAllEdges")};this.repaint=function(n){var t=h.getObjectInfo(n);t.el&&(h.jsPlumb.recalculateOffsets(t.el),h.jsPlumb.revalidate(h.jsPlumb.getId(t.el)),l.fire(i.objectRepainted,t))};this.repaintEverything=h.jsPlumb.repaintEverything;this.setElementsDraggable=function(n){ut=n!==!1};at=function(u){function g(n){h.jsPlumb.hasClass(n,r.SURFACE_DROPPABLE_NODE)||(h.jsPlumb.addClass(n,r.SURFACE_DROPPABLE_NODE),h.jsPlumb.initDraggable(n,o,t.surfaceNodeDragScope,h.jsPlumb))}var a,d,et;if(!(u&&(u.droppables||u.source&&u.selector||u.allowNative===!0)))throw new TypeError("Cannot configure droppables: you must specify either `droppables`, `source` + `selector` or `allowNative:true`");var s,nt=u.dataGenerator||function(){return{}},tt=u.typeExtractor,ot=u.locationSetter||function(n,t,i){i.left=n;i.top=t},e=null,it=u.droppables?u.droppables:u.source?u.source.querySelectorAll(u.selector):[],o=u.dragOptions||{},y=u.dropOptions||{},rt="scope_"+(new Date).getTime(),st=function(n,t,i){var v,y;if(e&&l.getJsPlumb().removeClass(e.el,"jtk-drag-hover"),v=!0,u.drop&&(v=u.drop.apply(this,arguments)!==!1),v){var p=l.getJsPlumb(),s=h.jsPlumb.getDragObject(arguments),w=p.getOffset(i?a:s,!0),r=c.mapLocation(w.left,w.top),o=tt?tt(s,n,i,r):null,f=nt?nt(o,s,n,r):{},b="true"===s.getAttribute("jtk-group");(f=f||{},null!=o&&(f.type=o),b||null==e)||(y=l.getOffset(e.uiGroup.getDragArea()),r.left-=y.left,r.top-=y.top);ot(r.left,r.top,f);b?h.toolkit.getGroupFactory()(o,f,function(t){var i=h.toolkit.addGroup(t,{position:r});u.onDrop&&u.onDrop(i,n,r)},n,i):h.toolkit.getNodeFactory()(o,f,function(t){var i=h.toolkit.addNode(t,{position:r});null!=e&&(h.toolkit.addToGroup(i,e.group),l.setPosition(h.nodeMap()[i.id],r.left,r.top),p.getDragManager().updateOffsets(e.el));u.onDrop&&u.onDrop(i,n,r)},n,i)}},ht=function(){e&&l.getJsPlumb().removeClass(e.el,"jtk-drag-hover");e=null;u.start&&u.start.apply(u.start,arguments)},ct=function(){var n,t;try{if(e&&l.getJsPlumb().removeClass(e.el,"jtk-drag-hover"),"true"===arguments[0].el.getAttribute("jtk-group"))e=null;else{var r=arguments[0].e.pageX-arguments[0].pos[0],f=arguments[0].e.pageY-arguments[0].pos[1],i=l.findIntersectingGroups(arguments[0].pos,[r,f]);i.length>0?(n=i[0].el,t=n.jtk.group,e={el:n,group:t,uiGroup:l.getJsPlumb().getGroup(t.id)},l.getJsPlumb().addClass(e.el,"jtk-drag-hover")):e=null}}catch(u){console.log("WARN: could not compute target groups for new node drag",u)}u.drag&&u.drag.apply(u.drag,arguments)},ut=n.dragEvents[t.start],p=n.dragEvents[t.drag],w=n.dragEvents[t.stop],b=n.dragEvents[t.drop],lt=function(){},k=u.nativeFilter||[],at=u.allowNative,ft={};if(o[ut]=f.wrap(o[ut],ht),o[p]=f.wrap(o[p],ct),o[w]=f.wrap(o[w],u.stop||lt),y.scope=rt,y[b]=f.wrap(y[b],st),at){for(a=document.createElement(t.div),a.style.position=t.absolute,s=0;s<k.length;s++)ft[k[s]]=!0;d=function(n){return null!=n.dataTransfer&&1===n.dataTransfer.items.length&&(0===k.length||ft[n.dataTransfer.items[0].type])};document.addEventListener(i.dragover,function(t){t.stopPropagation();t.preventDefault();d(t)&&(n.setAbsolutePosition(a,[t.pageX,t.pageY]),o[p].apply(null,[t,{helper:a,offset:{left:t.pageX,top:t.pageY}},!0]))},!1);document.addEventListener(i.drop,function(n){n.stopPropagation();n.preventDefault();d(n)&&(y[b].apply(null,[n,{helper:a,offset:{left:n.pageX,top:n.pageY}},!0]),o[w].apply(null))},!1);document.addEventListener(i.dragend,function(){})}for(h.jsPlumb.initDroppable(v,y,t.surfaceNodeDragScope),o.scope=rt,o.ignoreZoom=!0,o.doNotRemoveHelper=!0,s=0;s<it.length;s++)et=h.jsPlumb.getElement(it[s]),g(et);return{refresh:function(){if(!u.source||!u.selector)throw new TypeError("Cannot refresh droppables; `source` and `selector` required in constructor.");for(var t=u.source.querySelectorAll(u.selector),n=0;n<t.length;n++)g(t[n])}}};this.registerDroppableNodes=function(n){return new at(n)};this.createMiniview=function(i){var s,y,e,o,f,r;if(null!=a&&(s=h.jsPlumb.getId(h.jsPlumb.getElement(i.container)),a.getContainerId()==s))return!1;y=n.extend({surface:l,toolkit:h.toolkit,surfaceContainerElement:v,bounds:c.getBoundsInfo(),visible:i.initiallyVisible!==!1||h.toolkit.getNodeCount()>0,layout:{type:t.mistletoeLayoutType,parameters:{layout:l.getLayout()}},typeFunction:i.typeFunction},i);a=new u.Renderers.Miniview(y);e=h.nodeMap();for(f in e)r=e[f],a.registerNode({el:r,node:r.jtk.node,pos:n.getAbsolutePosition(r)});o=h.groupMap();for(f in o)r=o[f],a.registerNode({el:r,node:r.jtk.group,pos:n.getAbsolutePosition(r)});return a};o.miniview&&this.createMiniview(o.miniview);this.getMiniview=function(){return a};rt=function(n,t,i){var r=h.getObjectInfo(t),u=null,f;return r.el&&(!1||!function(){var n=l.getRenderedEndpoint(r.obj);if(n)return u=n.setEnabled(i),!0}())&&(f="set"+n+"Enabled",u=h.jsPlumb[f](r.el,i)),u};this.setTargetEnabled=rt.bind(this,"Target");this.setSourceEnabled=rt.bind(this,"Source");this.setEnabled=function(n,t){this.setTargetEnabled(n,t);this.setSourceEnabled(n,t)};this.State={save:function(n,i){if(n=2==arguments.length?arguments[0]:1==arguments.length&&"string"==typeof arguments[0]?arguments[0]:p,i=2==arguments.length?arguments[1]:1==arguments.length&&"function"==typeof arguments[0]?arguments[0]:function(n,t){return t(n)},n)try{i(l.State.serialize(),function(i){u.util.Storage.set(t.jtkStatePrefix+n,i)})}catch(n){f.log(r.msgCannotSaveState,n)}},serialize:function(){var n=c.getPan(),t;n.push(c.getZoom());n.push.apply(n,c.getTransformOrigin());var u=n.join(","),i=l.getLayout().getPositions(),r=[];for(t in i)r.push(t+" "+i[t][0]+" "+i[t][1]);return u+(","+r.join("|"))},restore:function(n,i){if(n=2==arguments.length?arguments[0]:1==arguments.length&&"string"==typeof arguments[0]?arguments[0]:p,i=2==arguments.length?arguments[1]:1==arguments.length&&"function"==typeof arguments[0]?arguments[0]:function(n,t){return t(n)},n)try{var e=u.util.Storage.get(t.jtkStatePrefix+n);e&&i(e,l.State.deserialize)}catch(n){f.log(r.msgCannotRestoreState,n)}},deserialize:function(n){for(var t,u=n.split(","),r=u[5].split("|"),f=l.getLayout(),i=0;i<r.length;i++){t=r[i].split(" ");try{l.setPosition(t[0],parseFloat(t[1]),parseFloat(t[2]))}catch(n){}}f.draw()},clear:function(n){n=n||p;n&&u.util.Storage.clear(t.jtkStatePrefix+n)},clearAll:function(){u.util.Storage.clearAll()}};l.saveState=l.State.save;l.store=u.util.Storage.set;l.retrieve=u.util.Storage.get;l.storeJSON=u.util.Storage.setJSON;l.retrieveJSON=u.util.Storage.getJSON;l.restoreState=function(n){l.State.restore(n);l.getJsPlumb().repaintEverything();l.fire(i.stateRestored)};l.clearState=function(n){l.state.clear(n)};l.initialize();o.zoomToFitIfNecessary?l.zoomToFitIfNecessary():o.zoomToFit&&l.zoomToFit()};u.DefaultRendererType=t.surfaceType;"undefined"!=typeof exports&&(exports.Surface=e.Surface)}.call("undefined"!=typeof window?window:this),function(){"use strict";var e=this,u=e.jsPlumbToolkit,f=u.Renderers,o=e.jsPlumbUtil,t=e.jsPlumb,r=u.Classes,i=u.Constants,n=u.Events,s=u.Attributes,h=u.Methods;f.Miniview=function(u){function a(){var r;if(c&&l&&!lt){p=c.getBoundsInfo();var u=c.getApparentCanvasLocation(),f=l.getApparentCanvasLocation(),e=l.getZoom(),n=e/p.zoom;v.style.width=p.vw+i.px;v.style.height=p.vh+i.px;l.applyZoomToElement(v,n);r=[u[0]*n,u[1]*n];ct=[f[0]-r[0],f[1]-r[1]];t.setAbsolutePosition(v,ct)}}function ht(n){if(null!=l){p=c.getBoundsInfo();n=n||t.getAbsolutePosition(v);var i=l.getApparentCanvasLocation(),f=l.getZoom(),r=f/p.zoom,e=(i[0]-n[0])/r,o=(i[1]-n[1])/r,u=c.setApparentCanvasLocation(e,o);return[i[0]-u[0]*r,i[1]-u[1]*r]}}var e,k,b,pt,wt,ot,w,st,bt,kt;this.bindToolkitEvents=!1;e=f.AbstractRenderer.apply(this,arguments);k=this;f.DOMElementAdapter.apply(this,arguments);var ct,c=u.surface,y=t.getElement(u.container),rt=f.createElement({position:i.relative,width:i.nominalSize,height:i.nominalSize,left:0,top:0,clazz:r.MINIVIEW_CANVAS},y),v=f.createElement({position:i.absolute,width:i.nominalSize,height:i.nominalSize,left:0,top:0,clazz:r.MINIVIEW_PANNER},y),p=u.bounds,lt=u.suspended===!0,dt=u.collapsible!==!1,d=u.typeFunction,g=null,ut=!1,gt=u.wheelSensitivity||10,l=new ZoomWidget({viewport:y,canvas:rt,domElement:t.getElement,offset:this.getOffset,bind:function(){e.jsPlumb.on.apply(e.jsPlumb,arguments)},unbind:function(){e.jsPlumb.off.apply(e.jsPlumb,arguments)},enableWheelZoom:!1,enablePanButtons:!1,enablePan:!1,enableAnimation:!1,width:function(n){return e.jsPlumb.getWidth(e.jsPlumb.getElement(n))},height:function(n){return e.jsPlumb.getHeight(e.jsPlumb.getElement(n))},id:e.jsPlumb.getId,animate:e.jsPlumb.animate,dragEvents:{stop:t.dragEvents[i.stop],start:t.dragEvents[i.start],drag:t.dragEvents[i.drag]},extend:t.extend,events:{pan:function(){ht()},mousedown:function(){t.addClass(v,r.MINIVIEW_PANNING)},mouseup:function(){t.removeClass(v,r.MINIVIEW_PANNING)}},zoomRange:[-(1/0),1/0]}),ft=!1,nt=null,et=null,ni=!1,at=u.elementFilter||function(){return!0},ti=function(i){ft=!0;nt=l.pageLocation(i);et=t.getAbsolutePosition(v);t.on(document,n.mouseup,yt);t.on(document,n.mousemove,vt);o.consume(i)},vt=function(n){if(ni=!1,ft){var i=l.pageLocation(n),u=i[0]-nt[0],f=i[1]-nt[1],r=[et[0]+u,et[1]+f];ht(r);t.setAbsolutePosition(v,r)}},yt=function(){ft=!1;nt=null;t.off(document,n.mouseup,yt);t.off(document,n.mousemove,vt)},ii=!0,ri=function(n){o.consume(n);c.nudgeWheelZoom(n.normalizedWheelDelta*gt,n)};t.on(window,n.resize,jsPlumbToolkitUtil.debounce(function(){a()},100));u.enableWheelZoom!==!1&&addWheelListener(y,ri);l.setTransformOriginForElement(v,[0,0]);t.addClass(y,r.MINIVIEW);t.on(v,n.mousedown,ti);dt&&(g=t.createElement("div"),g.className=r.MINIVIEW_COLLAPSE,y.appendChild(g),t.on(g,i.click,function(){ut=!ut;t[ut?h.addClass:h.removeClass](y,r.MINIVIEW_COLLAPSED);b(!0)}));b=function(n){l.zoomToFit({onComplete:a,onStep:a,doNotFirePanEvent:n})};u.toolkit.bind(n.dataLoadEnd,b);var tt=function(i){var u=i.node||i.group,r;u&&at(u)===!1||(p=i.bounds,r=e.nodeMap()[(i.node||i.group).id]||i.el,l.positionChanged(r,i.pos),t.setAbsolutePosition(r,i.pos),b(!0),this.fire(n.nodeMoveEnd,i))}.bind(this),ui=function(n,t){for(var u,r=n.getNodes(),i=0;i<r.length;i++)u=e.nodeMap()[r[i].id],u&&t.appendChild(u)},it=function(n,u){var h,o,v;n.node&&at(n.node)===!1||(h=t.getSize(n.el),o=f.createElement({position:i.absolute,width:h[0]+i.px,height:h[1]+i.px,left:0,top:0,clazz:r.MINIVIEW_ELEMENT+(u?" "+u:"")}),(d&&o.setAttribute("jtk-miniview-type",d(n.node)),o.relatedElement=n.el,o.jtk=n.node,p=c.getBoundsInfo(),o.setAttribute(s.jtkNodeId,n.node.id),o.setAttribute(s.relatedNodeId,n.el.getAttribute(i.id)),rt.appendChild(o),l.add(o),e.nodeMap()[(n.node||n.group).id]=o,n.group)?ui(n.group,o):n.node.group&&(v=e.nodeMap()[n.node.group.id],v&&(v.appendChild(o),l.suspend(n.el))),k.getLayout().map(n.node.id,o),a())};this.registerNode=function(n){it(n,"Group"===n.node.objectType?r.MINIVIEW_GROUP_ELEMENT:"");tt(n)};pt=this.setOffset;this.setOffset=function(n,t){pt.apply(this,arguments);l.positionChanged(n,[t.left,t.top])};wt=this.setAbsolutePosition;this.setAbsolutePosition=function(n,t){wt.call(this,n,t);l.positionChanged(n,t)};this.setVisible=function(n){ii=n;y.style.display=n?i.block:i.none};this.setVisible(u.visible!==!1);this.getPan=l.getPan;ot=function(n,t){for(var r=n.getNodes(),i=0;i<r.length;i++)e.nodeMap()[r[i].id].style.display=t?"block":"none"};w=function(n){var r=e.nodeMap()[n.id],u;r&&(u=t.getSize(r.relatedElement),r.style.width=u[0]+i.px,r.style.height=u[1]+i.px,a(),d&&r.setAttribute("jtk-miniview-type",d(n.obj)))};this.invalidate=function(n){var t,i;if(n)w({id:n});else{t=e.nodeMap();for(i in t)w({id:i})}};this.setSuspended=function(n,t){lt=n;t&&this.update()};this.update=a;st=function(n){var i=n.node,t=e.nodeMap()[i];t&&(l.remove(t),delete e.nodeMap()[i],e.jsPlumb.removeElement(t));n.dontUpdatePanner||a()};bt=function(){var n=e.nodeMap();for(var t in n)st({node:t,dontUpdatePanner:!0});a()};c.bind(n.pan,a);c.bind(n.zoom,a);c.bind(n.nodeMoveEnd,tt);c.bind(n.nodeRemoved,st);c.bind(n.nodeAdded,it);c.bind(n.nodeRendered,it);c.bind(n.groupMoveEnd,tt);c.bind(n.groupAdded,function(n){it(n,r.MINIVIEW_GROUP_ELEMENT)});c.bind(n.groupMoveEnd,tt);c.bind(n.groupMemberAdded,function(n){var t=e.nodeMap()[n.group.id],i=e.nodeMap()[n.node.id];t&&i&&t.appendChild(i)});c.bind(n.groupMemberRemoved,function(n){var t=e.nodeMap()[n.node.id];t&&rt.appendChild(t)});c.bind(n.groupCollapse,function(n){ot(n.group,!1);w({id:n.group.id})});c.bind(n.groupExpand,function(n){ot(n.group,!0);w({id:n.group.id})});c.bind(n.relayout,a);c.bind(n.objectRepainted,w);c.bind(n.stateRestored,a);u.toolkit.bind(n.graphClearStart,bt);kt=function(){b(!0)};k.getLayout().bind(n.redraw,kt);this.setHostLayout=function(n){var t=k.getLayout();t&&t.setHostLayout(n)};this.setZoom=l.setZoom;this.getZoom=l.getZoom;this.getTransformOrigin=l.getTransformOrigin}}.call("undefined"!=typeof window?window:this),function(){"use strict";var u=this,s=u.jsPlumbToolkit,h=s.Widgets,t=u.jsPlumbUtil,i="ontouchstart"in document.documentElement,c=i?"touchstart":"mousedown",f=i?"touchend":"mouseup",e=i?"touchmove":"mousemove",l=function(n,t){n.style.width=t[0]+"px";n.style.height=t[1]+"px"},n={SELECT_DEFEAT:"jtk-lasso-select-defeat",LASSO:"jtk-lasso",LASSO_MASK:"jtk-lasso-mask",LASSO_MASK_LEFT:"jtk-lasso-mask-left",LASSO_MASK_TOP:"jtk-lasso-mask-top",LASSO_MASK_RIGHT:"jtk-lasso-mask-right",LASSO_MASK_BOTTOM:"jtk-lasso-mask-bottom"},o={SELECT_START:"onselectstart"},r=function(){};h.Lasso=function(i){var v,tt=i.canvas,w=!1,u={},s=[0,0],it=i.onStart||r,rt=i.onEnd||r,ut=i.onSelect||r,h=!1,y=!1,p=i.invert===!0,b=function(n,t){if(p){var i=window.innerWidth,e=window.innerHeight,s=window.scrollX,h=window.scrollY,o=e-n[1]+h,c=e-o+t[1],r=i-n[0]+s,f=i-r+t[0];u.top.style.bottom=o+"px";u.bottom.style.top=c+"px";u.left.style.right=r+"px";u.right.style.left=f+"px";u.top.style.left=i-r+"px";u.top.style.right=i-f+"px";u.bottom.style.left=i-r+"px";u.bottom.style.right=i-f+"px"}else jsPlumb.setAbsolutePosition(v,n),l(v,t)},k=function(t){var i=t?"block":"none";p?(u.top.style.display=i,u.left.style.display=i,u.right.style.display=i,u.bottom.style.display=i):v.style.display=i;jsPlumb[t?"addClass":"removeClass"](document.body,n.SELECT_DEFEAT)},ft=function(n){w&&!et(n)&&(t.consume(n),h=!0,i.on(document,f,g),i.on(document,e,d),i.on(document,o.SELECT_START,nt),s=i.pageLocation(n),b(s,[1,1]),it(s,n.shiftKey))},d=function(n){if(h){y||(k(!0),y=!0);t.consume(n);var r=i.pageLocation(n),u=[Math.abs(r[0]-s[0]),Math.abs(r[1]-s[1])],f=[Math.min(s[0],r[0]),Math.min(s[1],r[1])];b(f,u);ut(f,u,[s[0]<r[0],s[1]<r[1]],n.shiftKey)}},g=function(n){h&&(h=!1,y=!1,t.consume(n),i.off(document,f,g),i.off(document,e,d),i.off(document,o.SELECT_START,nt),k(!1),rt())},nt=function(){return!1},et=i.filter?function(n){var r=n.srcElement||n.target;return t.matchesSelector(r,i.filter)}:function(){return!1},a=function(n){var t=document.createElement("div");return t.className=n.join(" "),document.body.appendChild(t),t},ot=function(){u.top=a([n.LASSO_MASK,n.LASSO_MASK_TOP]);u.bottom=a([n.LASSO_MASK,n.LASSO_MASK_BOTTOM]);u.left=a([n.LASSO_MASK,n.LASSO_MASK_LEFT]);u.right=a([n.LASSO_MASK,n.LASSO_MASK_RIGHT])};p?ot():v=a([n.LASSO]);i.on(tt,c,ft);this.isActive=function(){return h};this.setEnabled=function(n){w=n}}}.call("undefined"!=typeof window?window:this),function(){"use strict";var et,e,n,p,i,u,d,g,w,b,nt,h,o,k=this,t=k.jsPlumb,ot=k.Rotors,c={},s={ok:"OK",cancel:"Cancel"},r=document.body,tt=!1,v=ot.newInstance({templateResolver:function(n){return it[n]||document.getElementById(n).innerHTML}}),l={},ut=!0,it={};t.ready(function(){e=document.createElement("div");e.className="jtk-dialog-underlay";t.on(e,"click",function(){f(!0)});n=document.createElement("div");n.className="jtk-dialog-overlay";p=document.createElement("div");p.className="jtk-dialog-title";n.appendChild(p);i=document.createElement("div");i.className="jtk-dialog-content";n.appendChild(i);u=document.createElement("div");u.className="jtk-dialog-buttons";n.appendChild(u)});var st=function(n){if(u.innerHTML="",n.buttons)for(var i,r=0;r<n.buttons.length;r++)i=n.buttons[r],u.appendChild(i),"true"===i.getAttribute("jtk-commit")?t.on(i,"click",function(){f()}):"true"===i.getAttribute("jtk-cancel")&&t.on(i,"click",function(){f(!0)});else h=document.createElement("button"),h.className="jtk-dialog-button jtk-dialog-button-ok",h.innerHTML=s.ok,u.appendChild(h),t.on(h,"click",function(){f()}),o=document.createElement("button"),o.className="jtk-dialog-button jtk-dialog-button-cancel",o.innerHTML=s.cancel,o.setAttribute("jtk-cancel","true"),u.appendChild(o),t.on(o,"click",function(){f(!0)}),h.innerHTML=n.labels?n.labels.ok||s.ok:s.ok,o.innerHTML=n.labels?n.labels.cancel||s.cancel:s.cancel},ht=function(){for(var t=u.children,n=0;n<t.length;n++)t[n].parentNode.removeChild(t[n])},ct={x:function(t,i,u){var o=r.clientWidth,f=(o-u[0])/2,e=window.pageXOffset||t.scrollLeft||document.body.scrollLeft;f<0&&(f=10);e=i?e:r.scrollLeft;n.style.left=f+e+"px"},y:function(t,i){var e=r.clientHeight,u=.1*e,f=window.pageYOffset||t.scrollTop||document.body.scrollTop;u<0&&(u=10);f=i?f:r.scrollTop;n.style.top=u+f+"px"}},y=function(){if(tt){var u=document.documentElement,f=t.getSize(n),i=r==document.body,o=n.getAttribute("data-axis");e.style.position=i?"fixed":"absolute";ct[o](u,i,f)}},ft=function(n){27==n.keyCode&&f(!0)},lt=function(n){return null==n?document.body:"string"==typeof n?document.getElementById(n):n},at=function(f){var o,h,a,ot,ht,k,it;if(f.id&&c[f.id]){ut=f.reposition!==!1;d=f.onOK;g=f.onCancel;w=f.onOpen;b=f.onMaybeClose;nt=f.onClose;var s=f.position||"top",ct="jtk-dialog-overlay-"+s,et="top"===s||"bottom"===s?"x":"y",at="jtk-dialog-overlay-"+et;for(st(f),r=lt(f.container),h=f.data||{},a=v.template(f.id,h),p.innerHTML=f.title||c[f.id].title||"",i.innerHTML="",ot=a.childNodes.length,o=0;o<ot;o++)i.appendChild(a.childNodes[0]);for(r.appendChild(e),r.appendChild(n),t.addClass(n,ct),t.addClass(n,at),e.style.display="block",n.style.display="block",n.setAttribute("data-position",s),n.setAttribute("data-axis",et),ht=c[f.id].cancelable?"visible":"hidden",k=u.querySelectorAll("[jtk-cancel='true']"),o=0;o<k.length;o++)k[o].style.visibility=ht;tt=!0;y();vt(h);t.on(document,"keyup",ft);ut&&(t.on(window,"resize",y),t.on(window,"scroll",y));t.on(n,"click","[jtk-clear]",function(){var t=this.getAttribute("jtk-att");t&&rt(n.querySelectorAll("[jtk-att='"+t+"']:not([jtk-clear])"),this)});t.on(n,"click","[jtk-clear-all]",function(){rt(n.querySelectorAll("[jtk-att]:not([jtk-clear])"),this)});l.onOpen&&l.onOpen(n);w&&w(n);t.addClass(n,"jtk-dialog-overlay-visible");try{it=i.querySelector("[jtk-focus]");it&&setTimeout(function(){it.focus()},0)}catch(f){}}},vt=function(n){for(var u=i.querySelectorAll("[jtk-att]"),r=0;r<u.length;r++){var e=u[r].tagName.toUpperCase(),s="INPUT"===e?(u[r].getAttribute("type")||"TEXT").toUpperCase():e,h=u[r].getAttribute("jtk-att"),o=v.data(n,h);null!=o&&yt[s](u[r],o);u[r].getAttribute("jtk-commit")&&("INPUT"===e?t.on(u[r],"keyup",function(n){10!=n.keyCode&&13!=n.keyCode||f()}):"TEXTAREA"===e&&t.on(u[r],"keyup",function(n){n.ctrlKey&&(10==n.keyCode||13==n.keyCode)&&f()}))}},yt={TEXT:function(n,t){n.value=t},RADIO:function(n,t){n.checked=n.value==t},CHECKBOX:function(n,t){n.checked=1==t},SELECT:function(n,t){for(var i=0;i<n.options.length;i++)if(n.options[i].value==t)return void(n.selectedIndex=i)},TEXTAREA:function(n,t){n.value=t}},pt={TEXT:function(n){return n.value},RADIO:function(n){if(n.checked)return n.value},CHECKBOX:function(n){if(n.checked)return!0},SELECT:function(n){return n.selectedIndex!=-1?n.options[n.selectedIndex].value:null},TEXTAREA:function(n){return n.value}},wt={TEXT:function(n){n.value=""},RADIO:function(n){n.checked=!1},CHECKBOX:function(n){n.checked=!1},SELECT:function(n){n.selectedIndex=-1},TEXTAREA:function(n){n.value=""}},rt=function(n,t){for(var i=0;i<n.length;i++)if(n[i]!==t){var r=n[i].tagName.toUpperCase(),f="INPUT"===r?(n[i].getAttribute("type")||"TEXT").toUpperCase():r,u=wt[f];u&&u(n[i])}},bt=function(){for(var r,t=i.querySelectorAll("[jtk-att]"),u={},n=0;n<t.length;n++){var o=t[n].tagName.toUpperCase(),s="INPUT"===o?(t[n].getAttribute("type")||"TEXT").toUpperCase():o,f=pt[s](t[n]),e=t[n].getAttribute("jtk-att");null!=f&&(r=v.data(u,e),null!=r?(jsPlumbUtil.isArray(r)||v.data(u,e,[r]),r.push(f)):v.data(u,e,f))}return u},a=function(n){try{null!=n&&n.apply(n,Array.prototype.slice.apply(arguments,[1]))}catch(n){}},f=function(u){var f=u?null:bt();(u||null==b||b(f)!==!1)&&(tt=!1,e.style.display="none",n.style.display="none",t.off(document,"keyup",ft),t.off(window,"resize",y),t.off(window,"scroll",y),t.removeClass(n,"jtk-dialog-overlay-visible"),t.removeClass(n,"jtk-dialog-overlay-top"),t.removeClass(n,"jtk-dialog-overlay-bottom"),t.removeClass(n,"jtk-dialog-overlay-left"),t.removeClass(n,"jtk-dialog-overlay-right"),t.removeClass(n,"jtk-dialog-overlay-x"),t.removeClass(n,"jtk-dialog-overlay-y"),n.setAttribute("data-position",""),n.setAttribute("data-axis",""),r.removeChild(e),r.removeChild(n),ht(),u?(a(l.onCancel,i),a(g,i)):(a(l.onOK,f,i),a(d,f,i)),a(l.onClose),a(nt),d=g=w=nt=b=et=null)};k.jsPlumbToolkit.Dialogs={initialize:function(n){var i,f;if(n=n||{},c={},n.dialogs)for(i in n.dialogs)it[i]=n.dialogs[i][0],c[i]={content:it[i],title:n.dialogs[i][1]||"",cancelable:n.dialogs[i][2]!==!1};else for(var e=n.selector||".jtk-dialog",u=t.getSelector(e),r=0;r<u.length;r++)f=u[r].getAttribute("id"),null!=f&&(c[f]={content:u[r].innerHTML,title:u[r].getAttribute("title")||"",el:u[r],cancelable:"false"!==u[r].getAttribute("cancel")});n.labels&&t.extend(s,n.labels);n.globals&&t.extend(l,n.globals)},show:at,hide:function(){f(!0)},clear:rt};"undefined"!=typeof exports&&(exports.Dialogs=k.jsPlumbToolkit.Dialogs)}.call("undefined"!=typeof window?window:this),function(){"use strict";var n=this;n.jsPlumbToolkit.DrawingTools=function(n){var a,v,y,b,h,t,i,u,r,f=n.renderer,c=f.getToolkit(),o=f.getJsPlumb(),e={},nt=n.widthAttribute||"w",tt=n.heightAttribute||"h",k=n.leftAttribute||"left",d=n.topAttribute||"top",it=function(){var t,n;for(t in e)n=e[t],n[0]&&n[0].parentNode&&n[0].parentNode.removeChild(n[0]),delete e[t]},s=function(n,t,i,r){var u=document.createElement(n),f;if(t&&(u.className=t),i&&i.appendChild(u),r)for(f in r)u.setAttribute(f,r[f]);return u},rt=function(n){var t=e[n];t&&t[0]&&t[0].parentNode&&t[0].parentNode.removeChild(t[0]);delete e[n]},g=function(n,t){var i=t.getRenderedNode(n.id);return rt(n.id),i},ut=function(n,t){var r=g(n,t);if(null!=r){var i=s("div","jtk-draw-skeleton",r),u=r.getAttribute("jtk-x-resize"),f=r.getAttribute("jtk-y-resize");s("div","jtk-draw-drag",i);s("div","jtk-draw-handle jtk-draw-handle-tl",i,{"data-dir":"tl","data-node-id":n.id});s("div","jtk-draw-handle jtk-draw-handle-tr",i,{"data-dir":"tr","data-node-id":n.id});s("div","jtk-draw-handle jtk-draw-handle-bl",i,{"data-dir":"bl","data-node-id":n.id});s("div","jtk-draw-handle jtk-draw-handle-br",i,{"data-dir":"br","data-node-id":n.id});e[n.id]=[i,"false"!==u,"false"!==f]}},l=function(n,f,e,o){var s={};return s[nt]=a?e:i-t,s[tt]=v?o:r-u,s[k]=a?n:t,s[d]=v?f:u,s},ft={tl:function(n,f){var e=t+n,o=u+f,s=i-e,h=r-o;return e>=i&&(s=e-i,e=i),o>=r&&(h=o-r,o=r),l(e,o,s,h)},tr:function(n,f){var o=i-t+n,e=u+f,s=r-e,h=t;return o<=0&&(h=t+o,o*=-1),e>=r&&(s=e-r,e=r),l(h,e,o,s)},bl:function(n,f){var e=t+n,o=r-u+f,s=i-e,h=u;return e>=i&&(s=e-i,e=i),o<=0&&(h+=o,o*=-1),l(e,h,s,o)},br:function(n,f){var e=i-t+n,o=r-u+f,s=t,h=u;return e<=0&&(s=t+e,e*=-1),o<=0&&(h+=o,o*=-1),l(s,h,e,o)}},p,w;c.bind("selectionCleared",function(){it()});c.bind("select",function(n){ut(n.obj,f)});c.bind("deselect",function(n){g(n.obj,f)});p=function(n){var i=f.mapEventLocation(n),r=i.left-y.left,u=i.top-y.top,t=b(r,u,"");c.updateNode(h,t);f.setPosition(h,t[k],t[d],!0)};w=function(n){f.storePositionInModel(h.id);o.removeClass(document.body,"jtk-drag-select-defeat");o.off(document,"mousemove",p);o.off(document,"mouseup",w);jsPlumbUtil.consume(n)};o.on(document,"mousedown",".jtk-draw-handle",function(n){var k=this.getAttribute("data-dir"),l=this.getAttribute("data-node-id"),s;h=c.getNode(l);a=e[l][1];v=e[l][2];y=f.mapEventLocation(n);s=f.getCoordinates(h);t=s.x;u=s.y;i=t+s.w;r=u+s.h;b=ft[k];o.addClass(document.body,"jtk-drag-select-defeat");o.on(document,"mousemove",p);o.on(document,"mouseup",w)})};"undefined"!=typeof exports&&(exports.DrawingTools=n.jsPlumbToolkit.DrawingTools)}.call("undefined"!=typeof window?window:this);!0;