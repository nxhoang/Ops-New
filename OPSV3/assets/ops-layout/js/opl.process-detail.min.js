function LayoutSaveEvent(n){ShowModal(ModalProcessDetail);clearDataOnProcessDtModal();AsyncGetMaxOpSerial(n=>{n&&n.trim()!==""?(console.log("Assign OpSerial to textbox"),console.log(`OpSerial: ${n}`),JqTxtProcessNo.val(n),JqTxtProcessNumber.val(Number(n))):console.log("Could not get max of OpSerial")});JqBtnSaveProcess.unbind().click(()=>{window.StatusUpdateProcess===1?(console.log("Updating process"),UpdateProcess_New(null,n)):(console.log("Creating new process"),SaveNewProcess_New(null,n))})}function LayoutUpdateEvent(n,t){console.log("Layout updating opdt event.");ShowModal("mdlProcessDetail");const i=GetSelectedOneRowData(gridOpsTableId);n.StyleCode=i.StyleCode;n.StyleSize=i.StyleSize;n.StyleColorSerial=i.StyleColorSerial;n.RevNo=i.RevNo;n.OpRevNo=i.OpRevNo;n.OpSerial=n.id;n.Edition=i.Edition;window.DisplayColor=n.DisplayColor;GetOpdtAsync(n,n=>{n.LanguageId=i.Language,console.log(n),InitDataUpdateProcess(n)});JqBtnSaveProcess.unbind().click(()=>{window.StatusUpdateProcess===1?(console.log("Updating a process"),UpdateProcess_New(null,t)):(console.log("Creating new process"),SaveNewProcess_New(null,t))})}function cbMainProcessOnchanged(){const n=document.getElementsByName("mainProcess");for(let t=0;t<n.length;t++)n[t].addEventListener("change",n=>{for(let t of _listOpnt)t.MainProcess=t.OpnSerial.toString()===n.currentTarget.value?"1":"0"})}function GetOpnts(n,t,i,r,u,f,e,o,s){const h=ObjectConfigAjaxPost("/Ops/GetOpnts",!0,JSON.stringify({edition:n,styleCode:t,styleSize:i,styleColorSerial:r,revNo:u,opRevNo:f,opSerial:e,languageId:o}));AjaxPostCommon(h,n=>{s(n)})}function CreateLayoutProcess(n,t){$.post("/OpLayout/GetOpdt",{opdt:n}).done(i=>{if(console.log(i),i.IsSuccess){HideModal(ProcessModal);let r=[];if(i.Result.p.MainProcessArr){const n=i.Result.p.MainProcessArr.split("-");if(n&&n.length>0&&i.Result.p.IconNames){const t=i.Result.p.IconNames.split("-");for(let i=0;i<t.length;i++)n[i]==="1"&&t[i].trim()!=="_"&&r.push(t[i])}}r.length===0&&r.push("settings.svg");const u=JSON.parse(localStorage.getItem("bgColorLayout"));let o=u?u.BgImage:"linear-gradient(to right, #fc6586, #53bbfd)",s=u?u.FontColor:"#ffffff";const h=i.Result.p.MachineName?i.Result.p.MachineName:" ",c=i.Result.p.IconName?i.Result.p.IconName:"settings.svg",l=i.Result.p.HotSpot&&i.Result.p.HotSpot==="1"?!0:!1,a=i.Result.p.OpsState&&i.Result.p.OpsState==="1"?!0:!1,v=i.Result.p.Remarks?i.Result.p.Remarks:"",y=i.Result.p.DisplayColor?`#${i.Result.p.DisplayColor.substr(3,8)}`:"#A9A9A9",p=$.isEmptyObject(i.Result.p.VideoFile)?0:1,f=i.Result.p.OpNum?i.Result.p.OpNum:" ",e=getOpNameByLang(n,window.currentLang),w=new LayoutProcess(i.Result.p.OpSerial.toString(),`[${f}] ${e}`,i.Result.p.OpTime,i.Result.p.MachineCount,h,i.Result.p.ManCount,e,i.Result.p.VnOpName,i.Result.p.GbOpName,i.Result.p.MmOpName,i.Result.p.IdOpName,i.Result.p.EtOpName,i.Result.p.Codes,i.Result.p.IconNames,i.Result.p.MainProcessArr,l,a,f,v,i.Result.p.OpGroup,i.Result.p.MachineType,i.Result.p.ModuleId,y,window.ProcessWidth,window.ProcessHeight,window.LayoutFontSize,[],!0,window.LayoutPage,window.CanDelete,p,LayoutLeftX,LayoutTopY,"emptyGroup","",r,i.Result.iconUrl,c,o,s);t(w)}})}function ToLayoutProcess(){const i=opdt.p.IconName?opdt.p.IconName:"settings.svg",r=opdt.p.MachineName?opdt.p.MachineName:" ",u=opdt.p.HotSpot&&opdt.p.HotSpot==="1"?!0:!1,f=opdt.p.OpsState&&opdt.p.OpsState==="1"?!0:!1,e=opdt.p.Remarks?opdt.p.Remarks:"",o=opdt.p.DisplayColor?`#${opdt.p.DisplayColor.substr(3,8)}`:"#A9A9A9",s=$.isEmptyObject(opdt.p.VideoFile)?0:1,n=opdt.p.OpNum?opdt.p.OpNum:" ",t=getOpNameByLang(objOpDetail,window.currentLang);return new LayoutProcess(opdt.p.OpSerial.toString(),`[${n}] ${t}`,opdt.p.OpTime,opdt.p.MachineCount,r,opdt.p.ManCount,t,opdt.p.VnOpName,opdt.p.GbOpName,opdt.p.MmOpName,opdt.p.IdOpName,opdt.p.EtOpName,opdt.p.Codes,opdt.p.IconNames,opdt.p.MainProcessArr,u,f,n,e,opdt.p.OpGroup,opdt.p.MachineType,opdt.p.ModuleId,o,window.ProcessWidth,window.ProcessHeight,window.LayoutFontSize,[],!0,window.LayoutPage,window.CanDelete,s,LayoutLeftX,LayoutTopY,"emptyGroup","",[],opdt.iconUrl,i)}const TxtProcessNumber="txtProcessNumber",TxtProcessNo="txtProcessNo",JqTxtProcessNumber=$(`#${TxtProcessNumber}`),JqTxtProcessNo=$(`#${TxtProcessNo}`),ModalProcessDetail="mdlProcessDetail",BtnSaveProcess="btnSaveProcess",JqBtnSaveProcess=$(`#${BtnSaveProcess}`);var UserRoleOpm,UserRoleFom,UserRoleMes,ImageHttpLink;(()=>{UserRoleOpm=GetUserRoleInfo(SystemIdOps,GetMenuIdByEdition(editionPdm)),UserRoleFom=GetUserRoleInfo(SystemIdOps,GetMenuIdByEdition(editionAom)),UserRoleMes=GetUserRoleInfo(SystemIdOps,GetMenuIdByEdition(editionAom)),window.InitDataForProcessModal(),cbMainProcessOnchanged(),window.ImageVideoFileEvents(),getReasonOperationPlan(n=>{console.log("Loading op reason..."),console.log(n),FillDataToDropDownlist("drpReasonOp",n,"SubCode","CodeName")})})();